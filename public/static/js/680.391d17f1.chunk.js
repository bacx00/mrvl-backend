"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[680],{1680:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var r=a(2555),s=a(9950),l=a(5150),d=a(732),n=a(4414);const i=function(){const{api:e}=(0,l.As)(),[t,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[c,x]=(0,s.useState)(null),[m,g]=(0,s.useState)(1),[u]=(0,s.useState)(12),[b,h]=(0,s.useState)({search:"",status:"all",type:"all",sortBy:"date"}),[v,y]=(0,s.useState)(new Set),[p,j]=(0,s.useState)(!1),[k,f]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null),[C,S]=(0,s.useState)({name:"",description:"",start_date:"",end_date:"",location:"",status:"upcoming",type:"tournament"});(0,s.useEffect)((()=>{E()}),[]);const E=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{var s;o(!0),x(null);const l=await e.get("/api/admin/events?page=".concat(t,"&limit=").concat(r)),d=(null===l||void 0===l||null===(s=l.data)||void 0===s?void 0:s.data)||(null===l||void 0===l?void 0:l.data)||l||[];a(Array.isArray(d)?d:[])}catch(n){var l,d;const e=(null===(l=n.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)||n.message||"Failed to load events";x(e),console.error("Error fetching events:",n),a([])}finally{o(!1)}},A=(0,s.useMemo)((()=>{let e=[...t];if(b.search.trim()){const t=b.search.toLowerCase().trim();e=e.filter((e=>{var a,r,s;return(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(s=e.location)||void 0===s?void 0:s.toLowerCase().includes(t))}))}return"all"!==b.status&&(e=e.filter((e=>e.status===b.status))),"all"!==b.type&&(e=e.filter((e=>e.type===b.type))),"date"===b.sortBy?e.sort(((e,t)=>new Date(t.start_date||t.created_at)-new Date(e.start_date||e.created_at))):"name"===b.sortBy?e.sort(((e,t)=>(e.name||"").localeCompare(t.name||""))):"status"===b.sortBy&&e.sort(((e,t)=>(e.status||"").localeCompare(t.status||""))),e}),[t,b]),_=(0,s.useMemo)((()=>{const e=(m-1)*u;return A.slice(e,e+u)}),[A,m,u]),B=Math.ceil(A.length/u);(0,s.useEffect)((()=>{g(1)}),[b]);const D=()=>{S({name:"",description:"",start_date:"",end_date:"",location:"",status:"upcoming",type:"tournament"}),w(null),f(!0)},T=async t=>{if(0===v.size)return;const a='Are you sure you want to change status to "'.concat(t,'" for ').concat(v.size," events?");if(window.confirm(a))try{var r;const a=await e.post("/api/admin/events/bulk-update",{event_ids:Array.from(v),status:t});var s;if(!1===(null===(r=a.data)||void 0===r?void 0:r.success))throw new Error((null===(s=a.data)||void 0===s?void 0:s.message)||"Bulk update failed");await E(),y(new Set),j(!1),alert("".concat(v.size," events updated successfully!"))}catch(c){var l,d;console.error("Error in bulk status update:",c);const t=(null===(l=c.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)||c.message||"Bulk update failed";alert(t)}},z=e=>{switch(e){case"live":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"upcoming":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"cancelled":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}},M=e=>e?new Date(e).toLocaleDateString():"TBD";return i?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,n.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),(0,n.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map(((e,t)=>(0,n.jsx)("div",{className:"h-40 bg-gray-200 dark:bg-gray-700 rounded"},t)))})]})}):c?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-200 mb-2",children:"Error Loading Events"}),(0,n.jsx)("p",{className:"text-red-700 dark:text-red-300 mb-4",children:c}),(0,n.jsx)("button",{onClick:E,className:"btn btn-outline-primary",children:"Try Again"})]})}):(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Event Management"}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage tournaments and events"})]}),(0,n.jsx)("button",{onClick:D,className:"btn btn-primary",children:"Create New Event"})]}),(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Search Events"}),(0,n.jsx)("input",{type:"text",placeholder:"Search by name or location...",value:b.search,onChange:e=>h((0,r.A)((0,r.A)({},b),{},{search:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Status"}),(0,n.jsxs)("select",{value:b.status,onChange:e=>h((0,r.A)((0,r.A)({},b),{},{status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,n.jsx)("option",{value:"all",children:"All Status"}),(0,n.jsx)("option",{value:"upcoming",children:"Upcoming"}),(0,n.jsx)("option",{value:"live",children:"Live"}),(0,n.jsx)("option",{value:"completed",children:"Completed"}),(0,n.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Type"}),(0,n.jsxs)("select",{value:b.type,onChange:e=>h((0,r.A)((0,r.A)({},b),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,n.jsx)("option",{value:"all",children:"All Types"}),(0,n.jsx)("option",{value:"tournament",children:"Tournament"}),(0,n.jsx)("option",{value:"championship",children:"Championship"}),(0,n.jsx)("option",{value:"qualifier",children:"Qualifier"}),(0,n.jsx)("option",{value:"exhibition",children:"Exhibition"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Sort By"}),(0,n.jsxs)("select",{value:b.sortBy,onChange:e=>h((0,r.A)((0,r.A)({},b),{},{sortBy:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,n.jsx)("option",{value:"date",children:"Date"}),(0,n.jsx)("option",{value:"name",children:"Name"}),(0,n.jsx)("option",{value:"status",children:"Status"})]})]}),(0,n.jsx)("div",{className:"flex items-end",children:(0,n.jsx)("button",{onClick:()=>h({search:"",status:"all",type:"all",sortBy:"date"}),className:"btn btn-secondary w-full",children:"Clear Filters"})})]})}),p&&(0,n.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-200",children:[v.size," events selected"]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>T("upcoming"),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm",children:"Mark as Upcoming"}),(0,n.jsx)("button",{onClick:()=>T("live"),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm",children:"Mark as Live"}),(0,n.jsx)("button",{onClick:()=>T("completed"),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm",children:"Mark as Completed"}),(0,n.jsx)("button",{onClick:async()=>{if(0===v.size)return;const t="Are you sure you want to delete ".concat(v.size," events? This action cannot be undone.");if(window.confirm(t))try{var a;const t=await e.post("/api/admin/events/bulk-delete",{event_ids:Array.from(v)});var r;if(!1===(null===(a=t.data)||void 0===a?void 0:a.success))throw new Error((null===(r=t.data)||void 0===r?void 0:r.message)||"Bulk delete failed");await E(),y(new Set),j(!1),alert("".concat(v.size," events deleted successfully!"))}catch(c){var s,l;console.error("Error in bulk delete:",c);const t=(null===(s=c.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||c.message||"Bulk delete failed";alert(t)}},className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm",children:"Delete"})]})]}),(0,n.jsx)("button",{onClick:()=>{y(new Set),j(!1)},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"Clear Selection"})]})}),A.length>0&&(0,n.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3",children:(0,n.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.size===A.length&&A.length>0,onChange:()=>{v.size===A.length?(y(new Set),j(!1)):(y(new Set(A.map((e=>e.id)))),j(!0))},className:"rounded border-gray-300 dark:border-gray-600"}),(0,n.jsxs)("span",{className:"text-gray-700 dark:text-gray-300",children:["Select all ",A.length," events"]})]})}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map((t=>(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.has(t.id),onChange:()=>(e=>{const t=new Set(v);t.has(e)?t.delete(e):t.add(e),y(t),j(t.size>0)})(t.id),className:"rounded border-gray-300 dark:border-gray-600"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate flex-1 mx-3",children:t.name}),(0,n.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(z(t.status)),children:t.status||"TBD"})]}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2",children:t.description||"No description available"}),(0,n.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("span",{className:"font-medium mr-2",children:"Start Date:"}),M(t.start_date)]}),t.end_date&&(0,n.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("span",{className:"font-medium mr-2",children:"End Date:"}),M(t.end_date)]}),t.location&&(0,n.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("span",{className:"font-medium mr-2",children:"Location:"}),t.location]}),(0,n.jsxs)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("span",{className:"font-medium mr-2",children:"Teams:"}),t.team_count||0," registered"]})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{className:"flex-1 btn btn-outline-primary text-sm",children:"View Details"}),(0,n.jsx)("button",{onClick:()=>(e=>{var t,a;w(e),S({name:e.name||"",description:e.description||"",start_date:(null===(t=e.start_date)||void 0===t?void 0:t.slice(0,10))||"",end_date:(null===(a=e.end_date)||void 0===a?void 0:a.slice(0,10))||"",location:e.location||"",status:e.status||"upcoming",type:e.type||"tournament"}),f(!0)})(t),className:"flex-1 btn btn-outline-secondary text-sm",children:"Edit"}),(0,n.jsx)("button",{onClick:()=>(async(t,a)=>{if(window.confirm('Are you sure you want to delete event "'.concat(a,'"? This action cannot be undone.')))try{var r;const a=await e.delete("/api/admin/events/".concat(t));var s;if(!1===(null===(r=a.data)||void 0===r?void 0:r.success))throw new Error((null===(s=a.data)||void 0===s?void 0:s.message)||"Delete failed");await E(),alert("Event deleted successfully!")}catch(c){var l,d;console.error("Error deleting event:",c);const t=(null===(l=c.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)||c.message||"Error deleting event";alert(t)}})(t.id,t.name),className:"btn btn-outline-danger text-sm",children:"Delete"})]})]})},t.id)))}),B>1&&(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)("nav",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:()=>g(Math.max(1,m-1)),disabled:1===m,className:"btn btn-secondary",children:"Previous"}),(0,n.jsx)("div",{className:"flex space-x-1",children:[...Array(Math.min(B,5))].map(((e,t)=>{let a;return a=B<=5||m<=3?t+1:m>=B-2?B-4+t:m-2+t,(0,n.jsx)("button",{onClick:()=>g(a),className:"px-3 py-2 text-sm font-medium rounded-lg ".concat(m===a?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),children:a},a)}))}),(0,n.jsx)("button",{onClick:()=>g(Math.min(B,m+1)),disabled:m===B,className:"btn btn-secondary",children:"Next"})]})}),0===A.length&&(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-12 text-center",children:[(0,n.jsx)("div",{className:"text-6xl mb-4"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"No Events Found"}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:b.search||"all"!==b.status||"all"!==b.type?"Try adjusting your filters to find more events.":"Get started by creating your first event."}),(0,n.jsx)("button",{onClick:D,className:"btn btn-primary",children:"Create First Event"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl mb-2"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.length}),(0,n.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Events"})]}),(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\udd34"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:t.filter((e=>"live"===e.status)).length}),(0,n.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Live Events"})]}),(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl mb-2"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.filter((e=>"upcoming"===e.status)).length}),(0,n.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Upcoming"})]}),(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl mb-2",children:"\u2705"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.filter((e=>"completed"===e.status)).length}),(0,n.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]})]}),k&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:N?"Edit Event":"Create New Event"}),(0,n.jsx)("button",{onClick:()=>{f(!1),w(null)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"\u2715"})]}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(d.default,{eventId:null===N||void 0===N?void 0:N.id,navigateTo:e=>{f(!1),w(null),E()}})})]})})]})}}}]);