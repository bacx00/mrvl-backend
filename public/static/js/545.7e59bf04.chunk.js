"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[545],{294:(e,t,a)=>{a.d(t,{AZ:()=>o,CL:()=>r,EB:()=>x,vg:()=>i});var n=a(2555);const r=function(e){var t,a;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"organic";if(!e)return;const r={event_category:"News",event_label:e.title,article_id:e.id,article_title:e.title,article_category:(null===(t=e.category)||void 0===t?void 0:t.name)||"Uncategorized",author:(null===(a=e.author)||void 0===a?void 0:a.name)||"MRVL Team",view_source:n,reading_time_estimate:d(e.content),article_age_days:c(e.published_at||e.created_at),user_agent:navigator.userAgent,viewport_width:window.innerWidth,viewport_height:window.innerHeight,timestamp:(new Date).toISOString()};var o,s;window.gtag&&(window.gtag("event","view_item",{item_category:"news_article",item_id:e.id,item_name:e.title,content_type:"news",custom_parameters:r}),window.gtag("event","page_view",{page_title:"".concat(e.title," | MRVL"),page_location:window.location.href,content_group1:"News",content_group2:(null===(o=e.category)||void 0===o?void 0:o.name)||"Uncategorized",custom_parameters:{article_id:e.id,author:(null===(s=e.author)||void 0===s?void 0:s.name)||"MRVL Team"}}));window.analytics&&"function"===typeof window.analytics.track&&window.analytics.track("News Article Viewed",r),m("news_view",r)},o=function(e,t){var a,r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return;const s=(0,n.A)({event_category:"News Engagement",event_label:"".concat(t," - ").concat(e.title),article_id:e.id,article_title:e.title,article_category:(null===(a=e.category)||void 0===a?void 0:a.name)||"Uncategorized",engagement_type:t,author:(null===(r=e.author)||void 0===r?void 0:r.name)||"MRVL Team",timestamp:(new Date).toISOString()},o);window.gtag&&window.gtag("event",t,{content_type:"news_article",item_id:e.id,custom_parameters:s}),window.analytics&&"function"===typeof window.analytics.track&&window.analytics.track("News Engagement",s),m("news_engagement",s)},s=(e,t,a)=>{if(!e)return;const n={article_id:e.id,article_title:e.title,scroll_percentage:Math.round(t),time_on_page_seconds:Math.round(a/1e3),estimated_reading_progress:g(t,a,e.content),device_type:u(),timestamp:(new Date).toISOString()};[25,50,75,90,100].includes(Math.round(t))&&(window.gtag&&window.gtag("event","scroll",{content_type:"news_article",item_id:e.id,scroll_percentage:Math.round(t),custom_parameters:n}),window.analytics&&"function"===typeof window.analytics.track&&window.analytics.track("Reading Progress",n)),Math.round(t)%10===0&&m("reading_behavior",n)},i=(e,t,a)=>{const n={event_category:"News Search",search_term:e,filters_applied:t,result_count:a,timestamp:(new Date).toISOString()};window.gtag&&window.gtag("event","search",{search_term:e,content_type:"news",custom_parameters:n}),window.analytics&&"function"===typeof window.analytics.track&&window.analytics.track("News Search",n),m("news_search",n)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"news";window.performance&&window.addEventListener("load",(()=>{setTimeout((()=>{var t,a;const n=performance.getEntriesByType("navigation")[0],r=performance.getEntriesByType("paint"),o={page_name:e,dom_content_loaded:(null===n||void 0===n?void 0:n.domContentLoadedEventEnd)-(null===n||void 0===n?void 0:n.domContentLoadedEventStart),load_time:(null===n||void 0===n?void 0:n.loadEventEnd)-(null===n||void 0===n?void 0:n.loadEventStart),first_contentful_paint:null===(t=r.find((e=>"first-contentful-paint"===e.name)))||void 0===t?void 0:t.startTime,largest_contentful_paint:null,cumulative_layout_shift:null,first_input_delay:null,connection_type:(null===(a=navigator.connection)||void 0===a?void 0:a.effectiveType)||"unknown",device_memory:navigator.deviceMemory||"unknown",timestamp:(new Date).toISOString()};"PerformanceObserver"in window&&(new PerformanceObserver((e=>{const t=e.getEntries(),a=t[t.length-1];o.largest_contentful_paint=a.startTime,w(o)})).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver((e=>{let t=0;for(const a of e.getEntries())a.hadRecentInput||(t+=a.value);o.cumulative_layout_shift=t,w(o)})).observe({entryTypes:["layout-shift"]}),new PerformanceObserver((e=>{for(const t of e.getEntries())o.first_input_delay=t.processingStart-t.startTime,w(o)})).observe({entryTypes:["first-input"]})),w(o)}),0)}))},d=e=>{if(!e)return 0;const t=e.split(/\s+/).length;return Math.ceil(t/200)},c=e=>{if(!e)return 0;const t=new Date,a=new Date(e),n=Math.abs(t-a);return Math.ceil(n/864e5)},g=(e,t,a)=>{if(!a)return 0;const n=60*d(a)*1e3,r=Math.min(t/n*100,100),o=e;return Math.round(.6*o+.4*r)},u=()=>{const e=window.innerWidth;return e<768?"mobile":e<1024?"tablet":"desktop"},m=async(e,t)=>{},w=e=>{window.gtag&&(e.largest_contentful_paint&&window.gtag("event","web_vital",{name:"LCP",value:Math.round(e.largest_contentful_paint),event_category:"Performance"}),null!==e.cumulative_layout_shift&&window.gtag("event","web_vital",{name:"CLS",value:Math.round(1e3*e.cumulative_layout_shift),event_category:"Performance"}),null!==e.first_input_delay&&window.gtag("event","web_vital",{name:"FID",value:Math.round(e.first_input_delay),event_category:"Performance"})),m("performance_metrics",e)},x=()=>{let e;l("news");let t=0,a=Date.now();const n=()=>{clearTimeout(e);const n=window.pageYOffset||document.documentElement.scrollTop,r=window.innerHeight,o=document.documentElement.scrollHeight,i=Math.min((n+r)/o*100,100);t=Math.max(t,i),e=setTimeout((()=>{const e=v();e&&s(e,t,Date.now()-a)}),100)};return window.addEventListener("scroll",n,{passive:!0}),document.addEventListener("visibilitychange",(()=>{if(document.hidden){const e=v();e&&s(e,t,Date.now()-a)}else a=Date.now()})),()=>{window.removeEventListener("scroll",n)}},v=()=>{if(window.__CURRENT_ARTICLE__)return window.__CURRENT_ARTICLE__;const e=window.location.pathname.match(/\/news\/(\d+)/);return e?{id:e[1]}:null}},4545:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var n=a(9950),r=a(5150),o=a(6225),s=(a(8132),a(294)),i=a(4414);const l=function(e){let{navigateTo:t}=e;const{isAdmin:a,isModerator:l,api:d,user:c}=(0,r.As)(),[g,u]=(0,n.useState)([]),[m,w]=(0,n.useState)([]),[x,v]=(0,n.useState)("all"),[h,p]=(0,n.useState)("latest"),y=(0,n.useCallback)((async()=>{try{var e,t;const[a,n]=await Promise.all([d.get("/news?category=".concat(x,"&sort=").concat(h)),d.get("/news/categories")]),r=(null===(e=a.data)||void 0===e?void 0:e.data)||a.data||[],o=(null===(t=n.data)||void 0===t?void 0:t.data)||n.data||[];console.log("\u2705 News data loaded:",r.length,"articles"),console.log("\u2705 Categories loaded:",o.length,"categories"),u(r),w(o),"all"===x&&"latest"===h||(0,s.vg)("",{category:x,sort:h},r.length)}catch(a){console.error("\u274c NewsPage: Backend API failed:",a.message),u([]),w([])}}),[d,x,h]);(0,n.useEffect)((()=>{y()}),[x,h,y]);const f=e=>{const t=new Date(e),a=new Date,n=Math.floor((a-t)/36e5);if(n<1)return"Just now";if(n<24)return"".concat(n,"h ago");if(n<48)return"Yesterday";const r=Math.floor(n/24);return r<7?"".concat(r,"d ago"):(e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))(e)},_=e=>h===e?(0,i.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"\u25bc"}):null;return(0,i.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"News"}),(a()||l())&&(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{onClick:()=>t&&t("admin-news-categories"),className:"px-3 py-1.5 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:"Manage Categories"}),(0,i.jsx)("button",{onClick:()=>t&&t("admin-news-create"),className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Create News"})]})]}),(0,i.jsx)("div",{className:"card p-3 mb-4",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Category:"}),(0,i.jsxs)("select",{value:x,onChange:e=>v(e.target.value),className:"text-sm bg-transparent border border-gray-300 dark:border-gray-600 rounded px-2 py-1 text-gray-900 dark:text-white",children:[(0,i.jsx)("option",{value:"all",children:"All Categories"}),m.map((e=>(0,i.jsxs)("option",{value:e.slug,children:["string"===typeof e.icon?e.icon:"\ud83d\udcf0"," ","string"===typeof e.name?e.name:"Unknown Category"]},e.id)))]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sort by:"}),(0,i.jsxs)("button",{onClick:()=>p("latest"),className:"text-sm font-medium transition-colors ".concat("latest"===h?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Latest ",_("latest")]}),(0,i.jsxs)("button",{onClick:()=>p("popular"),className:"text-sm font-medium transition-colors ".concat("popular"===h?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Popular ",_("popular")]}),(0,i.jsxs)("button",{onClick:()=>p("trending"),className:"text-sm font-medium transition-colors ".concat("trending"===h?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Trending ",_("trending")]})]})]})}),g.length>0?(0,i.jsx)("div",{className:"space-y-2",children:g.map(((e,n)=>{var r,c,g,u,w;return(0,i.jsx)("div",{className:"card p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer border-l-4 border-transparent hover:border-red-600",onClick:()=>{t&&((0,s.CL)(e,"listing"),t("news-detail",{id:String(e.id||"")}))},children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[e.category&&(0,i.jsxs)("span",{className:"px-2 py-1 text-xs font-bold rounded-full text-white",style:{backgroundColor:(null===(r=m.find((t=>t.slug===e.category_slug)))||void 0===r?void 0:r.color)||"#6b7280"},children:["string"===typeof(null===(c=m.find((t=>t.slug===e.category_slug)))||void 0===c?void 0:c.icon)?m.find((t=>t.slug===e.category_slug)).icon:"\ud83d\udcf0"," ",(null===(g=e.category)||void 0===g?void 0:g.name)||(null===(u=m.find((t=>t.slug===e.category_slug)))||void 0===u?void 0:u.name)||"News"]}),e.featured&&(0,i.jsx)("span",{className:"px-2 py-1 text-xs font-bold rounded-full bg-yellow-500 text-white",children:"FEATURED"}),(0,i.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:e.region||"INTL"})]}),(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2 hover:text-red-600 dark:hover:text-red-400 transition-colors",children:e.title}),e.excerpt&&(0,i.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:e.excerpt}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-500",children:[(0,i.jsxs)("span",{children:["by ",(null===(w=e.author)||void 0===w?void 0:w.name)||"MRVL Team"]}),(0,i.jsx)("span",{children:f(e.published_at||e.created_at)}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[e.comments_count>0&&(0,i.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,i.jsx)("span",{children:"\ud83d\udcac"}),(0,i.jsx)("span",{children:e.comments_count})]}),(e.upvotes>0||e.downvotes>0)&&(0,i.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,i.jsxs)("span",{className:"text-green-600",children:["\u2191",e.upvotes]}),(0,i.jsxs)("span",{className:"text-red-600",children:["\u2193",e.downvotes]})]})]})]}),(a()||l())&&(0,i.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700 flex items-center space-x-2",children:[(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{try{const a="/moderator/news/".concat(e,t?"/feature":"/unfeature");await d.put(a),y()}catch(a){console.error("Error featuring/unfeaturing news:",a),alert("Failed to "+(t?"feature":"unfeature")+" news article")}})(e.id,!e.featured)},className:"px-2 py-1 text-xs rounded transition-colors ".concat(e.featured?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300 hover:bg-yellow-200 dark:hover:bg-yellow-900/30":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.featured?"\u2b50 Unfeature":"\u2b50 Feature"}),(0,i.jsx)("button",{onClick:a=>{a.stopPropagation(),t&&t("admin-news-edit",{id:String(e.id||"")})},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-900/30 transition-colors",children:"\u270f\ufe0f Edit"}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this news article? This action cannot be undone."))try{await d.delete("/admin/news/".concat(e)),y()}catch(t){console.error("Error deleting news:",t),alert("Failed to delete news article")}})(e.id)},className:"px-2 py-1 text-xs bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300 rounded hover:bg-red-200 dark:hover:bg-red-900/30 transition-colors",children:"\ud83d\uddd1\ufe0f Delete"})]})]}),(0,i.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,i.jsx)("img",{src:(0,o.G8)(e),alt:e.title,className:"w-20 h-20 object-cover rounded bg-gray-100 dark:bg-gray-700",onError:e=>{e.target.onerror=null,e.target.src="https://staging.mrvl.net/images/news-placeholder.svg"}})})]})},e.id)}))}):(0,i.jsxs)("div",{className:"card p-12 text-center",children:[(0,i.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcf0"}),(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"No News Found"}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"all"!==x?"No news articles found in the selected category.":"No news articles available at the moment."}),(0,i.jsx)("button",{onClick:()=>v("all"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"View All News"})]}),g.length>0&&(0,i.jsx)("div",{className:"mt-8 flex justify-center",children:(0,i.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:["Showing ",g.length," articles"]})})]})}},8132:(e,t,a)=>{a(9950),a(4414)}}]);