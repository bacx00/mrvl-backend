"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[328],{631:(e,t,a)=>{a.d(t,{GF:()=>n,Ni:()=>s,rQ:()=>l});const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top-right";document.querySelectorAll(".mrvl-toast").forEach((e=>{document.body.contains(e)&&document.body.removeChild(e)}));const n=document.createElement("div"),s={"top-right":"top-4 right-4","top-left":"top-4 left-4","top-center":"top-4 left-1/2 transform -translate-x-1/2","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","bottom-center":"bottom-4 left-1/2 transform -translate-x-1/2"},l={success:"bg-green-500 text-white border-green-600",error:"bg-red-500 text-white border-red-600",warning:"bg-yellow-500 text-white border-yellow-600",info:"bg-blue-500 text-white border-blue-600",achievement:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white border-orange-600"},o={success:"\u2705",error:"\u274c",warning:"\u26a0\ufe0f",info:"\u2139\ufe0f",achievement:"\ud83c\udfc6"},i=s[r]||s["top-right"],d=l[t]||l.info,c=o[t]||o.info;return n.className="mrvl-toast fixed ".concat(i," z-[9999] px-4 py-3 rounded-lg shadow-lg border-l-4 ").concat(d," font-medium max-w-sm transform transition-all duration-300 ease-in-out translate-x-full opacity-0"),n.innerHTML='\n    <div class="flex items-center space-x-2">\n      <span class="text-lg">'.concat(c,'</span>\n      <span class="flex-1">').concat(e,'</span>\n      <button class="ml-2 text-white/80 hover:text-white transition-colors" onclick="this.parentElement.parentElement.remove()">\n        \xd7\n      </button>\n    </div>\n  '),document.body.appendChild(n),requestAnimationFrame((()=>{n.classList.remove("translate-x-full","opacity-0"),n.classList.add("translate-x-0","opacity-100")})),setTimeout((()=>{document.body.contains(n)&&(n.classList.add("translate-x-full","opacity-0"),setTimeout((()=>{document.body.contains(n)&&document.body.removeChild(n)}),300))}),a),n},n=function(e){return r(e,"success",arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3)},s=function(e){return r(e,"error",arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3)},l=function(e){return r(e,"warning",arguments.length>1&&void 0!==arguments[1]?arguments[1]:3500)}},1453:(e,t,a)=>{a.d(t,{A:()=>o,G:()=>l});a(9950);var r=a(9190),n=a(6225),s=a(4414);const l=function(e,t){if(!e)return null;const a={};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((e=>{const t=e.mention_text||"@".concat(e.name);a[t]=e}));const r=[];if([{regex:/@player:([a-zA-Z0-9_]+)/g,type:"player",prefix:"@player:"},{regex:/@team:([a-zA-Z0-9_]+)/g,type:"team",prefix:"@team:"},{regex:/@([a-zA-Z0-9_]+)(?!:)/g,type:"user",prefix:"@"}].forEach((t=>{let n,{regex:s,type:l,prefix:o}=t;for(;null!==(n=s.exec(e));){const e=n[0],t=n[1],s=n.index,o=n.index+e.length,i=a[e];r.push({start:s,end:o,original:e,type:l,identifier:t,data:i})}})),r.sort(((e,t)=>t.start-e.start)),0===r.length)return e;const n=[];let l=e.length;return r.forEach((a=>{l>a.end&&n.unshift(e.slice(a.end,l)),a.data?n.unshift((0,s.jsx)("span",{className:"mention-link font-medium px-1 rounded cursor-pointer transition-colors ".concat("player"===a.type?"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20":"team"===a.type?"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20":"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20"),onClick:e=>{if(e.stopPropagation(),t&&a.data)switch(a.type){case"player":t("player-detail",{id:a.data.id});break;case"team":t("team-detail",{id:a.data.id});break;case"user":t("user-profile",{id:a.data.id});break;default:console.warn("Unknown mention type:",a.type)}},title:"View ".concat(a.type,": ").concat(a.data.display_name||a.data.name),children:a.original},"mention-".concat(a.start))):n.unshift(a.original),a.start>0&&n.unshift(e.slice(0,a.start)),l=a.start})),n.length>0?n:e},o=function(e){let{user:t,showAvatar:a=!0,showTeamFlair:l=!0,showHeroFlair:o=!0,size:i="sm",className:d="",clickable:c=!1,navigateTo:h=null}=e;if(!t)return(0,s.jsx)("span",{className:"text-gray-500",children:"Unknown User"});const x={xs:"w-4 h-4 text-xs",sm:"w-6 h-6 text-sm",md:"w-8 h-8 text-base",lg:"w-10 h-10 text-lg"};return(0,s.jsxs)("div",{className:"flex items-center space-x-2 ".concat(d),children:[a&&(0,s.jsx)(r.A,{user:t,size:i,showFlairs:!1,showName:!1}),(0,s.jsx)("span",{className:"font-medium ".concat(c?"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 cursor-pointer":"text-gray-900 dark:text-white"),onClick:()=>{c&&h&&t.id&&h("user-profile",{id:t.id})},children:t.name||t.username}),l&&t.team_flair&&t.show_team_flair&&(0,s.jsx)("div",{className:"".concat(x[i]," flex-shrink-0"),children:t.team_flair.logo?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:(0,n.VG)(t.team_flair.logo,"team-logo"),alt:t.team_flair.short_name||t.team_flair.name,className:"".concat(x[i]," object-contain rounded"),title:t.team_flair.name,onError:e=>{e.target.src=(0,n.VG)(null,"team-logo")}}),(0,s.jsx)("div",{className:"".concat(x[i]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs hidden"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})]}):(0,s.jsx)("div",{className:"".concat(x[i]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})}),t.roles&&t.roles.length>0&&(0,s.jsx)("div",{className:"flex space-x-1",children:t.roles.map((e=>(0,s.jsx)("span",{className:"px-1.5 py-0.5 text-xs font-bold rounded ".concat("admin"===e?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"moderator"===e?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"),children:e.toUpperCase()},e)))})]})}},5328:(e,t,a)=>{a.r(t),a.d(t,{default:()=>H});var r=a(2555),n=a(9950),s=a(5150),l=a(1453),o=(a(8574),a(6890)),i=a(1449),d=a(6355),c=a(2607),h=a(3147),x=a(6479),m=a(4414);const u=e=>{let{categories:t=[],selectedCategory:a,onCategoryChange:r,searchQuery:s,onSearchChange:l,sortBy:u,onSortChange:g,viewMode:b,onViewModeChange:p,onCreateThread:v,showSearchSuggestions:y=!1,searchSuggestions:f=[],onSearchSuggestionSelect:k,isAuthenticated:w=!1}=e;const[j,N]=(0,n.useState)(!1),[C,z]=(0,n.useState)(!1),[A,S]=(0,n.useState)(!1),[_,T]=(0,n.useState)(!1),[M,E]=(0,n.useState)(0),[L,P]=(0,n.useState)(!1),[R,F]=(0,n.useState)(0),[D,V]=(0,n.useState)(!0),B=(0,n.useRef)(null),W=(0,n.useRef)(null),I=(0,n.useRef)(0);(0,n.useEffect)((()=>{let e=!1;const t=()=>{const t=window.scrollY,a=t>R;Math.abs(t-R)>10&&(a&&t>100?V(!1):a||V(!0)),F(t),e=!1},a=()=>{e||(requestAnimationFrame(t),e=!0)};return window.addEventListener("scroll",a,{passive:!0}),()=>window.removeEventListener("scroll",a)}),[R]);const Y=(0,n.useCallback)((e=>{0===window.scrollY&&(I.current=e.touches[0].clientY)}),[]),H=(0,n.useCallback)((e=>{if(I.current&&0===window.scrollY){const t=e.touches[0].clientY,a=Math.max(0,Math.min(120,t-I.current));E(a)}}),[]),U=(0,n.useCallback)((async()=>{if(M>80){P(!0);try{await new Promise((e=>setTimeout(e,1500)))}finally{P(!1)}}E(0),I.current=0}),[M]),X=(0,n.useCallback)((e=>{l(e),S(e.length>0&&f.length>0)}),[l,f.length]),q=(0,n.useCallback)((e=>{navigator.vibrate&&navigator.vibrate(10),r(e)}),[r]),G=[{value:"latest",label:"Latest",icon:o.A},{value:"popular",label:"Popular",icon:i.A},{value:"hot",label:"Hot",icon:"\ud83d\udd25"}];return(0,m.jsxs)(m.Fragment,{children:[M>0&&(0,m.jsx)("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-200",style:{transform:"translateX(-50%) translateY(".concat(Math.max(0,M-80),"px)")},children:(0,m.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-full p-3 shadow-lg border border-gray-200 dark:border-gray-700",children:(0,m.jsx)("div",{className:"w-5 h-5 text-gray-600 dark:text-gray-400 ".concat(L?"animate-spin":""),children:"\ud83d\udd04"})})}),(0,m.jsx)("div",{ref:W,className:"lg:hidden fixed top-16 left-0 right-0 z-40 bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700 transition-transform duration-300 ".concat(D?"transform translate-y-0":"transform -translate-y-full"),onTouchStart:Y,onTouchMove:H,onTouchEnd:U,children:(0,m.jsxs)("div",{className:"px-4 py-3",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,m.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Forums"}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:()=>z(!C),className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 touch-optimized transition-all duration-200 active:scale-95",children:(0,m.jsx)(d.A,{className:"w-5 h-5"})}),w&&(0,m.jsxs)("button",{onClick:v,className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors touch-optimized",children:[(0,m.jsx)(c.A,{className:"w-4 h-4 inline-block mr-1"}),"New"]})]})]}),(0,m.jsxs)("div",{className:"relative mb-3",children:[(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,m.jsx)("input",{ref:B,type:"text",value:s,onChange:e=>X(e.target.value),onFocus:()=>T(!0),onBlur:()=>{setTimeout((()=>T(!1)),200),setTimeout((()=>S(!1)),200)},placeholder:"Search discussions...",className:"w-full pl-10 pr-4 py-3 bg-gray-100 dark:bg-gray-800 border-none rounded-xl text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-red-500 mobile-input-no-zoom transition-all duration-200"}),s&&(0,m.jsx)("button",{onClick:()=>X(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600",children:(0,m.jsx)(x.A,{className:"w-4 h-4"})})]}),A&&f.length>0&&(0,m.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 z-50 max-h-80 overflow-y-auto",children:f.map(((e,t)=>(0,m.jsx)("button",{onClick:()=>{k(e),S(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 last:border-b-0 transition-colors touch-optimized",children:(0,m.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,m.jsx)("div",{className:"w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-600 flex items-center justify-center",children:(0,m.jsx)(i.A,{className:"w-4 h-4 text-gray-500"})}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("div",{className:"font-medium text-gray-900 dark:text-white text-sm truncate",children:e.title}),(0,m.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[e.category," \u2022 ",e.replies," replies"]})]})]})},t)))})]}),(0,m.jsxs)("div",{className:"flex space-x-2 overflow-x-auto scrollbar-hide pb-2",children:[(0,m.jsx)("button",{onClick:()=>q("all"),className:"flex-shrink-0 px-4 py-2 rounded-full font-medium transition-all duration-200 touch-optimized ".concat("all"===a?"bg-red-500 text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"),children:"All"}),t.map((e=>(0,m.jsxs)("button",{onClick:()=>q(e.slug),className:"flex-shrink-0 px-4 py-2 rounded-full font-medium transition-all duration-200 whitespace-nowrap touch-optimized ".concat(a===e.slug?"bg-red-500 text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[e.icon," ",e.name]},e.id)))]}),C&&(0,m.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-xl animate-slide-down",children:[(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort by"}),(0,m.jsx)("div",{className:"flex flex-wrap gap-2",children:G.map((e=>{const t=e.icon;return(0,m.jsxs)("button",{onClick:()=>g(e.value),className:"flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 touch-optimized ".concat(u===e.value?"bg-red-500 text-white":"bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-600"),children:["string"===typeof e.icon?(0,m.jsx)("span",{children:e.icon}):(0,m.jsx)(t,{className:"w-4 h-4"}),(0,m.jsx)("span",{className:"text-sm",children:e.label})]},e.value)}))})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"View"}),(0,m.jsxs)("div",{className:"flex bg-white dark:bg-gray-700 rounded-lg p-1",children:[(0,m.jsx)("button",{onClick:()=>p("list"),className:"flex-1 px-3 py-2 rounded-md font-medium transition-all duration-200 touch-optimized ".concat("list"===b?"bg-red-500 text-white":"text-gray-600 dark:text-gray-400"),children:"List"}),(0,m.jsx)("button",{onClick:()=>p("compact"),className:"flex-1 px-3 py-2 rounded-md font-medium transition-all duration-200 touch-optimized ".concat("compact"===b?"bg-red-500 text-white":"text-gray-600 dark:text-gray-400"),children:"Compact"})]})]})]})]})}),(0,m.jsx)("div",{className:"lg:hidden fixed bottom-20 right-4 z-40",children:(0,m.jsxs)("div",{className:"flex flex-col space-y-2",children:[w&&(0,m.jsx)("button",{onClick:v,className:"w-14 h-14 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-lg flex items-center justify-center touch-optimized transition-all duration-200 active:scale-95",children:(0,m.jsx)(c.A,{className:"w-6 h-6"})}),(0,m.jsx)("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"w-12 h-12 bg-gray-600 hover:bg-gray-700 text-white rounded-full shadow-lg flex items-center justify-center touch-optimized transition-all duration-200 active:scale-95",children:"\u2191"})]})}),(0,m.jsx)("style",{jsx:!0,children:"\n        @keyframes slide-down {\n          from {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-slide-down {\n          animation: slide-down 0.2s ease-out;\n        }\n\n        .scrollbar-hide {\n          -ms-overflow-style: none;\n          scrollbar-width: none;\n        }\n        \n        .scrollbar-hide::-webkit-scrollbar {\n          display: none;\n        }\n\n        .mobile-input-no-zoom {\n          font-size: 16px !important;\n          transform: translateZ(0);\n        }\n\n        .touch-optimized {\n          min-height: 44px;\n          min-width: 44px;\n          -webkit-tap-highlight-color: rgba(239, 68, 68, 0.1);\n          tap-highlight-color: rgba(239, 68, 68, 0.1);\n        }\n      "})]})};var g=a(3986),b=a(6192),p=a(4524),v=a(1064),y=a(7838),f=a(7737),k=a(983),w=a(5995),j=a(583),N=a(8935),C=a(9332);const z=["index","style"],A=n.memo((e=>{var t,a,r;let{index:s,style:l,data:d}=e;const{threads:c,onThreadClick:h,onVote:x,onBookmark:u,onShare:g,viewMode:b,selectedThreadId:z,isAuthenticated:A}=d,S=c[s];if(!S)return null;const _=(0,n.useCallback)((e=>{e.preventDefault(),h(S)}),[S,h]),T=(0,n.useCallback)(((e,t)=>{e.stopPropagation(),x(S.id,t)}),[S.id,x]),M=(0,n.useCallback)((e=>{e.stopPropagation(),u(S.id)}),[S.id,u]),E=(0,n.useCallback)((e=>{e.stopPropagation(),g(S)}),[S,g]);var L;return"compact"===b?(0,m.jsx)("div",{style:l,children:(0,m.jsx)("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-800 cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 touch-optimized ".concat(z===S.id?"bg-red-50 dark:bg-red-900/20":""),onClick:_,children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[S.isPinned&&(0,m.jsx)(p.A,{className:"w-3 h-3 text-red-500 flex-shrink-0"}),(0,m.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white text-sm truncate",children:S.title})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-gray-500 dark:text-gray-400",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(v.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:(null===(L=S.author)||void 0===L?void 0:L.username)||"Anonymous"})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(i.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:S.replies_count||0})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(y.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:S.views_count||0})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(f.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:(0,C.ak)(S.updated_at||S.created_at)})]})]})]}),(0,m.jsx)(k.A,{className:"w-4 h-4 text-gray-400 ml-2 flex-shrink-0"})]})})}):(0,m.jsx)("div",{style:l,children:(0,m.jsx)("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-800 cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 touch-optimized ".concat(z===S.id?"bg-red-50 dark:bg-red-900/20":""),onClick:_,children:(0,m.jsxs)("div",{className:"flex space-x-3",children:[(0,m.jsx)("div",{className:"flex-shrink-0",children:(0,m.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center text-white font-medium",children:null!==(t=S.author)&&void 0!==t&&t.avatar?(0,m.jsx)("img",{src:S.author.avatar,alt:S.author.username,className:"w-full h-full rounded-full object-cover",loading:"lazy"}):(0,m.jsx)("span",{className:"text-sm",children:null!==(a=S.author)&&void 0!==a&&a.username?S.author.username[0].toUpperCase():"A"})})}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-start justify-between",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[S.isPinned&&(0,m.jsx)(p.A,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),S.isHot&&(0,m.jsx)(o.A,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}),(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm leading-tight",children:S.title})]}),S.excerpt&&(0,m.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2 line-clamp-2",children:S.excerpt}),(0,m.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-500 dark:text-gray-400",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(v.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:(null===(r=S.author)||void 0===r?void 0:r.username)||"Anonymous"})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(i.A,{className:"w-3 h-3"}),(0,m.jsxs)("span",{children:[S.replies_count||0," replies"]})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(y.A,{className:"w-3 h-3"}),(0,m.jsxs)("span",{children:[S.views_count||0," views"]})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(f.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:(0,C.ak)(S.updated_at||S.created_at)})]})]}),S.tags&&S.tags.length>0&&(0,m.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[S.tags.slice(0,3).map(((e,t)=>(0,m.jsx)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:e},t))),S.tags.length>3&&(0,m.jsxs)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:["+",S.tags.length-3]})]})]}),(0,m.jsxs)("div",{className:"flex flex-col items-center ml-3",children:[(0,m.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(S.upvotes||0)-(S.downvotes||0)}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"votes"})]})]}),A&&(0,m.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-2 border-t border-gray-100 dark:border-gray-700",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:e=>T(e,"up"),className:"p-1 rounded transition-colors touch-optimized ".concat("up"===S.userVote?"text-green-600 bg-green-100 dark:bg-green-900/30":"text-gray-500 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20"),children:(0,m.jsx)(w.A,{className:"w-4 h-4"})}),(0,m.jsx)("button",{onClick:M,className:"p-1 rounded transition-colors touch-optimized ".concat(S.isBookmarked?"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30":"text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-900/20"),children:(0,m.jsx)(j.A,{className:"w-4 h-4"})}),(0,m.jsx)("button",{onClick:E,className:"p-1 rounded transition-colors text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 touch-optimized",children:(0,m.jsx)(N.A,{className:"w-4 h-4"})})]}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:S.category})]})]})]})})})}),b.t7),S=e=>{let{threads:t=[],onThreadClick:a,onVote:s,onBookmark:l,onShare:o,onLoadMore:i,hasMore:d=!1,loading:c=!1,viewMode:h="list",selectedThreadId:x,isAuthenticated:u=!1,height:p=600,itemHeight:v=null,className:y=""}=e;const[f,k]=(0,n.useState)(null),[w,j]=(0,n.useState)({}),N=(0,n.useRef)(null),C=(0,n.useRef)(null),S=(0,n.useCallback)((e=>{if(v)return v;const a=t[e];if(!a)return"compact"===h?60:160;if(w[a.id])return w[a.id];return("compact"===h?60:160)+(a.excerpt?20*Math.ceil(a.excerpt.length/80):0)+(a.tags&&a.tags.length>0?30:0)+(u?40:0)}),[t,v,h,w,u]);(0,n.useCallback)(((e,a)=>{const n=t[e];n&&w[n.id]!==a&&(j((e=>(0,r.A)((0,r.A)({},e),{},{[n.id]:a}))),f&&!v&&f.resetAfterIndex(e))}),[t,w,f,v]);(0,n.useEffect)((()=>{if(!d||c)return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&i()}),{threshold:.1,rootMargin:"100px"});return N.current&&e.observe(N.current),C.current=e,()=>e.disconnect()}),[d,c,i]);const _=(0,n.useMemo)((()=>({threads:t,onThreadClick:a,onVote:s,onBookmark:l,onShare:o,viewMode:h,selectedThreadId:x,isAuthenticated:u})),[t,a,s,l,o,h,x,u]),T=t.length+(d?1:0),M=n.memo((e=>{let{style:t}=e;return(0,m.jsx)("div",{style:t,className:"flex items-center justify-center p-8",children:(0,m.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,m.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-red-500"}),(0,m.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Loading more threads..."})]})})})),E=(0,n.useCallback)((e=>{let{index:a,style:n}=e,s=(0,g.A)(e,z);return a>=t.length?(0,m.jsx)(M,{style:n}):(0,m.jsx)(A,(0,r.A)({index:a,style:n,data:_},s))}),[t.length,_]),L=v?b.Y1:b._m;return(0,m.jsxs)("div",{className:"virtualized-forum-list ".concat(y),children:[(0,m.jsx)(L,{ref:k,height:p,itemCount:T,itemSize:v||S,itemData:_,overscanCount:5,className:"scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent",children:E}),d&&(0,m.jsx)("div",{ref:N,className:"h-1 w-full",style:{position:"absolute",bottom:"200px",pointerEvents:"none"}}),(0,m.jsx)("style",{jsx:!0,children:"\n        .virtualized-forum-list {\n          contain: layout style paint;\n          will-change: transform;\n        }\n\n        .touch-optimized {\n          min-height: 44px;\n          min-width: 44px;\n          -webkit-tap-highlight-color: rgba(239, 68, 68, 0.1);\n          tap-highlight-color: rgba(239, 68, 68, 0.1);\n        }\n\n        .line-clamp-2 {\n          display: -webkit-box;\n          -webkit-line-clamp: 2;\n          -webkit-box-orient: vertical;\n          overflow: hidden;\n        }\n\n        /* Custom scrollbar */\n        .scrollbar-thin {\n          scrollbar-width: thin;\n        }\n\n        .scrollbar-thumb-gray-300::-webkit-scrollbar-thumb {\n          background-color: #d1d5db;\n          border-radius: 0.375rem;\n        }\n\n        .dark .scrollbar-thumb-gray-600::-webkit-scrollbar-thumb {\n          background-color: #4b5563;\n        }\n\n        .scrollbar-track-transparent::-webkit-scrollbar-track {\n          background-color: transparent;\n        }\n\n        .scrollbar-thin::-webkit-scrollbar {\n          width: 6px;\n        }\n\n        /* Performance optimizations */\n        .virtualized-forum-list * {\n          content-visibility: auto;\n          contain-intrinsic-size: auto 200px;\n        }\n\n        /* Reduce motion for accessibility */\n        @media (prefers-reduced-motion: reduce) {\n          .virtualized-forum-list * {\n            transition: none !important;\n            animation: none !important;\n          }\n        }\n\n        /* High DPI optimizations */\n        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {\n          .virtualized-forum-list {\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n          }\n        }\n      "})]})};var _=a(270),T=a(7079),M=a(2550),E=a(5403),L=a(4546),P=a(8108),R=a(9318);const F=e=>{let{children:t,leftPanel:a,rightPanel:r,mainContent:s,orientation:l="landscape",defaultLayout:o="three-column",onLayoutChange:i,showLayoutControls:c=!0,className:x=""}=e;const[u,g]=(0,n.useState)(o),[b,p]=(0,n.useState)(320),[v,f]=(0,n.useState)(280),[w,j]=(0,n.useState)(!1),[N,C]=(0,n.useState)(!1),[z,A]=(0,n.useState)(null),[S,F]=(0,n.useState)(null),D=(0,n.useRef)(null),V=((0,n.useRef)(null),(0,n.useRef)(null),{single:{name:"Single Column",icon:_.A,columns:"grid-cols-1",areas:'"main"',showLeft:!1,showRight:!1},"two-column":{name:"Two Column",icon:T.A,columns:"grid-cols-[1fr_1fr]",areas:'"main sidebar"',showLeft:!1,showRight:!0},"three-column":{name:"Three Column",icon:M.A,columns:"grid-cols-[".concat(b,"px_1fr_").concat(v,"px]"),areas:'"sidebar main auxiliary"',showLeft:!0,showRight:!0},"split-view":{name:"Split View",icon:E.A,columns:"grid-cols-[".concat(b,"px_1fr]"),areas:'"sidebar main"',showLeft:!0,showRight:!1}});(0,n.useEffect)((()=>{const e=()=>{window.innerWidth<900?g("single"):window.innerWidth<1200?g("two-column"):g("three-column")};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const B=(0,n.useCallback)((e=>{g(e),i&&i(e)}),[i]),W=(0,n.useCallback)(((e,t)=>{e.preventDefault(),A(t),F({x:e.clientX,leftWidth:b,rightWidth:v}),document.addEventListener("mousemove",I),document.addEventListener("mouseup",Y)}),[b,v]),I=(0,n.useCallback)((e=>{if(!z||!S)return;const t=e.clientX-S.x;if("left"===z){const e=Math.max(200,Math.min(500,S.leftWidth+t));p(e)}else if("right"===z){const e=Math.max(200,Math.min(400,S.rightWidth-t));f(e)}}),[z,S]),Y=(0,n.useCallback)((()=>{A(null),F(null),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",Y)}),[I]),H=(0,n.useCallback)(((e,t)=>{e.preventDefault();const a=e.touches[0];A(t),F({x:a.clientX,leftWidth:b,rightWidth:v})}),[b,v]),U=(0,n.useCallback)((e=>{if(!z||!S)return;e.preventDefault();const t=e.touches[0].clientX-S.x;if("left"===z){const e=Math.max(200,Math.min(500,S.leftWidth+t));p(e)}else if("right"===z){const e=Math.max(200,Math.min(400,S.rightWidth-t));f(e)}}),[z,S]),X=(0,n.useCallback)((()=>{A(null),F(null)}),[]),q=V[u],G=(0,n.useCallback)((()=>{j(!w)}),[w]),Z=(0,n.useCallback)((()=>{C(!N)}),[N]),O=()=>(0,m.jsxs)("div",{className:"flex items-center space-x-2 p-2 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 tablet-controls-shadow",children:[(0,m.jsx)("div",{className:"flex items-center space-x-1",children:Object.entries(V).map((e=>{let[t,a]=e;const r=a.icon;return(0,m.jsx)("button",{onClick:()=>B(t),className:"p-2 rounded-lg transition-all duration-200 tablet-touch-target ".concat(u===t?"bg-red-500 text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),title:a.name,children:(0,m.jsx)(r,{className:"w-4 h-4"})},t)}))}),(0,m.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),q.showLeft&&(0,m.jsx)("button",{onClick:G,className:"p-2 rounded-lg transition-all duration-200 tablet-touch-target ".concat(w?"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700":"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"),title:w?"Show left panel":"Hide left panel",children:(0,m.jsx)(E.A,{className:"w-4 h-4"})}),q.showRight&&(0,m.jsx)("button",{onClick:Z,className:"p-2 rounded-lg transition-all duration-200 tablet-touch-target ".concat(N?"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700":"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"),title:N?"Show right panel":"Hide right panel",children:(0,m.jsx)(L.A,{className:"w-4 h-4"})}),(0,m.jsx)("div",{className:"ml-auto text-sm text-gray-500 dark:text-gray-400",children:q.name})]}),Q=e=>{let{direction:t,onMouseDown:a,onTouchStart:r}=e;return(0,m.jsx)("div",{className:"tablet-resizer tablet-resizer-".concat(t," ").concat(z===t?"tablet-resizer-active":""),onMouseDown:e=>a(e,t),onTouchStart:e=>r(e,t),onTouchMove:U,onTouchEnd:X,children:(0,m.jsx)("div",{className:"tablet-resizer-handle"})})};return(0,m.jsxs)("div",{ref:D,className:"tablet-forum-layout ".concat(x," ").concat("landscape"===l?"tablet-layout-landscape":"tablet-layout-portrait"),children:[c&&(0,m.jsx)(O,{}),(0,m.jsxs)("div",{className:"tablet-layout-container",style:{display:"grid",gridTemplateColumns:"three-column"===u?"".concat(w?"60px":b+"px"," 1fr ").concat(N?"60px":v+"px"):"split-view"===u?"".concat(w?"60px":b+"px"," 1fr"):"two-column"===u?"1fr 1fr":"1fr",height:c?"calc(100vh - 64px)":"100vh",overflow:"hidden"},children:[q.showLeft&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"tablet-panel tablet-panel-left ".concat(w?"tablet-panel-collapsed":""),children:[(0,m.jsxs)("div",{className:"tablet-panel-header",children:[(0,m.jsx)("h2",{className:"tablet-panel-title",children:w?null:"Categories"}),(0,m.jsx)("button",{onClick:G,className:"tablet-panel-toggle tablet-touch-target",children:w?(0,m.jsx)(k.A,{className:"w-4 h-4"}):(0,m.jsx)(P.A,{className:"w-4 h-4"})})]}),(0,m.jsx)("div",{className:"tablet-panel-content",children:w?(0,m.jsxs)("div",{className:"flex flex-col items-center space-y-3 py-4",children:[(0,m.jsx)(d.A,{className:"w-6 h-6 text-gray-400"}),(0,m.jsx)(h.A,{className:"w-6 h-6 text-gray-400"})]}):a})]}),!w&&(0,m.jsx)(Q,{direction:"left",onMouseDown:W,onTouchStart:H})]}),(0,m.jsx)("div",{className:"tablet-panel tablet-main-content tablet-gpu-accelerated",children:s||t}),q.showRight&&(0,m.jsxs)(m.Fragment,{children:[!N&&(0,m.jsx)(Q,{direction:"right",onMouseDown:W,onTouchStart:H}),(0,m.jsxs)("div",{className:"tablet-panel tablet-panel-right ".concat(N?"tablet-panel-collapsed":""),children:[(0,m.jsxs)("div",{className:"tablet-panel-header",children:[(0,m.jsx)("button",{onClick:Z,className:"tablet-panel-toggle tablet-touch-target",children:N?(0,m.jsx)(P.A,{className:"w-4 h-4"}):(0,m.jsx)(k.A,{className:"w-4 h-4"})}),(0,m.jsx)("h2",{className:"tablet-panel-title",children:N?null:"Activity"})]}),(0,m.jsx)("div",{className:"tablet-panel-content",children:N?(0,m.jsxs)("div",{className:"flex flex-col items-center space-y-3 py-4",children:[(0,m.jsx)(y.A,{className:"w-6 h-6 text-gray-400"}),(0,m.jsx)(R.A,{className:"w-6 h-6 text-gray-400"})]}):r})]})]})]}),(0,m.jsx)("style",{jsx:!0,children:"\n        .tablet-forum-layout {\n          width: 100%;\n          height: 100vh;\n          overflow: hidden;\n          background: #f8f9fa;\n          contain: layout style;\n        }\n\n        .dark .tablet-forum-layout {\n          background: #111827;\n        }\n\n        .tablet-layout-container {\n          transition: grid-template-columns 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          will-change: grid-template-columns;\n          contain: layout style;\n        }\n\n        .tablet-panel {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          background: white;\n          border-right: 1px solid #e5e7eb;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          will-change: width, transform;\n          contain: layout style paint;\n        }\n\n        .dark .tablet-panel {\n          background: #1f2937;\n          border-color: #374151;\n        }\n\n        .tablet-panel-collapsed {\n          min-width: 60px !important;\n          max-width: 60px !important;\n        }\n\n        .tablet-panel-left {\n          border-right: 1px solid #e5e7eb;\n        }\n\n        .tablet-panel-right {\n          border-left: 1px solid #e5e7eb;\n          border-right: none;\n        }\n\n        .dark .tablet-panel-left,\n        .dark .tablet-panel-right {\n          border-color: #374151;\n        }\n\n        .tablet-main-content {\n          border: none;\n          overflow: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        .tablet-panel-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 1rem 1.5rem;\n          border-bottom: 1px solid #e5e7eb;\n          background: #f8f9fa;\n          flex-shrink: 0;\n        }\n\n        .dark .tablet-panel-header {\n          border-color: #374151;\n          background: #111827;\n        }\n\n        .tablet-panel-title {\n          font-weight: 600;\n          color: #1f2937;\n          font-size: 0.875rem;\n          white-space: nowrap;\n        }\n\n        .dark .tablet-panel-title {\n          color: #f9fafb;\n        }\n\n        .tablet-panel-toggle {\n          padding: 0.5rem;\n          border-radius: 0.5rem;\n          transition: all 0.2s ease;\n          color: #6b7280;\n        }\n\n        .tablet-panel-toggle:hover {\n          background: rgba(0, 0, 0, 0.05);\n          color: #374151;\n        }\n\n        .dark .tablet-panel-toggle {\n          color: #9ca3af;\n        }\n\n        .dark .tablet-panel-toggle:hover {\n          background: rgba(255, 255, 255, 0.05);\n          color: #d1d5db;\n        }\n\n        .tablet-panel-content {\n          flex: 1;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n          padding: 1rem;\n        }\n\n        .tablet-controls-shadow {\n          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .tablet-touch-target {\n          min-height: 44px;\n          min-width: 44px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n\n        .tablet-resizer {\n          position: relative;\n          width: 4px;\n          background: transparent;\n          cursor: col-resize;\n          user-select: none;\n          touch-action: none;\n          z-index: 10;\n          transition: background-color 0.2s ease;\n        }\n\n        .tablet-resizer:hover,\n        .tablet-resizer-active {\n          background: #ef4444;\n        }\n\n        .tablet-resizer-handle {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 20px;\n          height: 60px;\n          background: transparent;\n          border-radius: 4px;\n        }\n\n        .tablet-resizer:hover .tablet-resizer-handle,\n        .tablet-resizer-active .tablet-resizer-handle {\n          background: rgba(239, 68, 68, 0.1);\n        }\n\n        .tablet-gpu-accelerated {\n          transform: translateZ(0);\n          -webkit-transform: translateZ(0);\n          backface-visibility: hidden;\n          perspective: 1000px;\n        }\n\n        /* Landscape specific optimizations */\n        .tablet-layout-landscape {\n          /* Optimized for landscape orientation */\n        }\n\n        .tablet-layout-landscape .tablet-panel-left {\n          min-width: 280px;\n        }\n\n        .tablet-layout-landscape .tablet-panel-right {\n          min-width: 240px;\n        }\n\n        /* Portrait specific optimizations */\n        .tablet-layout-portrait {\n          /* Optimized for portrait orientation */\n        }\n\n        .tablet-layout-portrait .tablet-panel-left,\n        .tablet-layout-portrait .tablet-panel-right {\n          min-width: 200px;\n        }\n\n        /* Performance optimizations */\n        @media (prefers-reduced-motion: reduce) {\n          .tablet-layout-container,\n          .tablet-panel {\n            transition: none !important;\n          }\n        }\n\n        /* High DPI optimizations */\n        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {\n          .tablet-forum-layout {\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n          }\n        }\n\n        /* Responsive adjustments */\n        @media (max-width: 900px) {\n          .tablet-panel-left,\n          .tablet-panel-right {\n            min-width: 250px;\n          }\n        }\n\n        @media (max-width: 700px) {\n          .tablet-layout-container {\n            grid-template-columns: 1fr !important;\n          }\n          \n          .tablet-panel-left,\n          .tablet-panel-right {\n            display: none;\n          }\n        }\n\n        /* Accessibility improvements */\n        .tablet-resizer:focus-visible {\n          outline: 2px solid #ef4444;\n          outline-offset: 2px;\n        }\n\n        /* Dark mode scrollbar */\n        .dark .tablet-panel-content::-webkit-scrollbar {\n          width: 6px;\n        }\n\n        .dark .tablet-panel-content::-webkit-scrollbar-track {\n          background: #374151;\n        }\n\n        .dark .tablet-panel-content::-webkit-scrollbar-thumb {\n          background: #6b7280;\n          border-radius: 3px;\n        }\n\n        .dark .tablet-panel-content::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n      "})]})};var D=a(5462),V=a(6178);const B=e=>{let{threads:t=[],selectedThread:a=null,selectedThreadContent:r=null,onThreadSelect:s,onBack:l,splitRatio:d=.4,minPanelWidth:c=300,maxPanelWidth:h=600,orientation:x="horizontal",showThreadPreview:u=!0,onThreadAction:g,className:b=""}=e;const[w,j]=(0,n.useState)(d),[N,C]=(0,n.useState)(!1),[z,A]=(0,n.useState)(null),[S,T]=(0,n.useState)(!1),[M,E]=(0,n.useState)(!!a),L=(0,n.useRef)(null),R=(0,n.useRef)(null),F=(0,n.useCallback)((e=>{s&&s(e),E(!0)}),[s]),B=(0,n.useCallback)((()=>{E(!1),l&&l()}),[l]),W=(0,n.useCallback)((e=>{e.preventDefault(),C(!0);const t=e.clientX||e.touches&&e.touches[0].clientX,a=e.clientY||e.touches&&e.touches[0].clientY;A({x:t,y:a,ratio:w}),document.addEventListener("mousemove",I),document.addEventListener("mouseup",Y),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",Y)}),[w]),I=(0,n.useCallback)((e=>{if(!N||!z||!L.current)return;e.preventDefault();const t=e.clientX||e.touches&&e.touches[0].clientX,a=e.clientY||e.touches&&e.touches[0].clientY,r=L.current.getBoundingClientRect();let n;if("horizontal"===x){const e=(t-z.x)/r.width;n=z.ratio+e}else{const e=(a-z.y)/r.height;n=z.ratio+e}const s="horizontal"===x?r.width:r.height,l=c/s,o=h/s;n=Math.max(l,Math.min(o,n)),j(n)}),[N,z,x,c,h]),Y=(0,n.useCallback)((()=>{C(!1),A(null),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",Y),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",Y)}),[I]),H=e=>{try{return(0,V.m)(new Date(e),{addSuffix:!0})}catch(t){return"Unknown time"}},U=e=>{let{threads:t,selectedThread:a,onThreadSelect:r}=e;return(0,m.jsxs)("div",{className:"tablet-thread-list",children:[(0,m.jsxs)("div",{className:"tablet-thread-list-header",children:[(0,m.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Discussions"}),(0,m.jsx)("div",{className:"flex items-center space-x-2",children:(0,m.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.length," threads"]})})]}),(0,m.jsx)("div",{className:"tablet-thread-list-content",children:t.map((e=>{var t;return(0,m.jsx)("div",{className:"tablet-thread-item ".concat((null===a||void 0===a?void 0:a.id)===e.id?"tablet-thread-item-selected":""),onClick:()=>r(e),children:(0,m.jsx)("div",{className:"tablet-thread-item-main",children:(0,m.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,m.jsxs)("div",{className:"flex flex-col items-center space-y-1 flex-shrink-0 pt-1",children:[e.isPinned&&(0,m.jsx)(p.A,{className:"w-4 h-4 text-red-500"}),e.isHot&&(0,m.jsx)(o.A,{className:"w-4 h-4 text-orange-500"})]}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("h3",{className:"tablet-thread-title",children:e.title}),u&&e.excerpt&&(0,m.jsx)("p",{className:"tablet-thread-excerpt",children:e.excerpt}),(0,m.jsxs)("div",{className:"tablet-thread-meta",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-gray-500 dark:text-gray-400",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(v.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:(null===(t=e.author)||void 0===t?void 0:t.username)||"Anonymous"})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(i.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:e.replies_count||0})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(y.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:e.views_count||0})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(f.A,{className:"w-3 h-3"}),(0,m.jsx)("span",{children:H(e.updated_at||e.created_at)})]})]}),e.tags&&e.tags.length>0&&(0,m.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.tags.slice(0,2).map(((e,t)=>(0,m.jsx)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:e},t))),e.tags.length>2&&(0,m.jsxs)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:["+",e.tags.length-2]})]})]})]}),(0,m.jsxs)("div",{className:"flex flex-col items-center flex-shrink-0",children:[(0,m.jsx)("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:(e.upvotes||0)-(e.downvotes||0)}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"votes"})]})]})})},e.id)}))})]})},X=e=>{var t;let{thread:a,content:r,onBack:n,showBackButton:s=!1}=e;return(0,m.jsxs)("div",{className:"tablet-thread-detail",children:[(0,m.jsx)("div",{className:"tablet-thread-detail-header",children:(0,m.jsxs)("div",{className:"flex items-center space-x-3",children:[s&&(0,m.jsx)("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 tablet-touch-target",children:(0,m.jsx)(D.A,{className:"w-5 h-5"})}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:(null===a||void 0===a?void 0:a.title)||"Select a thread"}),a&&(0,m.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-500 dark:text-gray-400",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(v.A,{className:"w-4 h-4"}),(0,m.jsx)("span",{children:(null===(t=a.author)||void 0===t?void 0:t.username)||"Anonymous"})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,m.jsx)(f.A,{className:"w-4 h-4"}),(0,m.jsx)("span",{children:H(a.created_at)})]})]})]})]})}),(0,m.jsx)("div",{className:"tablet-thread-detail-content",children:r||(a?(0,m.jsxs)("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[(0,m.jsx)(i.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,m.jsx)("p",{children:"Thread content will be loaded here"})]}):(0,m.jsxs)("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:[(0,m.jsx)(_.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,m.jsx)("p",{children:"Select a thread from the list to view its content"})]}))})]})};return(0,m.jsxs)("div",{ref:L,className:"tablet-split-view ".concat(b," ").concat("vertical"===x?"tablet-split-vertical":"tablet-split-horizontal"),children:[(0,m.jsx)("div",{className:"tablet-split-mobile lg:hidden",children:M?(0,m.jsx)(X,{thread:a,content:r,onBack:B,showBackButton:!0}):(0,m.jsx)(U,{threads:t,selectedThread:a,onThreadSelect:F})}),(0,m.jsxs)("div",{className:"tablet-split-desktop hidden lg:flex",children:[(0,m.jsx)("div",{className:"tablet-split-panel tablet-split-left",style:{["horizontal"===x?"width":"height"]:S?"60px":"".concat(100*w,"%")},children:S?(0,m.jsx)("div",{className:"flex flex-col items-center justify-center h-full p-4",children:(0,m.jsx)("button",{onClick:()=>T(!1),className:"p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 tablet-touch-target",children:(0,m.jsx)(k.A,{className:"w-5 h-5"})})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(U,{threads:t,selectedThread:a,onThreadSelect:F}),(0,m.jsx)("button",{onClick:()=>T(!0),className:"absolute top-4 right-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 tablet-touch-target z-10",children:(0,m.jsx)(P.A,{className:"w-4 h-4"})})]})}),!S&&(0,m.jsx)("div",{ref:R,className:"tablet-split-resizer ".concat("horizontal"===x?"tablet-split-resizer-vertical":"tablet-split-resizer-horizontal"," ").concat(N?"tablet-split-resizer-dragging":""),onMouseDown:W,onTouchStart:W,children:(0,m.jsx)("div",{className:"tablet-split-resizer-handle"})}),(0,m.jsx)("div",{className:"tablet-split-panel tablet-split-right",style:{["horizontal"===x?"width":"height"]:S?"calc(100% - 60px)":"".concat(100*(1-w),"%")},children:(0,m.jsx)(X,{thread:a,content:r,onBack:B,showBackButton:!1})})]}),(0,m.jsx)("style",{jsx:!0,children:"\n        .tablet-split-view {\n          width: 100%;\n          height: 100vh;\n          overflow: hidden;\n          background: #f8f9fa;\n          contain: layout style;\n        }\n\n        .dark .tablet-split-view {\n          background: #111827;\n        }\n\n        .tablet-split-desktop {\n          height: 100%;\n          position: relative;\n        }\n\n        .tablet-split-horizontal .tablet-split-desktop {\n          flex-direction: row;\n        }\n\n        .tablet-split-vertical .tablet-split-desktop {\n          flex-direction: column;\n        }\n\n        .tablet-split-panel {\n          background: white;\n          overflow: hidden;\n          position: relative;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          contain: layout style paint;\n        }\n\n        .dark .tablet-split-panel {\n          background: #1f2937;\n        }\n\n        .tablet-split-left {\n          border-right: 1px solid #e5e7eb;\n        }\n\n        .dark .tablet-split-left {\n          border-color: #374151;\n        }\n\n        .tablet-split-vertical .tablet-split-left {\n          border-right: none;\n          border-bottom: 1px solid #e5e7eb;\n        }\n\n        .dark .tablet-split-vertical .tablet-split-left {\n          border-color: #374151;\n        }\n\n        .tablet-split-resizer {\n          background: transparent;\n          cursor: col-resize;\n          user-select: none;\n          touch-action: none;\n          z-index: 10;\n          position: relative;\n          transition: background-color 0.2s ease;\n        }\n\n        .tablet-split-resizer-vertical {\n          width: 6px;\n          cursor: col-resize;\n        }\n\n        .tablet-split-resizer-horizontal {\n          height: 6px;\n          cursor: row-resize;\n        }\n\n        .tablet-split-resizer:hover,\n        .tablet-split-resizer-dragging {\n          background: #ef4444;\n        }\n\n        .tablet-split-resizer-handle {\n          position: absolute;\n          background: transparent;\n          border-radius: 4px;\n        }\n\n        .tablet-split-resizer-vertical .tablet-split-resizer-handle {\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 20px;\n          height: 60px;\n        }\n\n        .tablet-split-resizer-horizontal .tablet-split-resizer-handle {\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 60px;\n          height: 20px;\n        }\n\n        .tablet-split-resizer:hover .tablet-split-resizer-handle,\n        .tablet-split-resizer-dragging .tablet-split-resizer-handle {\n          background: rgba(239, 68, 68, 0.1);\n        }\n\n        /* Thread List Styles */\n        .tablet-thread-list {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        }\n\n        .tablet-thread-list-header {\n          padding: 1.5rem 1.5rem 1rem;\n          border-bottom: 1px solid #e5e7eb;\n          background: #f8f9fa;\n          flex-shrink: 0;\n        }\n\n        .dark .tablet-thread-list-header {\n          border-color: #374151;\n          background: #111827;\n        }\n\n        .tablet-thread-list-content {\n          flex: 1;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        .tablet-thread-item {\n          padding: 1rem 1.5rem;\n          border-bottom: 1px solid #f3f4f6;\n          cursor: pointer;\n          transition: all 0.2s ease;\n          position: relative;\n        }\n\n        .tablet-thread-item:hover {\n          background: #f9fafb;\n        }\n\n        .tablet-thread-item-selected {\n          background: #fef2f2;\n          border-left: 4px solid #ef4444;\n        }\n\n        .dark .tablet-thread-item {\n          border-color: #374151;\n        }\n\n        .dark .tablet-thread-item:hover {\n          background: #374151;\n        }\n\n        .dark .tablet-thread-item-selected {\n          background: #1f1815;\n          border-color: #f87171;\n        }\n\n        .tablet-thread-title {\n          font-weight: 600;\n          color: #1f2937;\n          font-size: 0.95rem;\n          line-height: 1.4;\n          margin-bottom: 0.5rem;\n          display: -webkit-box;\n          -webkit-line-clamp: 2;\n          -webkit-box-orient: vertical;\n          overflow: hidden;\n        }\n\n        .dark .tablet-thread-title {\n          color: #f9fafb;\n        }\n\n        .tablet-thread-excerpt {\n          font-size: 0.85rem;\n          color: #6b7280;\n          line-height: 1.4;\n          margin-bottom: 0.75rem;\n          display: -webkit-box;\n          -webkit-line-clamp: 2;\n          -webkit-box-orient: vertical;\n          overflow: hidden;\n        }\n\n        .dark .tablet-thread-excerpt {\n          color: #9ca3af;\n        }\n\n        .tablet-thread-meta {\n          margin-top: 0.75rem;\n        }\n\n        /* Thread Detail Styles */\n        .tablet-thread-detail {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        }\n\n        .tablet-thread-detail-header {\n          padding: 1.5rem;\n          border-bottom: 1px solid #e5e7eb;\n          background: #f8f9fa;\n          flex-shrink: 0;\n        }\n\n        .dark .tablet-thread-detail-header {\n          border-color: #374151;\n          background: #111827;\n        }\n\n        .tablet-thread-detail-content {\n          flex: 1;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        /* Touch targets */\n        .tablet-touch-target {\n          min-height: 44px;\n          min-width: 44px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          touch-action: manipulation;\n        }\n\n        /* Mobile optimizations */\n        .tablet-split-mobile {\n          height: 100vh;\n          overflow: hidden;\n        }\n\n        /* Performance optimizations */\n        @media (prefers-reduced-motion: reduce) {\n          .tablet-split-panel,\n          .tablet-split-resizer,\n          .tablet-thread-item {\n            transition: none !important;\n          }\n        }\n\n        /* High DPI optimizations */\n        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {\n          .tablet-split-view {\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n          }\n        }\n\n        /* Custom scrollbar for thread list */\n        .tablet-thread-list-content::-webkit-scrollbar {\n          width: 6px;\n        }\n\n        .tablet-thread-list-content::-webkit-scrollbar-track {\n          background: #f1f5f9;\n        }\n\n        .tablet-thread-list-content::-webkit-scrollbar-thumb {\n          background: #cbd5e1;\n          border-radius: 3px;\n        }\n\n        .tablet-thread-list-content::-webkit-scrollbar-thumb:hover {\n          background: #94a3b8;\n        }\n\n        .dark .tablet-thread-list-content::-webkit-scrollbar-track {\n          background: #374151;\n        }\n\n        .dark .tablet-thread-list-content::-webkit-scrollbar-thumb {\n          background: #6b7280;\n        }\n\n        .dark .tablet-thread-list-content::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n      "})]})};var W=a(6987),I=a(743),Y=a(7453);if("undefined"!==typeof document&&!document.getElementById("mobile-forum-styles")){const e=document.createElement("style");e.id="mobile-forum-styles",e.textContent="\n  .mobile-forum-wrapper {\n    contain: layout style;\n    will-change: transform;\n    -webkit-overflow-scrolling: touch;\n  }\n  \n  .touch-optimized {\n    min-height: 44px;\n    min-width: 44px;\n    -webkit-tap-highlight-color: rgba(239, 68, 68, 0.1);\n    tap-highlight-color: rgba(239, 68, 68, 0.1);\n  }\n  \n  .mobile-thread-list {\n    contain: strict;\n    will-change: transform;\n  }\n  \n  .line-clamp-2 {\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n  }\n  \n  .tablet-forum-layout-wrapper {\n    height: 100vh;\n    overflow: hidden;\n  }\n  \n  .tablet-forum-sidebar,\n  .tablet-forum-activity {\n    height: 100%;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n  \n  @media (prefers-reduced-motion: reduce) {\n    .mobile-forum-wrapper *,\n    .tablet-forum-layout-wrapper * {\n      animation-duration: 0.01ms !important;\n      transition-duration: 0.01ms !important;\n    }\n  }\n  \n  @media (max-width: 767px) {\n    .mobile-input-no-zoom {\n      font-size: 16px !important;\n      transform: translateZ(0);\n    }\n    \n    .scrollbar-hide {\n      -ms-overflow-style: none;\n      scrollbar-width: none;\n    }\n    \n    .scrollbar-hide::-webkit-scrollbar {\n      display: none;\n    }\n  }\n",document.head.appendChild(e)}const H=function(e){let{navigateTo:t}=e;const{isAuthenticated:a,isAdmin:o,isModerator:c,api:x,user:g}=(0,s.As)(),[b,p]=(0,n.useState)("all"),[v,f]=(0,n.useState)("latest"),[k,w]=(0,n.useState)(""),[z,A]=(0,n.useState)([]),[_,T]=(0,n.useState)([]),[M,E]=(0,n.useState)(!0),[L,P]=(0,n.useState)(!1),[R,D]=(0,n.useState)("list"),[V,H]=(0,n.useState)(!1),[U,X]=(0,n.useState)(0),[q,G]=(0,n.useState)(!1),[Z,O]=(0,n.useState)([]),[Q,J]=(0,n.useState)(null),[K,$]=(0,n.useState)("split-view"),[ee,te]=(0,n.useState)(window.innerWidth<768),[ae,re]=(0,n.useState)(!1),[ne,se]=(0,n.useState)(1),[le,oe]=(0,n.useState)(!1),ie=(0,n.useRef)(null),de=(0,n.useRef)(0),ce=(0,n.useRef)(null),he=(0,n.useCallback)((async e=>{try{var t,a;E(!0);const n=new URLSearchParams;"all"!==b&&n.append("category",b),v&&n.append("sort",v);const s="string"===typeof(r=e||"")?r:"";s.trim()&&n.append("search",s.trim());const[l,o]=await Promise.all([x.get("/forums/threads?".concat(n.toString())),x.get("/forums/categories")]),i=(null===(t=l.data)||void 0===t?void 0:t.data)||l.data||[],d=(null===(a=o.data)||void 0===a?void 0:a.data)||o.data||[];console.log("Forum threads loaded:",i.length),console.log("Forum categories loaded:",d.length),A(i),T(d)}catch(n){console.error("ForumsPage: Backend API failed:",n),A([]),T([])}finally{E(!1)}var r}),[x,b,v]);(0,n.useEffect)((()=>{he(k)}),[b,v,he]),(0,n.useEffect)((()=>{if(!k.trim())return void he("");const e=setTimeout((()=>{he(k)}),500);return()=>clearTimeout(e)}),[k,he]);const xe=(0,n.useCallback)((e=>{ie.current&&0===ie.current.scrollTop&&(de.current=e.touches[0].clientY)}),[]),me=(0,n.useCallback)((e=>{if(de.current&&ie.current&&0===ie.current.scrollTop){const t=e.touches[0].clientY,a=Math.max(0,Math.min(120,t-de.current));X(a)}}),[]),ue=(0,n.useCallback)((async()=>{if(U>80){H(!0);try{await he(k)}finally{H(!1)}}X(0),de.current=0}),[U,he,k]),ge=(0,n.useCallback)((async e=>{if(!e||e.length<2)O([]);else try{var t;const a=await x.get("/forums/search/suggestions?q=".concat(encodeURIComponent(e)));O((null===(t=a.data)||void 0===t?void 0:t.suggestions)||[])}catch(a){console.error("Failed to fetch search suggestions:",a),O([])}}),[x]),be=async e=>{try{await x.post("/user/forums/threads/".concat(e,"/bookmark"));const t=document.createElement("div");t.className="fixed bottom-20 left-4 right-4 bg-green-500 text-white p-3 rounded-lg text-center z-50",t.textContent="Thread bookmarked!",document.body.appendChild(t),setTimeout((()=>document.body.removeChild(t)),2e3)}catch(t){console.error("Failed to bookmark thread:",t)}},pe=async e=>{if(navigator.share)try{await navigator.share({title:e.title,text:"Check out this discussion: ".concat(e.title),url:"".concat(window.location.origin,"/forums/threads/").concat(e.id)})}catch(t){console.error("Failed to share:",t)}else{const t="".concat(window.location.origin,"/forums/threads/").concat(e.id);navigator.clipboard.writeText(t).then((()=>{const e=document.createElement("div");e.className="fixed bottom-20 left-4 right-4 bg-blue-500 text-white p-3 rounded-lg text-center z-50",e.textContent="Link copied to clipboard!",document.body.appendChild(e),setTimeout((()=>document.body.removeChild(e)),2e3)}))}},ve=(0,n.useCallback)((e=>{J(e),t&&t("thread-detail",{id:e.id})}),[t]),ye=(0,n.useCallback)((async(e,t)=>{if(a)try{await x.post("/user/forums/threads/".concat(e,"/vote"),{vote_type:t}),A((a=>a.map((a=>{if(a.id===e){const e=(0,r.A)({},a);return"up"===t?(e.upvotes=(e.upvotes||0)+1,e.userVote="up"):"down"===t&&(e.downvotes=(e.downvotes||0)+1,e.userVote="down"),e}return a}))))}catch(n){console.error("Failed to vote on thread:",n)}}),[x,a]),fe=(0,n.useCallback)((async()=>{if(!le&&ae){oe(!0);try{var e;const t=new URLSearchParams;t.append("page",ne+1),"all"!==b&&t.append("category",b),v&&t.append("sort",v),k.trim()&&t.append("search",k.trim());const a=await x.get("/forums/threads?".concat(t.toString())),r=(null===(e=a.data)||void 0===e?void 0:e.data)||a.data||[];r.length>0?(A((e=>[...e,...r])),se((e=>e+1)),re(r.length>=20)):re(!1)}catch(t){console.error("Failed to load more threads:",t)}finally{oe(!1)}}}),[le,ae,ne,b,v,k,x]),ke=(0,n.useCallback)((()=>{t&&t("create-thread")}),[t]),we=(0,n.useCallback)((e=>{w(e.query||e.title),G(!1),O([])}),[]),je=e=>v===e?(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"\u25bc"}):null,Ne=e=>{const t=_.find((t=>t.slug===e));return(null===t||void 0===t?void 0:t.color)||"#6b7280"},Ce=e=>{const t=_.find((t=>t.slug===e));return(null===t||void 0===t?void 0:t.icon)||""};if(M)return(0,m.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,m.jsxs)("div",{className:"text-center",children:[(0,m.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,m.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading forums..."})]})});const ze=window.innerWidth<768,Ae=window.innerWidth>=768&&window.innerWidth<1200;return window.innerWidth,ze?(0,m.jsxs)("div",{className:"mobile-forum-wrapper min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,m.jsx)(u,{categories:_,selectedCategory:b,onCategoryChange:p,searchQuery:k,onSearchChange:w,sortBy:v,onSortChange:f,viewMode:R,onViewModeChange:D,onCreateThread:ke,showSearchSuggestions:q&&Z.length>0,searchSuggestions:Z,onSearchSuggestionSelect:we,isAuthenticated:a}),(0,m.jsx)("div",{className:"pt-20 pb-20 px-0",children:ee?(0,m.jsx)(S,{threads:z,onThreadClick:ve,onVote:ye,onBookmark:be,onShare:pe,onLoadMore:fe,hasMore:ae,loading:le,viewMode:R,selectedThreadId:null===Q||void 0===Q?void 0:Q.id,isAuthenticated:a,height:window.innerHeight-160,className:"mobile-thread-list"}):(0,m.jsx)("div",{className:"space-y-1",children:z.map((e=>{var t;return(0,m.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700 p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors touch-optimized",onClick:()=>ve(e),children:(0,m.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2",children:e.title}),(0,m.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-500 dark:text-gray-400",children:[(0,m.jsx)("span",{children:(null===(t=e.author)||void 0===t?void 0:t.username)||"Anonymous"}),(0,m.jsx)("span",{children:"\u2022"}),(0,m.jsx)("span",{children:(0,C.ak)(e.created_at)}),(0,m.jsx)("span",{children:"\u2022"}),(0,m.jsxs)("span",{children:[e.replies_count||0," replies"]})]})]}),(0,m.jsxs)("div",{className:"text-right flex-shrink-0",children:[(0,m.jsx)("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(e.upvotes||0)-(e.downvotes||0)}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"votes"})]})]})},e.id)}))})})]}):Ae?(0,m.jsx)(F,{defaultLayout:K,onLayoutChange:$,leftPanel:(0,m.jsx)("div",{className:"tablet-forum-sidebar",children:(0,m.jsxs)("div",{className:"p-4",children:[(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Categories"}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("button",{onClick:()=>p("all"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors ".concat("all"===b?"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"All Categories"}),_.map((e=>(0,m.jsxs)("button",{onClick:()=>p(e.slug),className:"w-full text-left px-3 py-2 rounded-lg transition-colors ".concat(b===e.slug?"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"),children:[e.icon," ",e.name]},e.id)))]})]})}),rightPanel:(0,m.jsx)("div",{className:"tablet-forum-activity",children:(0,m.jsxs)("div",{className:"p-4",children:[(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Activity"}),(0,m.jsx)("div",{className:"space-y-3",children:(0,m.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recent activity will be shown here"})})]})}),mainContent:(0,m.jsx)(B,{threads:z,selectedThread:Q,onThreadSelect:ve,showThreadPreview:!0,onThreadAction:(e,t)=>{switch(e){case"bookmark":be(t.id);break;case"share":pe(t);break;case"vote":ye(t.id,"up")}},className:"h-full"}),className:"tablet-forum-layout-wrapper"}):(0,m.jsxs)("div",{ref:ie,className:"max-w-6xl mx-auto mobile-forum-container relative",onTouchStart:xe,onTouchMove:me,onTouchEnd:ue,children:[U>0&&(0,m.jsx)("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-200",style:{transform:"translateX(-50%) translateY(".concat(Math.max(0,U-80),"px)")},children:(0,m.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-full p-3 shadow-lg border border-gray-200 dark:border-gray-700",children:(0,m.jsx)(W.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 ".concat(V?"animate-spin":"")})})}),(0,m.jsxs)("div",{className:"lg:hidden sticky top-16 bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg z-40 -mx-4 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,m.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Forums"}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:()=>P(!L),className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 touch-optimized",children:(0,m.jsx)(d.A,{className:"w-5 h-5"})}),a&&(0,m.jsx)("button",{onClick:()=>t&&t("create-thread"),className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors touch-optimized",children:"New"})]})]}),(0,m.jsxs)("div",{className:"relative mb-3",children:[(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,m.jsx)("input",{ref:ce,type:"text",value:k,onChange:e=>{w(e.target.value),G(!0),ge(e.target.value)},placeholder:"Search discussions...",className:"w-full pl-10 pr-4 py-2.5 bg-gray-100 dark:bg-gray-800 border-none rounded-lg text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-red-500 mobile-input-no-zoom"})]}),q&&Z.length>0&&(0,m.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50 max-h-60 overflow-y-auto",children:Z.map(((e,t)=>(0,m.jsxs)("button",{onClick:()=>{return t=e.query,w(t),G(!1),void O([]);var t},className:"w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 last:border-b-0",children:[(0,m.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),(0,m.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.category})]},t)))})]}),(0,m.jsxs)("div",{className:"flex space-x-2 overflow-x-auto scrollbar-hide pb-2",children:[(0,m.jsx)("button",{onClick:()=>p("all"),className:"flex-shrink-0 px-4 py-2 rounded-lg font-medium transition-colors ".concat("all"===b?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"),children:"All"}),_.map((e=>(0,m.jsxs)("button",{onClick:()=>p(e.slug),className:"flex-shrink-0 px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap ".concat(b===e.slug?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"),children:[e.icon," ",e.name]},e.id)))]})]}),(0,m.jsxs)("div",{className:"hidden lg:flex items-center justify-between mb-4",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Forums"}),(0,m.jsxs)("div",{className:"flex space-x-2",children:[(o()||c())&&(0,m.jsx)("button",{onClick:()=>t&&t("admin-forum-categories"),className:"px-3 py-1.5 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:"Manage Categories"}),a&&(0,m.jsx)("button",{onClick:()=>t&&t("create-thread"),className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"New Thread"})]})]}),(0,m.jsx)("div",{className:"card p-3 mb-4",children:(0,m.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[(0,m.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Search"}),(0,m.jsx)("input",{type:"text",value:k,onChange:e=>w(e.target.value),placeholder:"Search threads...",className:"text-sm bg-transparent border border-gray-300 dark:border-gray-600 rounded px-3 py-1 text-gray-900 dark:text-white flex-1 md:max-w-xs"}),k&&(0,m.jsx)("button",{onClick:()=>w(""),className:"text-xs text-gray-500 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:"Clear search",children:"\u2715"})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Category:"}),(0,m.jsxs)("select",{value:b,onChange:e=>p(e.target.value),className:"text-sm bg-transparent border border-gray-300 dark:border-gray-600 rounded px-2 py-1 text-gray-900 dark:text-white",children:[(0,m.jsx)("option",{value:"all",children:"All Categories"}),_.map((e=>(0,m.jsxs)("option",{value:e.slug,children:[e.icon," ",e.name]},e.id)))]})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,m.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sort by:"}),(0,m.jsxs)("button",{onClick:()=>f("latest"),className:"text-sm font-medium transition-colors ".concat("latest"===v?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Latest ",je("latest")]}),(0,m.jsxs)("button",{onClick:()=>f("popular"),className:"text-sm font-medium transition-colors ".concat("popular"===v?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Popular ",je("popular")]}),(0,m.jsxs)("button",{onClick:()=>f("hot"),className:"text-sm font-medium transition-colors ".concat("hot"===v?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400"),children:["Hot ",je("hot")]})]})]})}),z.length>0?(0,m.jsxs)("div",{className:"space-y-1",children:[(0,m.jsxs)("div",{className:"hidden md:grid md:grid-cols-10 gap-4 px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-500 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,m.jsx)("div",{className:"col-span-6",children:"THREAD"}),(0,m.jsx)("div",{className:"col-span-2 text-center",children:"REPLIES"}),(0,m.jsx)("div",{className:"col-span-2 text-center",children:"LAST REPLY"})]}),z.map((e=>{var a,n,s,d,h,u,g,b,p,v,f,k,w,S,_,T,M;return(0,m.jsxs)("div",{className:"card mobile-card relative overflow-hidden touch-optimized",children:[(0,m.jsx)("div",{className:"lg:hidden",children:(0,m.jsxs)("div",{className:"p-4 cursor-pointer",onClick:()=>t&&t("thread-detail",{id:e.id}),children:[(0,m.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[e.pinned&&(0,m.jsx)("span",{className:"px-2 py-1 text-xs font-bold rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",children:"\ud83d\udccc PINNED"}),e.locked&&(0,m.jsx)("span",{className:"px-2 py-1 text-xs font-bold rounded bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",children:"\ud83d\udd12 LOCKED"}),(0,m.jsxs)("span",{className:"px-2 py-1 text-xs font-bold rounded text-white",style:{backgroundColor:(null===(a=e.category)||void 0===a?void 0:a.color)||Ne(e.category_slug)},children:[Ce((null===(n=e.category)||void 0===n?void 0:n.slug)||e.category_slug)," ",(null===(s=e.category)||void 0===s?void 0:s.name)||e.category_name||"General"]})]}),(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2 hover:text-red-600 dark:hover:text-red-400 transition-colors",children:e.title}),(0,m.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,m.jsx)(l.A,{user:e.author,showAvatar:!0,showHeroFlair:!1,showTeamFlair:!1,size:"xs",clickable:!1}),(0,m.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:(0,C.ak)((null===(d=e.meta)||void 0===d?void 0:d.created_at)||e.created_at)})]})]}),(0,m.jsx)("div",{className:"flex-shrink-0 ml-3",children:(0,m.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400",children:(0,m.jsx)(I.A,{className:"w-4 h-4"})})})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[(0,m.jsx)(i.A,{className:"w-4 h-4"}),(0,m.jsx)("span",{className:"text-sm font-medium",children:(null===(h=e.stats)||void 0===h?void 0:h.replies)||e.posts_count||e.replies_count||e.replies||0})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[(0,m.jsx)(y.A,{className:"w-4 h-4"}),(0,m.jsx)("span",{className:"text-sm",children:(null===(u=e.stats)||void 0===u?void 0:u.views)||e.views||0})]})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),be(e.id)},className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 hover:text-blue-500 transition-colors",children:(0,m.jsx)(j.A,{className:"w-4 h-4"})}),(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),pe(e)},className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 hover:text-green-500 transition-colors",children:(0,m.jsx)(N.A,{className:"w-4 h-4"})})]})]}),(0,m.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:(null===(g=e.stats)||void 0===g?void 0:g.replies)>0||null!==(b=e.meta)&&void 0!==b&&b.last_reply_at?(0,m.jsxs)(m.Fragment,{children:["Last reply ",(0,C.ak)((null===(p=e.meta)||void 0===p?void 0:p.last_reply_at)||e.last_reply_at||e.last_post_at||e.updated_at)]}):"No replies yet"}),(0,m.jsx)(Y.A,{className:"w-4 h-4 text-gray-400 transform -rotate-90"})]})})]})}),(0,m.jsxs)("div",{className:"hidden lg:block p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer border-l-4 border-transparent hover:border-red-600",onClick:()=>t&&t("thread-detail",{id:e.id}),children:[(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-4 items-center",children:[(0,m.jsx)("div",{className:"md:col-span-6",children:(0,m.jsx)("div",{className:"flex items-start space-x-3",children:(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[e.pinned&&(0,m.jsx)("span",{className:"px-1.5 py-0.5 text-xs font-bold rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",children:"\ud83d\udccc PINNED"}),e.locked&&(0,m.jsx)("span",{className:"px-1.5 py-0.5 text-xs font-bold rounded bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",children:"\ud83d\udd12 LOCKED"}),(0,m.jsxs)("span",{className:"px-2 py-0.5 text-xs font-bold rounded-full text-white",style:{backgroundColor:(null===(v=e.category)||void 0===v?void 0:v.color)||Ne(e.category_slug)},children:[Ce((null===(f=e.category)||void 0===f?void 0:f.slug)||e.category_slug)," ",(null===(k=e.category)||void 0===k?void 0:k.name)||e.category_name||"General"]})]}),(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1 hover:text-red-600 dark:hover:text-red-400 transition-colors line-clamp-1",children:e.title}),(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:"by"}),(0,m.jsx)(l.A,{user:e.author,showAvatar:!0,showHeroFlair:!0,showTeamFlair:!0,size:"xs",clickable:!1}),(0,m.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:(0,C.ak)((null===(w=e.meta)||void 0===w?void 0:w.created_at)||e.created_at)})]})]})})}),(0,m.jsxs)("div",{className:"md:col-span-2 md:text-center",children:[(0,m.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(null===(S=e.stats)||void 0===S?void 0:S.replies)||e.posts_count||e.replies_count||e.replies||0}),(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-500 md:hidden",children:"replies"})]}),(0,m.jsx)("div",{className:"md:col-span-2 md:text-center",children:(null===(_=e.stats)||void 0===_?void 0:_.replies)>0||null!==(T=e.meta)&&void 0!==T&&T.last_reply_at?(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:(0,C.ak)((null===(M=e.meta)||void 0===M?void 0:M.last_reply_at)||e.last_reply_at||e.last_post_at||e.updated_at)}):(0,m.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"No replies"})})]}),(o()||c())&&(0,m.jsxs)("div",{className:"md:col-span-10 mt-2 pt-2 border-t border-gray-200 dark:border-gray-700 flex items-center space-x-2",children:[(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{const a=[...z];A(a.map((a=>a.id===e?(0,r.A)((0,r.A)({},a),{},{pinned:t}):a)));try{const a="/admin/forums/threads/".concat(e,t?"/pin":"/unpin");await x.post(a),console.log("\u2705 Thread ".concat(t?"pinned":"unpinned"," successfully"))}catch(n){console.error("Error pinning/unpinning thread:",n),A(a),alert("Failed to "+(t?"pin":"unpin")+" thread")}})(e.id,!e.pinned)},className:"px-2 py-1 text-xs rounded transition-colors ".concat(e.pinned?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300 hover:bg-yellow-200 dark:hover:bg-yellow-900/30":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.pinned?"\ud83d\udccc Unpin":"\ud83d\udccc Pin"}),(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{const a=[...z];A(a.map((a=>a.id===e?(0,r.A)((0,r.A)({},a),{},{locked:t}):a)));try{const a="/admin/forums/threads/".concat(e,t?"/lock":"/unlock");await x.post(a),console.log("\u2705 Thread ".concat(t?"locked":"unlocked"," successfully"))}catch(n){console.error("Error locking/unlocking thread:",n),A(a),alert("Failed to "+(t?"lock":"unlock")+" thread")}})(e.id,!e.locked)},className:"px-2 py-1 text-xs rounded transition-colors ".concat(e.locked?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/30":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.locked?"\ud83d\udd13 Unlock":"\ud83d\udd12 Lock"}),(0,m.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this thread? This action cannot be undone.")){const a=[...z];A(a.filter((t=>t.id!==e)));try{await x.post("/admin/forums/threads/".concat(e,"/delete")),console.log("\u2705 Thread deleted successfully")}catch(t){console.error("Error deleting thread:",t),A(a),alert("Failed to delete thread")}}})(e.id)},className:"px-2 py-1 text-xs bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300 rounded hover:bg-red-200 dark:hover:bg-red-900/30 transition-colors",children:"\ud83d\uddd1\ufe0f Delete"})]})]})]},e.id)}))]}):(0,m.jsxs)("div",{className:"card p-12 text-center",children:[(0,m.jsx)("div",{className:"text-4xl mb-4",children:k?"No Results":"No Threads"}),(0,m.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:k?"No Search Results":"No Threads Found"}),(0,m.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:k?'No threads found matching "'.concat(k,'". Try different keywords or browse categories.'):"all"!==b?"No threads found in the selected category.":"No forum threads available. Be the first to start a discussion!"}),(0,m.jsxs)("div",{className:"flex justify-center space-x-4",children:[k&&(0,m.jsx)("button",{onClick:()=>w(""),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Clear Search"}),"all"!==b&&!k&&(0,m.jsx)("button",{onClick:()=>p("all"),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"View All Categories"}),a&&(0,m.jsx)("button",{onClick:()=>t&&t("create-thread"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Start New Thread"})]})]}),!a&&(0,m.jsxs)("div",{className:"card p-6 mt-6 text-center",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Join the Community"}),(0,m.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Sign in to create threads, reply to posts, and participate in discussions."}),(0,m.jsx)("button",{onClick:()=>window.dispatchEvent(new CustomEvent("mrvl-show-auth-modal")),className:"px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Sign In to Participate"})]})]})}},8574:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(9950),n=a(5150),s=a(8091),l=a(631),o=a(4414);const i=function(e){let{itemType:t,itemId:a,parentId:i=null,initialUpvotes:d=0,initialDownvotes:c=0,userVote:h=null,onVoteChange:x=null,size:m="sm",direction:u="horizontal"}=e;const{api:g,user:b,isAuthenticated:p}=(0,n.As)(),{triggerVote:v}=(0,s.VJ)(),[y,f]=(0,r.useState)(d),[k,w]=(0,r.useState)(c),[j,N]=(0,r.useState)(h),[C,z]=(0,r.useState)(!1),A={xs:"p-1 text-xs min-h-[36px] min-w-[36px]",sm:"p-1.5 text-sm min-h-[40px] min-w-[40px]",md:"p-2 text-base min-h-[44px] min-w-[44px]",lg:"p-3 text-lg min-h-[48px] min-w-[48px]"},S=async e=>{if(!p)return void(0,l.Ni)("Please log in to vote");if(C)return;if(a&&a.toString().startsWith("temp-"))return void(0,l.rQ)("Please wait for the post to be created before voting");j===e&&console.log("User removing existing vote:",e),z(!0);const r=y,n=k,s=j;j===e?("upvote"===e?f((e=>Math.max(0,e-1))):w((e=>Math.max(0,e-1))),N(null)):j?("upvote"===e?(f((e=>e+1)),w((e=>Math.max(0,e-1)))):(w((e=>e+1)),f((e=>Math.max(0,e-1)))),N(e)):("upvote"===e?f((e=>e+1)):w((e=>e+1)),N(e));try{var o,d,c,h,m,u;const p={votable_type:t,votable_id:a,vote_type:e,parent_id:i||null};let C;if(console.log("Sending vote request:",p),"news"===t)C=await g.post("/news/".concat(a,"/vote"),{vote_type:e});else if("news_comment"===t)try{C=await g.post("/news/comments/".concat(a,"/vote"),{vote_type:e})}catch(V){console.log("News comment vote failed, using fallback:",V.message),C=await g.post("/user/votes/",p)}else C=await g.post("/user/votes/",p);console.log("\ud83d\udcc4 Raw Response:",C),console.log("\u2705 API Success:",C.data||C);const z=C&&(!0===C.success||!0===(null===(o=C.data)||void 0===o?void 0:o.success)||C.status>=200&&C.status<300&&!1!==(null===(d=C.data)||void 0===d?void 0:d.success)&&!1!==C.success);var b,A,S;if(console.log("Vote response validation:",{responseSuccess:null===(c=C)||void 0===c?void 0:c.success,dataSuccess:null===(h=C)||void 0===h||null===(m=h.data)||void 0===m?void 0:m.success,status:null===(u=C)||void 0===u?void 0:u.status,isSuccess:z}),!z)throw console.warn("Vote request returned success=false:",null===(b=C)||void 0===b?void 0:b.data),new Error((null===(A=C)||void 0===A||null===(S=A.data)||void 0===S?void 0:S.message)||"Vote request failed");{var _,T,M,E;const t=C.data||C,a=(null===t||void 0===t?void 0:t.vote_counts)||(null===t||void 0===t||null===(_=t.data)||void 0===_?void 0:_.vote_counts)||(null===t||void 0===t?void 0:t.updated_stats),o=void 0!==(null===t||void 0===t?void 0:t.user_vote)?null===t||void 0===t?void 0:t.user_vote:void 0!==(null===t||void 0===t||null===(T=t.data)||void 0===T?void 0:T.user_vote)?null===t||void 0===t||null===(M=t.data)||void 0===M?void 0:M.user_vote:null===t||void 0===t?void 0:t.vote_type,i=(null===t||void 0===t?void 0:t.action)||(null===t||void 0===t||null===(E=t.data)||void 0===E?void 0:E.action);console.log("Vote response:",{voteCounts:a,newUserVote:o,action:i}),a?(f(Math.max(0,a.upvotes||0)),w(Math.max(0,a.downvotes||0))):i&&("removed"===i?(N(null),"upvote"===s&&f(Math.max(0,r-1)),"downvote"===s&&w(Math.max(0,n-1))):"created"===i?(N(e),"upvote"===e&&f(r+1),"downvote"===e&&w(n+1)):"updated"===i&&(N(e),"upvote"===s&&"downvote"===e?(f(Math.max(0,r-1)),w(n+1)):"downvote"===s&&"upvote"===e&&(w(Math.max(0,n-1)),f(r+1)))),void 0!==o&&N(o);const d="removed"===i?"Vote removed":"updated"===i?"Vote updated":"Vote recorded";(0,l.GF)(d,2e3),v(),x&&x({action:i||"created",vote_counts:a||{upvotes:y,downvotes:k},user_vote:j,score:y-k})}}catch(B){var L,P,R,F,D;console.error("Error voting:",B);let e="Failed to record vote";409===(null===(L=B.response)||void 0===L?void 0:L.status)?e="You have already voted. Please refresh the page.":401===(null===(P=B.response)||void 0===P?void 0:P.status)?e="Please log in again to vote":403===(null===(R=B.response)||void 0===R?void 0:R.status)?e="You do not have permission to vote on this item":null!==(F=B.response)&&void 0!==F&&null!==(D=F.data)&&void 0!==D&&D.message?e=B.response.data.message:B.message&&"Network Error"!==B.message&&(e=B.message),f(r),w(n),N(s),(0,l.Ni)(e,4e3)}finally{z(!1)}},_=()=>y-k,T=()=>{const e=_();return e>0?"text-green-600 dark:text-green-400":e<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"};return"vertical"===u?(0,o.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,o.jsx)("button",{onClick:()=>S("upvote"),disabled:C,className:"".concat(A[m]," rounded transition-all duration-200 flex items-center justify-center touch-manipulation ").concat("upvote"===j?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400 transform scale-110":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-green-600 dark:hover:text-green-400 active:scale-95"," ").concat(C?"opacity-50 cursor-not-allowed":""),style:{WebkitTapHighlightColor:"rgba(34, 197, 94, 0.1)"},children:"\ud83d\udc4d"}),(0,o.jsx)("span",{className:"text-xs font-medium ".concat(T()),children:_()}),(0,o.jsx)("button",{onClick:()=>S("downvote"),disabled:C,className:"".concat(A[m]," rounded transition-all duration-200 flex items-center justify-center touch-manipulation ").concat("downvote"===j?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400 transform scale-110":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-red-600 dark:hover:text-red-400 active:scale-95"," ").concat(C?"opacity-50 cursor-not-allowed":""),style:{WebkitTapHighlightColor:"rgba(239, 68, 68, 0.1)"},children:"\ud83d\udc4e"})]}):(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsxs)("button",{onClick:()=>S("upvote"),disabled:C,className:"".concat(A[m]," rounded transition-all duration-200 flex items-center justify-center space-x-1 touch-manipulation ").concat("upvote"===j?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400 transform scale-105":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-green-600 dark:hover:text-green-400 active:scale-95"," ").concat(C?"opacity-50 cursor-not-allowed":""),style:{WebkitTapHighlightColor:"rgba(34, 197, 94, 0.1)"},children:[(0,o.jsx)("span",{children:"\ud83d\udc4d"}),(0,o.jsx)("span",{className:"text-xs font-medium",children:y})]}),(0,o.jsxs)("button",{onClick:()=>S("downvote"),disabled:C,className:"".concat(A[m]," rounded transition-all duration-200 flex items-center justify-center space-x-1 touch-manipulation ").concat("downvote"===j?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400 transform scale-105":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-red-600 dark:hover:text-red-400 active:scale-95"," ").concat(C?"opacity-50 cursor-not-allowed":""),style:{WebkitTapHighlightColor:"rgba(239, 68, 68, 0.1)"},children:[(0,o.jsx)("span",{children:"\ud83d\udc4e"}),(0,o.jsx)("span",{className:"text-xs font-medium",children:k})]})]})}},9332:(e,t,a)=>{a.d(t,{ak:()=>n});const r=e=>{if(!e)return!1;const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())},n=e=>{if(!e||"unknown"===e||"null"===e||null===e||void 0===e)return"Recently";if("string"===typeof e&&""===e.trim())return"Recently";if(!r(e))return console.warn("formatTimeAgo: Invalid date format:",e),"Recently";try{const t=new Date(e),a=new Date,r=a.getTime()-t.getTime(),n=Math.floor(r/6e4),s=Math.floor(r/36e5),l=Math.floor(r/864e5);if(r<0){const e=Math.abs(n),a=Math.abs(s),r=Math.abs(l);return e<60?"in ".concat(e,"m"):a<24?"in ".concat(a,"h"):r<7?"in ".concat(r,"d"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}return n<1?"now":n<60?"".concat(n,"m ago"):s<24?"".concat(s,"h ago"):l<7?"".concat(l,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==a.getFullYear()?"numeric":void 0})}catch(t){return console.warn("formatTimeAgo: Date parsing error:",t,"for date:",e),"Recently"}}}}]);