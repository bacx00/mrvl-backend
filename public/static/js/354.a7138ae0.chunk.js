/*! For license information please see 354.a7138ae0.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[354],{1742:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(6230).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2607:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(6230).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4814:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(6230).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7838:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(6230).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9354:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var s=a(2555),r=a(9950),n=a(5150),i=a(6225),l=a(9549),d=a(575),o=a(6149),c=a(6230);const m=(0,c.A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),u=(0,c.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=a(6987);const h=(0,c.A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var g=a(1742);const v=(0,c.A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),p=(0,c.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var b=a(7838),y=a(9318),f=a(2607),j=a(4814),k=a(4414);const N=e=>{var t,a,n,i;let{match:l,roundId:d,editMode:o,availableTeams:c,onTeamSelect:m,onScoreUpdate:u}=e;const[x,h]=(0,r.useState)(!1),[g,v]=(0,r.useState)({score1:l.score1,score2:l.score2});(0,r.useEffect)((()=>{v({score1:l.score1,score2:l.score2})}),[l.score1,l.score2]);return(0,k.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3 mb-4 border-2 ".concat("completed"===l.status?"border-green-600":"live"===l.status?"border-yellow-600":"border-gray-600"," min-w-[250px]"),children:[(0,k.jsxs)("div",{className:"text-xs text-gray-400 mb-2 flex justify-between",children:[(0,k.jsxs)("span",{children:["Match ",l.matchNumber]}),(0,k.jsxs)("span",{className:"text-blue-400",children:["BO",l.bestOf]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-2 rounded mb-1 ".concat(l.winner===l.team1?"bg-green-900/30":"bg-gray-700"),children:[(0,k.jsx)("div",{className:"flex-grow",children:o?(0,k.jsxs)("select",{value:(null===(t=l.team1)||void 0===t?void 0:t.id)||"",onChange:e=>m(d,l.id,1,e.target.value),className:"w-full px-2 py-1 bg-gray-600 text-white rounded text-sm",children:[(0,k.jsx)("option",{value:"",children:"Select Team"}),c.map((e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id)))]}):(0,k.jsx)("span",{className:"text-sm text-white",children:(null===(a=l.team1)||void 0===a?void 0:a.name)||"TBD"})}),(0,k.jsx)("div",{className:"ml-3",children:x?(0,k.jsx)("input",{type:"number",value:g.score1,onChange:e=>v((0,s.A)((0,s.A)({},g),{},{score1:parseInt(e.target.value)||0})),className:"w-12 px-1 py-0 bg-gray-600 text-white rounded text-center",min:"0",max:l.bestOf}):(0,k.jsx)("span",{className:"text-white font-bold",children:l.score1})})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-2 rounded ".concat(l.winner===l.team2?"bg-green-900/30":"bg-gray-700"),children:[(0,k.jsx)("div",{className:"flex-grow",children:o?(0,k.jsxs)("select",{value:(null===(n=l.team2)||void 0===n?void 0:n.id)||"",onChange:e=>m(d,l.id,2,e.target.value),className:"w-full px-2 py-1 bg-gray-600 text-white rounded text-sm",children:[(0,k.jsx)("option",{value:"",children:"Select Team"}),c.map((e=>(0,k.jsx)("option",{value:e.id,children:e.name},e.id)))]}):(0,k.jsx)("span",{className:"text-sm text-white",children:(null===(i=l.team2)||void 0===i?void 0:i.name)||"TBD"})}),(0,k.jsx)("div",{className:"ml-3",children:x?(0,k.jsx)("input",{type:"number",value:g.score2,onChange:e=>v((0,s.A)((0,s.A)({},g),{},{score2:parseInt(e.target.value)||0})),className:"w-12 px-1 py-0 bg-gray-600 text-white rounded text-center",min:"0",max:l.bestOf}):(0,k.jsx)("span",{className:"text-white font-bold",children:l.score2})})]}),o&&l.team1&&l.team2&&(0,k.jsx)("div",{className:"mt-2 flex justify-center",children:x?(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:()=>{u(d,l.id,g.score1,g.score2),h(!1)},className:"px-2 py-1 bg-green-600 text-white rounded text-xs",children:"Save"}),(0,k.jsx)("button",{onClick:()=>{h(!1),v({score1:l.score1,score2:l.score2})},className:"px-2 py-1 bg-gray-600 text-white rounded text-xs",children:"Cancel"})]}):(0,k.jsx)("button",{onClick:()=>h(!0),className:"px-2 py-1 bg-blue-600 text-white rounded text-xs",children:"Update Score"})})]})},w=e=>{let{eventId:t}=e;const{api:a,isAdmin:i,isModerator:l}=(0,n.As)(),[d,c]=(0,r.useState)({name:"Marvel Rivals Championship 2025",format:"single_elimination",rounds:[],teams:[],settings:{bestOf:3,totalTeams:8,thirdPlace:!1,grandFinalReset:!1}}),[w,A]=(0,r.useState)("single_elimination"),[M,S]=(0,r.useState)(8),[_,C]=(0,r.useState)(3),[T,E]=(0,r.useState)(!1),[B,F]=(0,r.useState)([]),[R,G]=(0,r.useState)(!1),[z,O]=(0,r.useState)(!1),[L,D]=(0,r.useState)(!0),[I,P]=(0,r.useState)(!1),U=i()||l();(0,r.useEffect)((()=>{V(),t&&H()}),[t]);const V=async()=>{try{var e;G(!0);const t=await a.get("/teams"),s=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];F(s)}catch(t){console.error("Error fetching teams:",t),F([{id:1,name:"Team Secret"},{id:2,name:"FaZe Clan"},{id:3,name:"Cloud9"},{id:4,name:"NRG Esports"},{id:5,name:"100 Thieves"},{id:6,name:"Sentinels"},{id:7,name:"OpTic Gaming"},{id:8,name:"TSM"},{id:9,name:"G2 Esports"},{id:10,name:"Fnatic"},{id:11,name:"Team Liquid"},{id:12,name:"Evil Geniuses"},{id:13,name:"XSET"},{id:14,name:"Version1"},{id:15,name:"The Guard"},{id:16,name:"Ghost Gaming"}])}finally{G(!1)}},H=async()=>{try{var e,s;let u=null;try{var r,n;const e=await a.get("/events/".concat(t,"/bracket"));null!==(r=e.data)&&void 0!==r&&null!==(n=r.data)&&void 0!==n&&n.bracket&&(u=e.data.data.bracket,console.log("\u2705 Loaded bracket from /bracket endpoint"))}catch(m){console.log("\ud83d\udcdd Bracket endpoint not available, trying event endpoint")}let x=null;if(!u){var i;const e=await a.get("/events/".concat(t));x=(null===(i=e.data)||void 0===i?void 0:i.data)||e.data,x.bracket_data?(u=x.bracket_data,console.log("\u2705 Loaded bracket from event.bracket_data")):x.bracket&&(u=x.bracket,console.log("\u2705 Loaded bracket from event.bracket"))}var l,d,o;if(u&&((null===(e=u.rounds)||void 0===e?void 0:e.length)>0||(null===(s=u.matches)||void 0===s?void 0:s.length)>0))c({name:u.name||(null===(l=x)||void 0===l?void 0:l.name)||"Tournament",format:u.format||u.type||"single_elimination",rounds:u.rounds||[],teams:u.teams||[],settings:u.settings||{bestOf:3,totalTeams:8,thirdPlace:!1,grandFinalReset:!1},public:void 0===u.public||u.public}),A(u.format||u.type||"single_elimination"),C((null===(d=u.settings)||void 0===d?void 0:d.bestOf)||3),S((null===(o=u.settings)||void 0===o?void 0:o.totalTeams)||8),D(void 0===u.public||u.public),console.log("\u2705 Fully loaded existing bracket with all settings"),E(!0);else console.log("\ud83d\udcdd No existing bracket found, starting fresh")}catch(u){console.error("Error loading bracket:",u)}},W=()=>{const e=[],t=M/2,a={id:1,name:$(1,Math.log2(M)),matches:[]};for(let s=0;s<t;s++)a.matches.push({id:"R1M".concat(s+1),matchNumber:s+1,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending"});return e.push(a),{rounds:e,type:"single_elimination"}},q=()=>{const e=[],t=M/2,a={id:1,name:"Upper Bracket Round 1",bracket:"upper",matches:[]};for(let s=0;s<t;s++)a.matches.push({id:"UBR1M".concat(s+1),matchNumber:s+1,team1:null,team2:null,score1:0,score2:0,winner:null,loser:null,bestOf:_,status:"pending",bracket:"upper"});return e.push(a),{rounds:[a],upperBracket:e,lowerBracket:[],type:"double_elimination"}},Q=()=>{const e=[];let t=1;for(let a=0;a<M;a++)for(let s=a+1;s<M;s++){const a=Math.floor(t/(M/2))+1;e[a-1]||(e[a-1]={id:a,name:"Round ".concat(a),matches:[]}),e[a-1].matches.push({id:"RRM".concat(t),matchNumber:t,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending"}),t++}return{rounds:e,type:"round_robin",standings:[]}},X=()=>{const e=Math.ceil(Math.log2(M)),t=[],a={id:1,name:"Swiss Round 1",matches:[]},s=Math.floor(M/2);for(let r=0;r<s;r++)a.matches.push({id:"SR1M".concat(r+1),matchNumber:r+1,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending"});return t.push(a),{rounds:t,type:"swiss",totalSwissRounds:e}},Z=()=>{const e=Math.floor(M/4),t=[];for(let a=0;a<e;a++){const e={id:a+1,name:"Group ".concat(String.fromCharCode(65+a)),teams:[],matches:[]};[{name:"Opening Match 1",id:"G".concat(a+1,"M1")},{name:"Opening Match 2",id:"G".concat(a+1,"M2")},{name:"Winners Match",id:"G".concat(a+1,"M3")},{name:"Losers Match",id:"G".concat(a+1,"M4")},{name:"Decider Match",id:"G".concat(a+1,"M5")}].forEach((t=>{e.matches.push({id:t.id,name:t.name,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending"})})),t.push(e)}return{groups:t,rounds:[],type:"gsl"}},J=()=>{const e=Math.min(4,Math.floor(M/4)),t=[];for(let a=0;a<e;a++)t.push({id:a+1,name:"Group ".concat(String.fromCharCode(65+a)),teams:[],matches:[],standings:[]});return{groups:t,rounds:[],type:"group_stage",stage:"groups"}},K=()=>(0,s.A)((0,s.A)({},Q()),{},{type:"league",standings:[],weeks:Math.ceil(M*(M-1)/2/4)}),Y=()=>{const e=[];let t=M,a=1;for(;t>2;){const s={id:a,name:"Gauntlet Round ".concat(a),matches:[]};s.matches.push({id:"GR".concat(a,"M1"),matchNumber:1,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending",description:"Seed ".concat(t," vs Seed ").concat(t-1)}),e.push(s),t--,a++}return e.push({id:a,name:"Gauntlet Final",matches:[{id:"GR".concat(a,"M1"),matchNumber:1,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:7===_?7:5,status:"pending",description:"Top Seed vs Gauntlet Winner"}]}),{rounds:e,type:"gauntlet"}},$=(e,t)=>{const a=t-e+1;return 1===a?"Grand Final":2===a?"Semi Finals":3===a?"Quarter Finals":4===a?"Round of 16":5===a?"Round of 32":"Round ".concat(e)},ee=(e,t)=>{const a=e.rounds.find((e=>e.id===t));if(!a)return e;if(!a.matches.every((e=>"completed"===e.status)))return e;const r=t+1;if(e.rounds.find((e=>e.id===r)))return e;const n=Math.floor(a.matches.length/2);if(n<1)return e;const i=Math.log2(e.settings.totalTeams),l={id:r,name:$(r,i),matches:[]};for(let s=0;s<n;s++)l.matches.push({id:"R".concat(r,"M").concat(s+1),matchNumber:s+1,team1:null,team2:null,score1:0,score2:0,winner:null,bestOf:_,status:"pending"});const d=[...e.rounds,l];return(0,s.A)((0,s.A)({},e),{},{rounds:d})},te=(e,t,a,r)=>{const n=[...d.rounds],i=n.find((t=>t.id===e)).matches.find((e=>e.id===t)),l=B.find((e=>e.id===parseInt(r)));1===a?i.team1=l||null:i.team2=l||null,i.team1&&i.team2&&"pending"===i.status&&(i.status="live"),c((0,s.A)((0,s.A)({},d),{},{rounds:n}))},ae=(e,t,a,r)=>{const n=[...d.rounds],i=n.find((t=>t.id===e)).matches.find((e=>e.id===t));i.score1=a,i.score2=r;const l=Math.ceil(i.bestOf/2);if(a>=l){i.winner=i.team1,i.status="completed";const a=(0,s.A)((0,s.A)({},d),{},{rounds:n}),r=ee(a,e),l=se(r,e,t,i.team1);c(l)}else if(r>=l){i.winner=i.team2,i.status="completed";const a=(0,s.A)((0,s.A)({},d),{},{rounds:n}),r=ee(a,e),l=se(r,e,t,i.team2);c(l)}else i.winner=null,i.status=i.team1&&i.team2?"live":"pending",c((0,s.A)((0,s.A)({},d),{},{rounds:n}))},se=(e,t,a,r)=>{if(!r)return e;const n=e.rounds.find((e=>e.id===t+1));if(!n)return e;const i=parseInt(a.split("M")[1]),l=Math.ceil(i/2);if(n.matches.find((e=>e.matchNumber===l))){const a=e.rounds.map((e=>e.id===t+1?(0,s.A)((0,s.A)({},e),{},{matches:e.matches.map((e=>{if(e.matchNumber===l){const t=(0,s.A)({},e);return i%2===1?t.team1=r:t.team2=r,t.team1&&t.team2&&"pending"===t.status&&(t.status="live"),t}return e}))}):e));return(0,s.A)((0,s.A)({},e),{},{rounds:a})}return e};return(0,k.jsxs)("div",{className:"standalone-bracket-builder bg-gray-900 rounded-lg p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,k.jsx)(o.A,{className:"text-yellow-500"}),U?"Manual Bracket Moderator":"Live Tournament Bracket"]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[U&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("button",{onClick:()=>D(!L),className:"px-3 py-2 rounded flex items-center gap-2 ".concat(L?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-white hover:bg-gray-500"),title:L?"Bracket is PUBLIC":"Bracket is PRIVATE",children:[L?(0,k.jsx)(m,{size:18}):(0,k.jsx)(u,{size:18}),L?"Public":"Private"]}),d.rounds.length>0&&(0,k.jsx)("button",{onClick:async()=>{if(t&&0!==d.rounds.length){O(!0),P(!1);try{const e=(0,s.A)((0,s.A)({},d),{},{type:w,public:L,last_updated:(new Date).toISOString()});console.log("\ud83d\udd04 Saving bracket data:",e),console.log("\ud83d\udd04 Saving to URL:","/admin/events/".concat(t));const r=await a.put("/admin/events/".concat(t),{bracket_data:e});console.log("\u2705 Save response:",r.data),r.data.success&&(P(!0),setTimeout((()=>P(!1)),3e3),console.log("\u2705 Bracket saved successfully to database"))}catch(i){var e,r,n;console.error("\u274c Error saving bracket:",i),console.error("\u274c Error response:",null===(e=i.response)||void 0===e?void 0:e.data),alert("Failed to save bracket: "+((null===(r=i.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||i.message))}finally{O(!1)}}else alert("Please create a bracket first")},disabled:z,className:"px-4 py-2 rounded flex items-center gap-2 ".concat(I?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"," ").concat(z?"opacity-50 cursor-not-allowed":""),children:z?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(x.A,{size:18,className:"animate-spin"}),"Saving..."]}):I?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(h,{size:18}),"Saved!"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(g.A,{size:18}),"Save to Database"]})}),(0,k.jsxs)("button",{onClick:()=>E(!T),className:"px-4 py-2 rounded flex items-center gap-2 ".concat(T?"bg-green-600 text-white":"bg-gray-600 text-white"),children:[T?(0,k.jsx)(v,{size:18}):(0,k.jsx)(p,{size:18}),T?"View Mode":"Edit Mode"]})]}),!U&&(0,k.jsxs)("div",{className:"px-4 py-2 bg-blue-600 text-white rounded flex items-center gap-2",children:[(0,k.jsx)(b.A,{size:18}),"Live View"]})]})]}),U&&T&&0===d.rounds.length&&(0,k.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(y.A,{size:20}),"Bracket Configuration"]}),(0,k.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Format"}),(0,k.jsx)("select",{value:w,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 bg-gray-700 text-white rounded",children:Object.entries({single_elimination:{name:"Single Elimination",description:"Standard knockout bracket - Teams are eliminated after one loss"},double_elimination:{name:"Double Elimination",description:"Upper and lower bracket - Teams get a second chance after first loss"},round_robin:{name:"Round Robin",description:"Everyone plays everyone - All teams play each other once"},swiss:{name:"Swiss System",description:"Paired by record - Teams with similar records face each other"},gsl:{name:"GSL Groups",description:"4-team double elim groups - Two advance from each group"},group_stage:{name:"Group Stage + Playoffs",description:"Groups phase followed by elimination playoffs"},league:{name:"League Format",description:"Season-long round robin with standings"},gauntlet:{name:"Gauntlet",description:"Lower seeds must win multiple matches to reach finals"}}).map((e=>{let[t,a]=e;return(0,k.jsx)("option",{value:t,children:a.name},t)}))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Number of Teams"}),(0,k.jsx)("select",{value:M,onChange:e=>S(parseInt(e.target.value)),className:"w-full px-3 py-2 bg-gray-700 text-white rounded",children:[2,4,6,8,12,16,20,24,32,48,64,128,256].map((e=>(0,k.jsxs)("option",{value:e,children:[e," teams"]},e)))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Match Format"}),(0,k.jsx)("select",{value:_,onChange:e=>C(parseInt(e.target.value)),className:"w-full px-3 py-2 bg-gray-700 text-white rounded",children:Object.entries({bo1:{name:"Best of 1",value:1,description:"Single game"},bo3:{name:"Best of 3",value:3,description:"First to 2 wins"},bo5:{name:"Best of 5",value:5,description:"First to 3 wins"},bo7:{name:"Best of 7",value:7,description:"First to 4 wins (Grand Finals)"},ft3:{name:"First to 3",value:3,description:"First to win 3 maps"},ft4:{name:"First to 4",value:4,description:"First to win 4 maps (Finals)"}}).map((e=>{let[t,a]=e;return(0,k.jsx)("option",{value:a.value,title:a.description,children:a.name},t)}))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"\xa0"}),(0,k.jsxs)("button",{onClick:()=>{let e=null;switch(w){case"single_elimination":default:e=W();break;case"double_elimination":e=q();break;case"round_robin":e=Q();break;case"swiss":e=X();break;case"gsl":e=Z();break;case"group_stage":e=J();break;case"league":e=K();break;case"gauntlet":e=Y()}c((0,s.A)((0,s.A)((0,s.A)({},d),{},{format:w},e),{},{settings:(0,s.A)((0,s.A)({},d.settings),{},{bestOf:_,totalTeams:M})}))},className:"w-full px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center justify-center gap-2",children:[(0,k.jsx)(f.A,{size:18}),"Create Bracket"]})]})]})]}),(0,k.jsx)("div",{className:"bracket-container overflow-x-auto",children:d.rounds.length>0?(0,k.jsx)("div",{className:"flex gap-8 min-w-max p-4",children:d.rounds.map(((e,t)=>(0,k.jsxs)("div",{className:"round-column",children:[(0,k.jsx)("h3",{className:"text-center text-white font-semibold mb-4",children:e.name}),(0,k.jsx)("div",{className:"space-y-".concat(Math.min(8,Math.pow(2,t+1))),children:e.matches.map((t=>(0,k.jsx)(N,{match:t,roundId:e.id,editMode:T&&U,availableTeams:B,onTeamSelect:te,onScoreUpdate:ae},t.id)))})]},e.id)))}):(0,k.jsxs)("div",{className:"text-center py-12",children:[(0,k.jsx)("p",{className:"text-gray-400 text-lg mb-4",children:U?"No bracket created yet":"No bracket available"}),U&&!T&&(0,k.jsx)("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Enter Edit Mode to Create Bracket"})]})}),d.rounds.length>0&&(0,k.jsxs)("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Legend"}),(0,k.jsxs)("div",{className:"flex gap-6 text-xs text-gray-400",children:[(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-gray-700 rounded"}),"Pending"]}),(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-yellow-600 rounded"}),"Live"]}),(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-green-600 rounded"}),"Completed"]})]}),U&&T&&(0,k.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,k.jsxs)("button",{onClick:()=>{c((0,s.A)((0,s.A)({},d),{},{rounds:[]}))},className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 flex items-center gap-1",children:[(0,k.jsx)(j.A,{size:14}),"Clear Bracket"]})})]})]})};const A=function(e){var t,a,s,o,c,m,u,x,h,g,v;let{params:p,navigateTo:b}=e;const[y,f]=(0,r.useState)(null),[j,N]=(0,r.useState)([]),[A,M]=(0,r.useState)([]),[S,_]=(0,r.useState)(null),[C,T]=(0,r.useState)("overview"),[E,B]=(0,r.useState)(!0),[F,R]=(0,r.useState)(!1),[G,z]=(0,r.useState)([]),[O,L]=(0,r.useState)(""),[D,I]=(0,r.useState)(!1),[P,U]=(0,r.useState)(null),{api:V,isAdmin:H,isModerator:W}=(0,n.As)(),q=null===p||void 0===p?void 0:p.id;console.log("\ud83d\udd0d EventDetailPage - Received event ID:",q),(0,r.useEffect)((()=>{q&&(Q(),X())}),[q]);const Q=async()=>{try{var e;B(!0),console.log("\ud83d\udd04 EventDetailPage: Fetching event data for ID:",q);const o=await V.get("/events/".concat(q)),c=(null===(e=o.data)||void 0===e?void 0:e.data)||o.data||o;console.log("\u2705 Real event data received:",c),f(c);let m=[];c.teams&&Array.isArray(c.teams)?m=c.teams:c.participating_teams&&Array.isArray(c.participating_teams)?m=c.participating_teams:c.event_teams&&Array.isArray(c.event_teams)&&(m=c.event_teams),console.log("\u2705 Teams data found:",m.length,"teams"),M(m);let u=[];if(c.matches&&Array.isArray(c.matches)?u=c.matches:c.event_matches&&Array.isArray(c.event_matches)&&(u=c.event_matches),console.log("\u2705 Matches data found:",u.length,"matches"),N(u),c.bracket?_(c.bracket):c.bracket_data&&_(c.bracket_data),"ongoing"===c.status||"completed"===c.status)try{var t,a,s,r,n,i,l;const e=await V.get("/events/".concat(q,"/bracket"));console.log("\ud83d\udcca Bracket response structure:",e.data),null!==(t=e.data)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.bracket?(_(e.data.data.bracket),console.log("\u2705 Bracket data loaded from public endpoint (data.bracket)")):null!==(s=e.data)&&void 0!==s&&null!==(r=s.data)&&void 0!==r&&r.bracket_data?(_(e.data.data.bracket_data),console.log("\u2705 Bracket data loaded from public endpoint (data.bracket_data)")):null!==(n=e.data)&&void 0!==n&&n.bracket_data?(_(e.data.bracket_data),console.log("\u2705 Bracket data loaded from public endpoint (bracket_data)")):null!==(i=e.data)&&void 0!==i&&i.bracket?(_(e.data.bracket),console.log("\u2705 Bracket data loaded from public endpoint (bracket)")):null!==(l=e.data)&&void 0!==l&&l.matches&&(_(e.data),console.log("\u2705 Bracket data loaded in simple format"))}catch(d){console.log("\ud83d\udcdd No bracket data available yet")}console.log("\u2705 Event data loaded with embedded teams and matches")}catch(d){console.error("\u274c Error fetching event data:",d),f(null),N([]),M([])}finally{B(!1)}},X=async()=>{try{var e;const t=await V.get("/teams"),a=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];z(a)}catch(t){console.error("\u274c Error fetching teams:",t)}},Z=e=>{if(!e)return"TBD";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},J=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return e&&0!==e?new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e):"TBD"},K=[{id:"overview",name:"Overview"},{id:"teams",name:"Teams (".concat(A.length,")")},{id:"matches",name:"Matches (".concat(j.length,")")},{id:"bracket",name:"Bracket"}];return E?(0,k.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,k.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading event details..."})]})}):y?(0,k.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-500",children:[(0,k.jsx)("button",{onClick:()=>b&&b("home"),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Home"}),(0,k.jsx)("span",{children:"\u203a"}),(0,k.jsx)("button",{onClick:()=>b&&b("events"),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Events"}),(0,k.jsx)("span",{children:"\u203a"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:y.name})]}),(0,k.jsxs)("div",{className:"card p-6",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsx)("div",{className:"w-16 h-16 rounded-lg bg-gray-200 dark:bg-gray-700 overflow-hidden flex-shrink-0",children:(0,k.jsx)("img",{src:(0,i.NR)(y),alt:y.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.parentNode.innerHTML='<div class="w-full h-full flex items-center justify-center text-xl font-bold text-gray-500 dark:text-gray-400">?</div>'}})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,k.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:y.name}),D&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"Live Updates"})]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(e=>{const t={upcoming:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200",ongoing:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200",completed:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200"};return(0,k.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(t[e]||t.upcoming),children:e.charAt(0).toUpperCase()+e.slice(1)})})(y.status),(0,k.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[(null===(t=y.details)||void 0===t?void 0:t.region)||y.region," \u2022 ",(null===(a=y.details)||void 0===a?void 0:a.type)||y.type]})]})]})]}),(H()||W())&&(0,k.jsx)("button",{onClick:()=>b&&b("admin-event-edit",{id:y.id}),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Edit Event"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mt-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500 text-sm",children:"Prize Pool"}),(0,k.jsx)("div",{className:"font-bold text-xl text-green-600 dark:text-green-400",children:J((null===(s=y.details)||void 0===s?void 0:s.prize_pool)||y.prize_pool,null===(o=y.details)||void 0===o?void 0:o.currency)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500 text-sm",children:"Start Date"}),(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:Z((null===(c=y.schedule)||void 0===c?void 0:c.start_date)||y.start_date)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500 text-sm",children:"End Date"}),(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:Z((null===(m=y.schedule)||void 0===m?void 0:m.end_date)||y.end_date)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500 text-sm",children:"Format"}),(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:(null===(u=y.details)||void 0===u?void 0:u.format)||y.format})]})]})]}),(0,k.jsxs)("div",{className:"card",children:[(0,k.jsx)("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:K.map((e=>(0,k.jsx)("button",{onClick:()=>T(e.id),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors ".concat(C===e.id?"text-red-600 dark:text-red-400 border-b-2 border-red-600 dark:border-red-400 bg-red-50 dark:bg-red-900/10":"text-gray-700 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400 hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:e.name},e.id)))}),(0,k.jsxs)("div",{className:"p-6",children:["overview"===C&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"About"}),(0,k.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:y.description})]}),y.rules&&(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"Rules"}),(0,k.jsx)("div",{className:"prose dark:prose-invert max-w-none",children:y.rules})]}),(null===(x=y.details)||void 0===x?void 0:x.prize_distribution)&&(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"Prize Distribution"}),(0,k.jsx)("div",{className:"space-y-2",children:Object.entries(y.details.prize_distribution).map((e=>{var t;let[a,s]=e;return(0,k.jsxs)("div",{className:"flex justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,k.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:a}),(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:J(s,null===(t=y.details)||void 0===t?void 0:t.currency)})]},a)}))})]})]}),"teams"===C&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:["Participating Teams (",A.length,"/",(null===(h=y.participation)||void 0===h?void 0:h.max_teams)||y.max_teams,")"]}),(H()||W())&&(0,k.jsx)("button",{onClick:()=>R(!0),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Add Team"})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map((e=>(0,k.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer",onClick:()=>b&&b("team-detail",{id:e.id}),children:[(0,k.jsx)(i.LE,{team:e,size:"w-12 h-12"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),(0,k.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-500",children:[(0,k.jsx)("span",{children:(0,i.xg)(e.country||e.region)}),(0,k.jsx)("span",{children:(0,i.qQ)(e.country||e.region)})]})]})]}),(H()||W())&&(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this team from the event?"))try{await V.delete("/admin/events/".concat(q,"/teams/").concat(e)),console.log("\u2705 Team removed successfully"),await Q()}catch(s){var t,a;console.error("\u274c Error removing team:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||s.message||"Failed to remove team";alert(e)}})(e.id),className:"text-red-600 hover:text-red-700 transition-colors",title:"Remove team",children:(0,k.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},e.id)))}),0===A.length&&(0,k.jsx)("div",{className:"text-center py-8",children:(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500",children:"No teams registered yet"})})]}),"matches"===C&&(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-4",children:"Event Matches"}),j.length>0?(0,k.jsx)("div",{className:"space-y-4",children:j.map((e=>(0,k.jsx)(l.A,{match:e,navigateTo:b},e.id)))}):(0,k.jsx)("div",{className:"text-center py-8",children:(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-500",children:"No matches scheduled yet"})})]}),"bracket"===C&&(0,k.jsxs)("div",{children:[console.log("\ud83d\udd0d Bracket tab - Current bracket data:",S),H()||W()?(0,k.jsx)("div",{children:(0,k.jsx)(w,{eventId:q})}):S&&!1!==S.public&&((null===(g=S.matches)||void 0===g?void 0:g.length)>0||S.upper_bracket||S.main_stage||(null===(v=S.rounds)||void 0===v?void 0:v.length)>0||Array.isArray(S.rounds)&&S.rounds.some((e=>{var t;return(null===(t=e.matches)||void 0===t?void 0:t.length)>0})))?(0,k.jsx)(d.A,{bracket:S,event:y,eventId:q,navigateTo:b,isAdmin:!1,onMatchUpdate:async(e,t)=>{try{console.log("\ud83d\udd04 Refreshing bracket data after score update..."),await Q(),console.log("\u2705 Event and bracket data refreshed")}catch(a){console.error("\u274c Error refreshing bracket:",a)}}},"bracket-".concat(q,"-").concat(Date.now())):(0,k.jsxs)("div",{className:"text-center py-12",children:[(0,k.jsx)("div",{className:"text-4xl mb-4",children:"\ud83c\udfc6"}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:S&&!1===S.public?"Bracket is Private":"Bracket not available yet"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:S&&!1===S.public?"The tournament organizers have not made the bracket public yet.":"The tournament bracket will be displayed here once the tournament starts."})]})]})]})]}),F&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add Team to Event"}),(0,k.jsxs)("select",{value:O,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-4",children:[(0,k.jsx)("option",{value:"",children:"Select a team"}),G.filter((e=>!A.some((t=>t.id===e.id)))).map((e=>(0,k.jsxs)("option",{value:e.id,children:[e.name," (",e.region,")"]},e.id)))]}),(0,k.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,k.jsx)("button",{onClick:()=>{R(!1),L("")},className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:"Cancel"}),(0,k.jsx)("button",{onClick:async()=>{if(O)try{await V.post("/admin/events/".concat(q,"/teams"),{team_id:O}),console.log("\u2705 Team added successfully"),await Q(),R(!1),L("")}catch(a){var e,t;console.error("\u274c Error adding team:",a);const s=(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||"Failed to add team";alert(s)}},disabled:!O,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Team"})]})]})})]}):(0,k.jsxs)("div",{className:"card p-12 text-center",children:[(0,k.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Event Not Found"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The event you're looking for doesn't exist or may have been removed."}),(0,k.jsx)("button",{onClick:()=>b&&b("events"),className:"px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"\u2190 Back to Events"})]})}}}]);