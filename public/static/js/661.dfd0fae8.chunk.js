"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[661],{52:(e,t,a)=>{a.d(t,{yW:()=>s});a(9950);var r=a(1368),n=a(4414);const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||0===t.length)return e;const s={};t.forEach((e=>{const t=e.mention_text,a=e.name,r=e.display_name;t&&(s[t]=e),"team"===e.type?(s["@team:".concat(a)]=e,s["@team:".concat(e.id)]=e,r&&(s["@team:".concat(r)]=e)):"player"===e.type&&(s["@player:".concat(a)]=e,s["@player:".concat(e.id)]=e,r&&(s["@player:".concat(r)]=e)),s["@".concat(a)]=e,r&&r!==a&&(s["@".concat(r)]=e)}));let l=[{type:"text",content:e}];return[/@team:([a-zA-Z0-9_\-\s]+)/g,/@player:([a-zA-Z0-9_\-\s]+)/g,/@([a-zA-Z0-9_]+)/g].forEach((e=>{const t=[];l.forEach((a=>{if("text"!==a.type)return void t.push(a);const r=a.content;let n,l=0;for(e.lastIndex=0;null!==(n=e.exec(r));){const e=n[0],a=n.index,o=a+e.length;a>l&&t.push({type:"text",content:r.slice(l,a)});let c=s[e];if(!c){const e=n[1];Object.keys(s).forEach((t=>{const a=s[t];!a||a.name!==e&&a.display_name!==e&&a.id!==e&&a.id!==parseInt(e)||(c=a)}))}c&&"user"!==c.type?t.push({type:"mention",content:e,mention:c,key:"mention-".concat(a,"-").concat(o)}):t.push({type:"text",content:e}),l=o}l<r.length&&t.push({type:"text",content:r.slice(l)})})),l=t})),l.map(((e,t)=>"mention"===e.type?(0,n.jsx)(r.A,{mention:e.mention,navigateTo:a},e.key||"mention-".concat(t)):e.content))}},1368:(e,t,a)=>{a.d(t,{A:()=>n});a(9950);var r=a(4414);const n=e=>{let{mention:t,className:a="",onClick:n,showIcon:s=!0,navigateTo:l}=e;const o=e=>"string"===typeof e?e:"object"===typeof e&&null!==e?e.name&&"string"===typeof e.name?e.name:e.display_name&&"string"===typeof e.display_name?e.display_name:"":e?String(e):"",c=(null===t||void 0===t?void 0:t.type)||"",i=(null===t||void 0===t?void 0:t.id)||"",d=o(null===t||void 0===t?void 0:t.name),m=o(null===t||void 0===t?void 0:t.display_name),g=()=>{switch(c){case"player":return{page:"player-detail",params:{id:i}};case"team":return{page:"team-detail",params:{id:i}};default:return null}},x=()=>{switch(c){case"player":return"bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50 border border-blue-200 dark:border-blue-800";case"team":return"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50 border border-red-200 dark:border-red-800";case"user":return"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:hover:bg-green-900/50 border border-green-200 dark:border-green-800";default:return"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800/30 dark:text-gray-400 dark:hover:bg-gray-800/50 border border-gray-200 dark:border-gray-700"}},u=e=>{e.preventDefault(),e.stopPropagation();const a=g(),r=e.currentTarget;if(r.classList.add("transform","scale-95"),setTimeout((()=>{r.classList.remove("transform","scale-95")}),150),a&&l)l(a.page,a.params);else if(a){const e=h(a);e&&"undefined"!==typeof window&&(window.location.hash=e)}n&&n(t,e)},h=e=>{switch(e.page){case"player-detail":return"player-detail/".concat(e.params.id);case"team-detail":return"team-detail/".concat(e.params.id);case"user-profile":return"user-profile/".concat(e.params.id);default:return""}},p=g(),y=m||d||"Unknown ".concat(c||"mention");return p?(0,r.jsx)("button",{onClick:u,className:"inline-flex items-center font-medium px-2 py-0.5 rounded transition-all duration-200 cursor-pointer transform hover:scale-105 active:scale-95 ".concat(x()," ").concat(a),title:"View ".concat(c,": ").concat(y),children:y}):(0,r.jsx)("span",{className:"inline-flex items-center font-medium px-2 py-0.5 rounded transition-all duration-200 ".concat(x()," ").concat(a),onClick:u,children:y})}},1453:(e,t,a)=>{a.d(t,{A:()=>o,G:()=>l});a(9950);var r=a(9190),n=a(6225),s=a(4414);const l=function(e,t){if(!e)return null;const a={};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((e=>{const t=e.mention_text||"@".concat(e.name);a[t]=e}));const r=[];if([{regex:/@player:([a-zA-Z0-9_]+)/g,type:"player",prefix:"@player:"},{regex:/@team:([a-zA-Z0-9_]+)/g,type:"team",prefix:"@team:"},{regex:/@([a-zA-Z0-9_]+)(?!:)/g,type:"user",prefix:"@"}].forEach((t=>{let n,{regex:s,type:l,prefix:o}=t;for(;null!==(n=s.exec(e));){const e=n[0],t=n[1],s=n.index,o=n.index+e.length,c=a[e];r.push({start:s,end:o,original:e,type:l,identifier:t,data:c})}})),r.sort(((e,t)=>t.start-e.start)),0===r.length)return e;const n=[];let l=e.length;return r.forEach((a=>{l>a.end&&n.unshift(e.slice(a.end,l)),a.data?n.unshift((0,s.jsx)("span",{className:"mention-link font-medium px-1 rounded cursor-pointer transition-colors ".concat("player"===a.type?"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20":"team"===a.type?"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20":"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20"),onClick:e=>{if(e.stopPropagation(),t&&a.data)switch(a.type){case"player":t("player-detail",{id:a.data.id});break;case"team":t("team-detail",{id:a.data.id});break;case"user":t("user-profile",{id:a.data.id});break;default:console.warn("Unknown mention type:",a.type)}},title:"View ".concat(a.type,": ").concat(a.data.display_name||a.data.name),children:a.original},"mention-".concat(a.start))):n.unshift(a.original),a.start>0&&n.unshift(e.slice(0,a.start)),l=a.start})),n.length>0?n:e},o=function(e){let{user:t,showAvatar:a=!0,showTeamFlair:l=!0,showHeroFlair:o=!0,size:c="sm",className:i="",clickable:d=!1,navigateTo:m=null}=e;if(!t)return(0,s.jsx)("span",{className:"text-gray-500",children:"Unknown User"});const g={xs:"w-4 h-4 text-xs",sm:"w-6 h-6 text-sm",md:"w-8 h-8 text-base",lg:"w-10 h-10 text-lg"};return(0,s.jsxs)("div",{className:"flex items-center space-x-2 ".concat(i),children:[a&&(0,s.jsx)(r.A,{user:t,size:c,showFlairs:!1,showName:!1}),(0,s.jsx)("span",{className:"font-medium ".concat(d?"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 cursor-pointer":"text-gray-900 dark:text-white"),onClick:()=>{d&&m&&t.id&&m("user-profile",{id:t.id})},children:t.name||t.username}),l&&t.team_flair&&t.show_team_flair&&(0,s.jsx)("div",{className:"".concat(g[c]," flex-shrink-0"),children:t.team_flair.logo?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:(0,n.VG)(t.team_flair.logo,"team-logo"),alt:t.team_flair.short_name||t.team_flair.name,className:"".concat(g[c]," object-contain rounded"),title:t.team_flair.name,onError:e=>{e.target.src=(0,n.VG)(null,"team-logo")}}),(0,s.jsx)("div",{className:"".concat(g[c]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs hidden"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})]}):(0,s.jsx)("div",{className:"".concat(g[c]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})}),t.roles&&t.roles.length>0&&(0,s.jsx)("div",{className:"flex space-x-1",children:t.roles.map((e=>(0,s.jsx)("span",{className:"px-1.5 py-0.5 text-xs font-bold rounded ".concat("admin"===e?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"moderator"===e?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"),children:e.toUpperCase()},e)))})]})}},8009:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(9950),n=a(5150);const s=new class{constructor(){this.pollingIntervals=new Map}subscribe(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e4;const n="".concat(e,"-").concat(t);this.pollingIntervals.has(n)&&clearInterval(this.pollingIntervals.get(n));const s=setInterval((()=>{a({type:"refresh"})}),r);return this.pollingIntervals.set(n,s),()=>this.unsubscribe(e,t)}unsubscribe(e,t){const a="".concat(e,"-").concat(t);this.pollingIntervals.has(a)&&(clearInterval(this.pollingIntervals.get(a)),this.pollingIntervals.delete(a))}disconnect(){this.pollingIntervals.forEach((e=>clearInterval(e))),this.pollingIntervals.clear()}},l=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[l,o]=(0,r.useState)(0),[c,i]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),{api:g}=(0,n.As)(),{maxRecentMentions:x=10,pollingInterval:u=3e4}=a,h=(0,r.useCallback)((async()=>{if(e&&t&&g)try{let r;switch(e){case"player":r="/players/".concat(t,"/mentions");break;case"team":r="/teams/".concat(t,"/mentions");break;case"user":r="/users/".concat(t,"/mentions");break;default:r="/".concat(e,"s/").concat(t,"/mentions")}const n=await g.get(r,{params:{limit:x}});if(n.data){var a;const e=n.data.data||n.data||[];i(e),null!==(a=n.data.meta)&&void 0!==a&&a.total?o(n.data.meta.total):n.data.total?o(n.data.total):o(e.length)}}catch(r){console.error("Error fetching mention data:",r)}finally{m(!1)}}),[e,t,g,x]);return(0,r.useEffect)((()=>{h()}),[h]),(0,r.useEffect)((()=>{if(!e||!t)return;return s.subscribe(e,t,(e=>{"refresh"===e.type&&h()}),u)}),[e,t,h,u]),{mentionCount:l,recentMentions:c,isLoading:d,refreshData:h}};a(52);var o=a(6225),c=a(4414);const i=e=>{let{entityType:t,entityId:a,title:s,className:i=""}=e;const[d,m]=(0,r.useState)([]),[g,x]=(0,r.useState)(!0),[u,h]=(0,r.useState)(1),[p,y]=(0,r.useState)(1),[b,f]=(0,r.useState)("all"),[k,v]=(0,r.useState)(null),{api:j}=(0,n.As)(),{mentionCount:w,refreshData:N}=l(t,a,{maxRecentMentions:10});(0,r.useEffect)((()=>{_()}),[t,a,u,b]),(0,r.useEffect)((()=>{if(!t||!a)return;const e=setInterval((()=>{1===u&&(_(),N())}),3e4);return()=>{clearInterval(e)}}),[t,a,u,N]);const _=async()=>{try{x(!0),v(null);const e=new URLSearchParams({page:u,limit:10});let r;switch("all"!==b&&e.append("content_type",b),t){case"player":r="/players/".concat(a,"/mentions?").concat(e.toString());break;case"team":r="/teams/".concat(a,"/mentions?").concat(e.toString());break;case"user":r="/users/".concat(a,"/mentions?").concat(e.toString());break;default:r="/".concat(t,"s/").concat(a,"/mentions?").concat(e.toString())}const n=await j.get(r);if(!1!==n.data.success){const e=n.data.data||n.data||[];if(m(e),n.data.meta){const e=Math.ceil(n.data.meta.total/(n.data.meta.limit||10));y(e)}else n.data.pagination?y(n.data.pagination.last_page||1):y(1)}else n.status>=400?v(n.data.message||"Failed to load mentions"):m([])}catch(k){var e,r;console.error("Error fetching mentions:",k),(null===(e=k.response)||void 0===e?void 0:e.status)>=500||!k.response?v("Unable to load mentions at this time"):404===(null===(r=k.response)||void 0===r?void 0:r.status)?(m([]),y(1)):v("Failed to load mentions")}finally{x(!1)}},C=e=>{h(e)},I=e=>{switch(e){case"news":return"News";case"news_comment":return"News Comments";case"forum_thread":return"Forum Threads";case"forum_post":return"Forum Posts";case"match":return"Matches";case"match_comment":return"Match Comments";default:return e}},A=e=>{switch(e){case"news":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"news_comment":return"bg-blue-50 text-blue-700 dark:bg-blue-900/10 dark:text-blue-400";case"forum_thread":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";case"forum_post":return"bg-purple-50 text-purple-700 dark:bg-purple-900/10 dark:text-purple-400";case"match":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"match_comment":return"bg-green-50 text-green-700 dark:bg-green-900/10 dark:text-green-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}};return g&&0===d.length?(0,c.jsxs)("div",{className:"space-y-4 ".concat(i),children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s||"Mentions"}),(0,c.jsx)("div",{className:"animate-pulse space-y-3",children:[1,2,3].map((e=>(0,c.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-lg p-4",children:[(0,c.jsx)("div",{className:"h-4 bg-gray-300 dark:bg-gray-600 rounded w-3/4 mb-2"}),(0,c.jsx)("div",{className:"h-3 bg-gray-300 dark:bg-gray-600 rounded w-1/2"})]},e)))})]}):k?(0,c.jsxs)("div",{className:"space-y-4 ".concat(i),children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s||"Mentions"}),(0,c.jsx)("div",{className:"text-center py-8",children:(0,c.jsxs)("div",{className:"flex flex-col items-center",children:[(0,c.jsx)("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-3",children:(0,c.jsx)("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,c.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm text-center",children:k}),(0,c.jsx)("button",{onClick:()=>_(),className:"mt-3 px-3 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Try again"})]})})]}):(0,c.jsxs)("div",{className:"space-y-4 ".concat(i),children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[s||"Mentions",w>0&&(0,c.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300 rounded-full",children:w})]}),(0,c.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:d.length>0&&"".concat(d.length," mention").concat(1!==d.length?"s":"")})]}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:["all","news","news_comment","forum_thread","forum_post","match","match_comment"].map((e=>(0,c.jsx)("button",{onClick:()=>(e=>{f(e),h(1)})(e),className:"px-3 py-1 text-xs rounded-full transition-colors ".concat(b===e?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"all"===e?"All":I(e)},e)))}),0===d.length?(0,c.jsx)("div",{className:"text-center py-12",children:(0,c.jsxs)("div",{className:"flex flex-col items-center",children:[(0,c.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:(0,c.jsx)("svg",{className:"w-8 h-8 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,c.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No mentions yet"}),(0,c.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm text-center max-w-sm leading-relaxed",children:"player"===t?"Be the first to mention this player in news, forums, or match discussions!":"Be the first to mention this team in news, forums, or match discussions!"}),(0,c.jsx)("div",{className:"mt-4 px-4 py-2 bg-gray-50 dark:bg-gray-800 rounded-lg",children:(0,c.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Mentions appear when ","player"===t?"this player":"this team"," is discussed in the community"]})})]})}):(0,c.jsx)("div",{className:"space-y-3",children:d.map((e=>(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-gray-300 dark:hover:border-gray-600 transition-colors",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[e.mentioned_by&&(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[e.mentioned_by.avatar?(0,c.jsx)("img",{src:e.mentioned_by.avatar,alt:e.mentioned_by.name,className:"w-6 h-6 rounded-full",onError:e=>{e.target.src=(0,o.VG)(null,"player-avatar")}}):(0,c.jsx)("div",{className:"w-6 h-6 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:(0,c.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:e.mentioned_by.name.charAt(0).toUpperCase()})}),(0,c.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.mentioned_by.name})]}),e.content&&(0,c.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(A(e.content.type)),children:I(e.content.type)})]}),(0,c.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.mentioned_at).toLocaleDateString()})]}),e.context&&(0,c.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:[(0,c.jsx)("span",{className:"font-medium text-red-600 dark:text-red-400",children:e.mention_text}),(0,c.jsx)("span",{className:"ml-1",children:e.context.replace(e.mention_text,"")})]}),e.content&&e.content.url&&(0,c.jsx)("div",{className:"text-sm",children:(0,c.jsx)("a",{href:e.content.url,className:"text-blue-600 dark:text-blue-400 hover:underline",onClick:t=>{t.preventDefault(),e.content.url.startsWith("/")?window.location.hash=e.content.url.substring(1):window.open(e.content.url,"_blank","noopener,noreferrer")},children:e.content.title})})]},e.id)))}),p>1&&(0,c.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,c.jsx)("button",{onClick:()=>C(u-1),disabled:1===u,className:"px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,c.jsxs)("span",{className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-400",children:["Page ",u," of ",p]}),(0,c.jsx)("button",{onClick:()=>C(u+1),disabled:u===p,className:"px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}}}]);