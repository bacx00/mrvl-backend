"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[443],{2443:(e,a,t)=>{t.r(a),t.d(a,{default:()=>n});var r=t(2555),s=t(9950),d=t(5150),l=t(1842),o=t(4414);const n=function(){const{api:e}=(0,d.As)(),[a,t]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[c,x]=(0,s.useState)(!0),[u,g]=(0,s.useState)(null),[m,h]=(0,s.useState)("threads"),[b,v]=(0,s.useState)([]),[y,p]=(0,s.useState)({search:"",status:"all",sortBy:"date"}),[k,j]=(0,s.useState)({page:1,limit:20,total:0,totalPages:0}),[f,w]=(0,s.useState)("cards"),[N,C]=(0,s.useState)(new Set),[A,_]=(0,s.useState)(!1),[S,E]=(0,s.useState)(!1),[D,P]=(0,s.useState)(null),[U,F]=(0,s.useState)({title:"",content:"",category_id:"",is_pinned:!1,is_locked:!1,status:"active"}),[L,T]=(0,s.useState)(!1),[B,z]=(0,s.useState)(null),[M,I]=(0,s.useState)(""),[G,O]=(0,s.useState)({reason:"",duration:"24",permanent:!1,ban_type:"suspend"}),[R,q]=(0,s.useState)(!1),[H,V]=(0,s.useState)(null),[Y,$]=(0,s.useState)({name:"",description:"",slug:"",color:"#3b82f6",icon:"\ud83d\udcac",sort_order:0,is_active:!0}),[J,K]=(0,s.useState)({}),[Q,W]=(0,s.useState)([]);(0,s.useEffect)((()=>{"threads"===m?X():"posts"===m?Z():"categories"===m&&ee()}),[m]);const X=async()=>{try{var a;x(!0);const r=await e.get("/api/admin/forums-moderation/threads"),s=(null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.data)||(null===r||void 0===r?void 0:r.data)||r||[];t(Array.isArray(s)?s:[]),g(null)}catch(d){var r,s;console.error("Error fetching threads:",d);const e=(null===(r=d.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||d.message||"Failed to load threads";g(e),t([])}finally{x(!1)}},Z=async()=>{try{var a;x(!0);const t=await e.get("/api/admin/forums-moderation/posts"),r=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.data)||(null===t||void 0===t?void 0:t.data)||t||[];i(Array.isArray(r)?r:[]),g(null)}catch(s){var t,r;console.error("Error fetching posts:",s);const e=(null===(t=s.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||s.message||"Failed to load posts";g(e),i([])}finally{x(!1)}},ee=async()=>{try{var a;x(!0);const t=await e.get("/forums/categories"),r=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.data)||(null===t||void 0===t?void 0:t.data)||t||[];v(Array.isArray(r)?r:[]),g(null)}catch(s){var t,r;console.error("Error fetching categories:",s);const e=(null===(t=s.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||s.message||"Failed to load categories";g(e),v([])}finally{x(!1)}},ae=async function(a,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var d,l;let i;switch(t){case"ban":case"suspend":case"timeout":i=await e.post("/api/admin/users/".concat(a,"/moderation"),(0,r.A)({action:t},s));break;case"unban":i=await e.delete("/api/admin/users/".concat(a,"/moderation"));break;case"warn":i=await e.post("/api/admin/users/".concat(a,"/warn"),{reason:(null===s||void 0===s?void 0:s.reason)||"General warning"});break;default:throw new Error("Unknown action")}var o,n;if(!1===(null===(d=i)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.success))throw new Error((null===(o=i)||void 0===o||null===(n=o.data)||void 0===n?void 0:n.message)||"".concat(t," failed"));alert("User ".concat(t," action completed successfully!")),T(!1),z(null),await X()}catch(u){var i,c;console.error("Error performing ".concat(t,":"),u);const a=(null===(i=u.response)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.message)||u.message||"Failed to ".concat(t," user");alert(a)}},te=()=>{V(null),$({name:"",description:"",slug:"",color:"#3b82f6",icon:"\ud83d\udcac",sort_order:b.length,is_active:!0}),q(!0)},re=e=>{const a=new Set(N);a.has(e)?a.delete(e):a.add(e),C(a),_(a.size>0)},se=()=>{let e=[..."threads"===m?a:"posts"===m?n:b];if(y.search.trim()){const a=y.search.toLowerCase();e="categories"===m?e.filter((e=>{var t,r,s;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===(s=e.slug)||void 0===s?void 0:s.toLowerCase().includes(a))})):e.filter((e=>{var t,r,s,d;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.content)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===(s=e.user)||void 0===s||null===(d=s.name)||void 0===d?void 0:d.toLowerCase().includes(a))}))}return"all"!==y.status&&(e="categories"===m?e.filter((e=>"active"===y.status?e.is_active:!e.is_active)):e.filter((e=>e.status===y.status))),"date"===y.sortBy?e.sort(((e,a)=>new Date(a.created_at||0)-new Date(e.created_at||0))):"replies"===y.sortBy&&"threads"===m?e.sort(((e,a)=>(a.posts_count||0)-(e.posts_count||0))):"order"===y.sortBy&&"categories"===m&&e.sort(((e,a)=>(e.sort_order||0)-(a.sort_order||0))),e};return c?(0,o.jsx)("div",{className:"p-6",children:(0,o.jsx)("div",{className:"animate-pulse space-y-4",children:[...Array(5)].map(((e,a)=>(0,o.jsx)("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded"},a)))})}):u?(0,o.jsx)("div",{className:"p-6",children:(0,o.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-200 mb-2",children:"Error Loading Data"}),(0,o.jsx)("p",{className:"text-red-700 dark:text-red-300 mb-4",children:u}),(0,o.jsx)("button",{onClick:()=>"threads"===m?X():Z(),className:"btn btn-outline-primary",children:"Try Again"})]})}):(0,o.jsxs)("div",{className:"p-6 space-y-6",children:[(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Forum Moderation"}),(0,o.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Moderate forum threads and posts"})]})}),(0,o.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,o.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,o.jsxs)("button",{onClick:()=>h("threads"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("threads"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:["Threads (",a.length,")"]}),(0,o.jsxs)("button",{onClick:()=>h("posts"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("posts"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:["Posts (",n.length,")"]}),(0,o.jsxs)("button",{onClick:()=>h("categories"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("categories"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:["Categories (",b.length,")"]})]})}),(0,o.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:["Search ",m]}),(0,o.jsx)("input",{type:"text",placeholder:"Search ".concat(m,"..."),value:y.search,onChange:e=>p((0,r.A)((0,r.A)({},y),{},{search:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Status"}),(0,o.jsxs)("select",{value:y.status,onChange:e=>p((0,r.A)((0,r.A)({},y),{},{status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,o.jsx)("option",{value:"all",children:"All Status"}),(0,o.jsx)("option",{value:"active",children:"Active"}),"categories"!==m&&(0,o.jsx)("option",{value:"locked",children:"Locked"}),"categories"!==m&&(0,o.jsx)("option",{value:"hidden",children:"Hidden"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Sort By"}),(0,o.jsxs)("select",{value:y.sortBy,onChange:e=>p((0,r.A)((0,r.A)({},y),{},{sortBy:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[(0,o.jsx)("option",{value:"date",children:"Date"}),"threads"===m&&(0,o.jsx)("option",{value:"replies",children:"Replies"}),"categories"===m&&(0,o.jsx)("option",{value:"order",children:"Sort Order"})]})]}),(0,o.jsxs)("div",{className:"flex items-end gap-2",children:["threads"===m&&(0,o.jsx)("button",{onClick:()=>{P(null),F({title:"",content:"",category_id:"",is_pinned:!1,is_locked:!1,status:"active"}),E(!0)},className:"btn btn-primary flex-1",children:"Create Thread"}),"categories"===m&&(0,o.jsx)("button",{onClick:te,className:"btn btn-primary flex-1",children:"Create Category"}),(0,o.jsx)("button",{onClick:()=>p({search:"",status:"all",sortBy:"categories"===m?"order":"date"}),className:"btn btn-secondary ".concat("categories"===m?"flex-1":"w-full"),children:"Clear Filters"})]})]})}),A&&(0,o.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsxs)("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-200",children:[N.size," ",m," selected"]}),(0,o.jsx)("div",{className:"flex space-x-2",children:(0,o.jsx)("button",{onClick:async()=>{if(0===N.size)return;const a="threads"===m?"threads":"posts",t="Are you sure you want to delete ".concat(N.size," ").concat(a,"? This action cannot be undone.");if(window.confirm(t))try{var r;const t="threads"===m?"/api/admin/forums-moderation/threads/bulk-delete":"/api/admin/forums-moderation/posts/bulk-delete",d=await e.post(t,{ids:Array.from(N)});var s;if(!1===(null===(r=d.data)||void 0===r?void 0:r.success))throw new Error((null===(s=d.data)||void 0===s?void 0:s.message)||"Bulk delete failed");"threads"===m?await X():await Z(),C(new Set),_(!1),alert("".concat(N.size," ").concat(a," deleted successfully!"))}catch(u){var d,l;console.error("Error in bulk delete:",u);const a=(null===(d=u.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||u.message||"Bulk delete failed";alert(a)}},className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm",children:"Delete Selected"})})]}),(0,o.jsx)("button",{onClick:()=>{C(new Set),_(!1)},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"Clear Selection"})]})}),(0,o.jsxs)("div",{className:"space-y-4",children:[se().length>0&&(0,o.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3",children:(0,o.jsxs)("label",{className:"flex items-center space-x-2 text-sm",children:[(0,o.jsx)("input",{type:"checkbox",checked:N.size===se().length&&se().length>0,onChange:()=>{const e="threads"===m?a:n;N.size===e.length?(C(new Set),_(!1)):(C(new Set(e.map((e=>e.id)))),_(!0))},className:"rounded border-gray-300 dark:border-gray-600"}),(0,o.jsxs)("span",{className:"text-gray-700 dark:text-gray-300",children:["Select all ",se().length," ",m]})]})}),"categories"===m?se().map((a=>(0,o.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,o.jsx)("input",{type:"checkbox",checked:N.has(a.id),onChange:()=>re(a.id),className:"mt-1 rounded border-gray-300 dark:border-gray-600"}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,o.jsx)("span",{className:"text-2xl",children:a.icon}),(0,o.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:a.color}}),(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.name}),(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(a.is_active?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:a.is_active?"Active":"Inactive"})]}),(0,o.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:a.description||"No description provided"}),(0,o.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,o.jsxs)("span",{children:["Slug: /",a.slug]}),(0,o.jsxs)("span",{children:["Order: ",a.sort_order]}),(0,o.jsxs)("span",{children:["Threads: ",a.threads_count||0]}),(0,o.jsx)("span",{children:a.created_at?new Date(a.created_at).toLocaleDateString():"Unknown date"})]})]})]}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsx)("button",{onClick:()=>(e=>{V(e),$({name:e.name||"",description:e.description||"",slug:e.slug||"",color:e.color||"#3b82f6",icon:e.icon||"\ud83d\udcac",sort_order:e.sort_order||0,is_active:!1!==e.is_active}),q(!0)})(a),className:"btn btn-outline-primary text-sm",children:"Edit"}),(0,o.jsx)("button",{onClick:()=>(async(a,t)=>{const r=!t;try{var s;const t=await e.put("/forums/categories/".concat(a),{is_active:r});var d;if(!1===(null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.success))throw new Error((null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.message)||"Status update failed");await ee(),alert("Category ".concat(r?"activated":"deactivated"," successfully!"))}catch(u){var l,o;console.error("Error updating category status:",u);const a=(null===(l=u.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||u.message||"Failed to update category status";alert(a)}})(a.id,a.is_active),className:"btn btn-outline-secondary text-sm",children:a.is_active?"Deactivate":"Activate"}),(0,o.jsx)("button",{onClick:()=>(async(a,t)=>{if(window.confirm('Delete category "'.concat(t,'"? This will move all threads in this category to "General".')))try{var r;const t=await e.delete("/forums/categories/".concat(a));var s;if(!1===(null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.success))throw new Error((null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Delete failed");await ee(),alert("Category deleted successfully!")}catch(u){var d,l;console.error("Error deleting category:",u);const a=(null===(d=u.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||u.message||"Failed to delete category";alert(a)}})(a.id,a.name),className:"btn btn-outline-danger text-sm",children:"Delete"})]})]})},a.id))):"threads"===m?se().map((a=>{var t,r,s,d;return(0,o.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,o.jsx)("input",{type:"checkbox",checked:N.has(a.id),onChange:()=>re(a.id),className:"mt-1 rounded border-gray-300 dark:border-gray-600"}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[a.is_pinned&&(0,o.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400 text-xs rounded-full font-medium",children:"\ud83d\udccc Pinned"}),(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.title})]}),a.content&&(0,o.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:[a.content.substring(0,150),"..."]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("img",{src:(null===(t=a.user)||void 0===t?void 0:t.hero_image)||(null===(r=a.user)||void 0===r?void 0:r.avatar)||"?",alt:(null===(s=a.user)||void 0===s?void 0:s.name)||a.author,className:"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-700 object-cover",onError:e=>{e.target.onerror=null,e.target.src="?"}}),(0,o.jsxs)("span",{children:["By ",(null===(d=a.user)||void 0===d?void 0:d.name)||a.author||"Unknown"]})]}),(0,o.jsxs)("span",{children:["\ud83d\udcac ",a.posts_count||0," posts"]}),(0,o.jsxs)("span",{children:["\ud83d\udc41\ufe0f ",a.views_count||0," views"]}),(0,o.jsxs)("span",{children:["\ud83d\udcc5 ",a.created_at?new Date(a.created_at).toLocaleDateString():"Unknown date"]}),a.category&&(0,o.jsx)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded",children:a.category.name||a.category})]}),(0,o.jsx)("div",{className:"flex items-center space-x-2",children:(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===a.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:a.status||"active"})})]})]})]}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsx)("button",{onClick:()=>(e=>{P(e),F({title:e.title||"",content:e.content||"",category_id:e.category_id||"",is_pinned:e.is_pinned||!1,is_locked:"locked"===e.status,status:e.status||"active"}),E(!0)})(a),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Edit thread",children:"Edit"}),(0,o.jsx)("button",{onClick:()=>(async(a,t)=>{if(window.confirm('Delete thread "'.concat(t,'"?')))try{var r;const t=await e.delete("/api/admin/forums-moderation/threads/".concat(a));var s;if(!1===(null===(r=t.data)||void 0===r?void 0:r.success))throw new Error((null===(s=t.data)||void 0===s?void 0:s.message)||"Delete failed");await X(),alert("Thread deleted successfully!")}catch(u){var d,l;console.error("Error deleting thread:",u);const a=(null===(d=u.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||u.message||"Error deleting thread";alert(a)}})(a.id,a.title),className:"px-3 py-1 text-sm border border-red-300 dark:border-red-600 text-red-600 dark:text-red-400 rounded hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete thread",children:"Delete"}),(0,o.jsx)("button",{onClick:()=>(async(a,t)=>{const r="active"===t?"locked":"active";try{var s;const t=await e.put("/api/admin/forums-moderation/threads/".concat(a),{status:r});var d;if(!1===(null===(s=t.data)||void 0===s?void 0:s.success))throw new Error((null===(d=t.data)||void 0===d?void 0:d.message)||"Status update failed");await X(),alert("Thread ".concat("active"===r?"unlocked":"locked"," successfully!"))}catch(u){var l,o;console.error("Error updating thread status:",u);const a=(null===(l=u.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||u.message||"Error updating thread status";alert(a)}})(a.id,a.status||"active"),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"active"===a.status?"Lock thread":"Unlock thread",children:"active"===a.status?"Lock":"Unlock"}),(0,o.jsx)("button",{onClick:()=>(async(a,t)=>{try{var r;const d=await e.put("/api/admin/forums-moderation/threads/".concat(a),{is_pinned:!t});var s;if(!1===(null===(r=d.data)||void 0===r?void 0:r.success))throw new Error((null===(s=d.data)||void 0===s?void 0:s.message)||"Pin status update failed");await X(),alert("Thread ".concat(t?"unpinned":"pinned"," successfully!"))}catch(u){var d,l;console.error("Error updating thread pin status:",u);const a=(null===(d=u.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||u.message||"Error updating thread pin status";alert(a)}})(a.id,a.is_pinned),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:a.is_pinned?"Unpin thread":"Pin thread",children:a.is_pinned?"Unpin":"Pin"})]})]})},a.id)})):se().map((a=>{var t,r,s;return(0,o.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,o.jsx)("input",{type:"checkbox",checked:N.has(a.id),onChange:()=>re(a.id),className:"mt-1 rounded border-gray-300 dark:border-gray-600"}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"text-gray-600 dark:text-gray-400 mb-2 line-clamp-3",children:[(null===(t=a.content)||void 0===t?void 0:t.substring(0,200))||"No content","..."]}),(0,o.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,o.jsxs)("span",{children:["By ",(null===(r=a.user)||void 0===r?void 0:r.name)||a.author||"Unknown"]}),(0,o.jsx)("span",{children:a.created_at?new Date(a.created_at).toLocaleDateString():"Unknown date"}),(0,o.jsxs)("span",{children:["Thread: ",(null===(s=a.thread)||void 0===s?void 0:s.title)||"Unknown"]})]})]})]}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsx)("button",{className:"btn btn-outline-primary text-sm",children:"View"}),(0,o.jsx)("button",{onClick:()=>{var t;return(async(a,t)=>{if(window.confirm('Delete post "'.concat(t,'"?')))try{var r;const t=await e.delete("/api/admin/forums-moderation/posts/".concat(a));var s;if(!1===(null===(r=t.data)||void 0===r?void 0:r.success))throw new Error((null===(s=t.data)||void 0===s?void 0:s.message)||"Delete failed");await Z(),alert("Post deleted successfully!")}catch(u){var d,l;console.error("Error deleting post:",u);const a=(null===(d=u.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||u.message||"Error deleting post";alert(a)}})(a.id,(null===(t=a.content)||void 0===t?void 0:t.substring(0,50))||"Post")},className:"btn btn-outline-danger text-sm",children:"Delete"})]})]})},a.id)}))]}),0===se().length&&(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"categories"===m?"\ud83d\udcc1":"\ud83d\udcac"}),(0,o.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:["No ","threads"===m?"Forum Threads":"posts"===m?"Forum Posts":"Forum Categories"]}),(0,o.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:y.search||"all"!==y.status?"No ".concat(m," match your current filters."):"No ".concat(m," to moderate at this time.")}),"categories"===m&&!y.search&&(0,o.jsx)("button",{onClick:te,className:"btn btn-primary mt-4",children:"Create First Category"})]}),("threads"===m||"posts"===m)&&k.totalPages>1&&(0,o.jsxs)("div",{className:"flex items-center justify-between py-6",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Show"}),(0,o.jsxs)("select",{value:k.limit,onChange:e=>{const a=parseInt(e.target.value);j((e=>(0,r.A)((0,r.A)({},e),{},{limit:a,page:1}))),"threads"===m?X(1):Z(1)},className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-white text-sm",children:[(0,o.jsx)("option",{value:"10",children:"10"}),(0,o.jsx)("option",{value:"20",children:"20"}),(0,o.jsx)("option",{value:"50",children:"50"}),(0,o.jsx)("option",{value:"100",children:"100"})]}),(0,o.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"per page"})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{onClick:()=>{const e=Math.max(1,k.page-1);j((a=>(0,r.A)((0,r.A)({},a),{},{page:e}))),"threads"===m?X(e):Z(e)},disabled:k.page<=1,className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-white text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,o.jsx)("div",{className:"flex items-center space-x-1",children:[...Array(Math.min(5,k.totalPages))].map(((e,a)=>{const t=Math.max(1,Math.min(k.totalPages-4,Math.max(1,k.page-2)))+a;return t>k.totalPages?null:(0,o.jsx)("button",{onClick:()=>{j((e=>(0,r.A)((0,r.A)({},e),{},{page:t}))),"threads"===m?X(t):Z(t)},className:"px-3 py-1 border rounded text-sm ".concat(t===k.page?"bg-blue-600 text-white border-blue-600":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 text-gray-900 dark:text-white"),children:t},t)}))}),(0,o.jsx)("button",{onClick:()=>{const e=Math.min(k.totalPages,k.page+1);j((a=>(0,r.A)((0,r.A)({},a),{},{page:e}))),"threads"===m?X(e):Z(e)},disabled:k.page>=k.totalPages,className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-900 dark:text-white text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),R&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,o.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:H?"Edit Category":"Create New Category"})}),(0,o.jsxs)("div",{className:"p-6 space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Category Name *"}),(0,o.jsx)("input",{type:"text",value:Y.name,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{name:e.target.value})),placeholder:"e.g., General Discussion",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Description"}),(0,o.jsx)("textarea",{value:Y.description,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{description:e.target.value})),placeholder:"Brief description of what this category is for...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Slug (URL)"}),(0,o.jsx)("input",{type:"text",value:Y.slug,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{slug:e.target.value})),placeholder:"auto-generated",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Sort Order"}),(0,o.jsx)("input",{type:"number",min:"0",value:Y.sort_order,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{sort_order:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Icon"}),(0,o.jsx)("input",{type:"text",value:Y.icon,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{icon:e.target.value})),placeholder:"\ud83d\udcac",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Color"}),(0,o.jsx)("input",{type:"color",value:Y.color,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{color:e.target.value})),className:"w-full h-10 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900"})]})]}),(0,o.jsx)("div",{children:(0,o.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,o.jsx)("input",{type:"checkbox",checked:Y.is_active,onChange:e=>$((0,r.A)((0,r.A)({},Y),{},{is_active:e.target.checked})),className:"rounded border-gray-300 dark:border-gray-600"}),(0,o.jsx)("span",{className:"text-sm text-gray-900 dark:text-gray-100",children:"Active (users can create threads in this category)"})]})})]}),(0,o.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[(0,o.jsx)("button",{onClick:()=>{q(!1),V(null)},className:"btn btn-secondary flex-1",children:"Cancel"}),(0,o.jsx)("button",{onClick:async()=>{try{var a,t;if(!Y.name.trim())return void alert("Category name is required");const l=Y.slug.trim()||Y.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),o=(0,r.A)((0,r.A)({},Y),{},{slug:l,name:Y.name.trim(),description:Y.description.trim()});let n;var s,d;if(n=H?await e.put("/forums/categories/".concat(H.id),o):await e.post("/forums/categories",o),!1===(null===(a=n)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.success))throw new Error((null===(s=n)||void 0===s||null===(d=s.data)||void 0===d?void 0:d.message)||"Save failed");await ee(),q(!1),V(null),alert("Category ".concat(H?"updated":"created"," successfully!"))}catch(u){var l,o;console.error("Error saving category:",u);const a=(null===(l=u.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||u.message||"Failed to save category";alert(a)}},className:"btn btn-primary flex-1",children:H?"Update Category":"Create Category"})]})]})}),S&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,o.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:D?"Edit Thread":"Create New Thread"}),(0,o.jsx)("button",{onClick:()=>{E(!1),P(null)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"\u2715"})]}),(0,o.jsx)("div",{className:"p-6",children:(0,o.jsx)(l.default,{navigateTo:e=>{E(!1),P(null),X()}})})]})}),L&&B&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full",children:[(0,o.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,o.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[M.charAt(0).toUpperCase()+M.slice(1)," User: ",B.name||B.username]})}),(0,o.jsxs)("div",{className:"p-6 space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[(0,o.jsx)("div",{className:"text-yellow-600 dark:text-yellow-400 text-lg",children:"\u26a0\ufe0f"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Moderation Action"}),(0,o.jsxs)("div",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:["You are about to ",M," this user. This action will be logged."]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:["Reason for ",M," *"]}),(0,o.jsx)("textarea",{value:G.reason,onChange:e=>O((0,r.A)((0,r.A)({},G),{},{reason:e.target.value})),placeholder:"Explain why you are ".concat(M,"ing this user..."),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white"})]}),("ban"===M||"suspend"===M||"timeout"===M)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:(0,o.jsxs)("label",{className:"flex items-center space-x-2 mb-3",children:[(0,o.jsx)("input",{type:"checkbox",checked:G.permanent,onChange:e=>O((0,r.A)((0,r.A)({},G),{},{permanent:e.target.checked})),className:"rounded border-gray-300 dark:border-gray-600"}),(0,o.jsxs)("span",{className:"text-sm text-gray-900 dark:text-gray-100",children:["Permanent ",M]})]})}),!G.permanent&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:["Duration (","timeout"===M?"minutes":"hours",")"]}),(0,o.jsx)("select",{value:G.duration,onChange:e=>O((0,r.A)((0,r.A)({},G),{},{duration:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:"timeout"===M?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("option",{value:"5",children:"5 minutes"}),(0,o.jsx)("option",{value:"10",children:"10 minutes"}),(0,o.jsx)("option",{value:"30",children:"30 minutes"}),(0,o.jsx)("option",{value:"60",children:"1 hour"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("option",{value:"1",children:"1 hour"}),(0,o.jsx)("option",{value:"6",children:"6 hours"}),(0,o.jsx)("option",{value:"24",children:"24 hours"}),(0,o.jsx)("option",{value:"72",children:"3 days"}),(0,o.jsx)("option",{value:"168",children:"1 week"}),(0,o.jsx)("option",{value:"720",children:"30 days"})]})})]})]})]}),(0,o.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[(0,o.jsx)("button",{onClick:()=>{T(!1),z(null),I("")},className:"btn btn-secondary flex-1",children:"Cancel"}),(0,o.jsxs)("button",{onClick:async()=>{if(!G.reason.trim())return void alert("Please provide a reason for this action");const e={reason:G.reason,duration_hours:G.permanent?null:parseInt(G.duration),permanent:G.permanent};await ae(B.id,M,e)},className:"btn flex-1 ".concat("ban"===M||"suspend"===M?"btn-danger":"timeout"===M?"btn-warning":"btn-primary"),children:["Confirm ",M.charAt(0).toUpperCase()+M.slice(1)]})]})]})})]})}}}]);