"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[405],{1405:(e,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(2555),r=s(9950),l=s(5150),n=(s(6225),s(4414));const d=function(e){let{navigateTo:a,userId:s=null}=e;const[d,i]=(0,r.useState)({name:"",email:"",password:"",roles:["user"],avatar:null,status:"active"}),[c,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),{api:u}=(0,l.As)(),h=!!s;(0,r.useEffect)((()=>{h&&p()}),[s]);const p=async()=>{try{o(!0);const e=await u.get("/admin/users/".concat(s)),a=e.data||e;i((0,t.A)((0,t.A)({},a),{},{password:"",roles:a.roles||["user"]}))}catch(e){console.error("Error fetching user:",e),alert("Error loading user data. Please try again."),a("admin-dashboard")}finally{o(!1)}},g=(e,a)=>{i((s=>(0,t.A)((0,t.A)({},s),{},{[e]:a})))};return c?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,n.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading user data..."})]})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:h?"Edit User":"Create New User"}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:h?"Update user information and permissions":"Add a new user to the platform"})]}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),x(!0);try{if(0===d.roles.length)return void alert("Please select at least one role");const e=(0,t.A)({},d);let r;h&&!e.password&&delete e.password,e.roles&&e.roles.length>0&&(e.role=e.roles[0],delete e.roles),h?(e._method="PUT",r=await u.post("/admin/users/".concat(s),e)):r=await u.post("/admin/users",e),alert("User ".concat(h?"updated":"created"," successfully!")),a("admin-dashboard")}catch(r){console.error("Error saving user:",r),alert("Error ".concat(h?"updating":"creating"," user: ").concat(r.message))}finally{x(!1)}},className:"space-y-6",children:[(0,n.jsx)("div",{className:"card p-6",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Basic Information"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Name *"}),(0,n.jsx)("input",{type:"text",name:"name",value:d.name,onChange:e=>g("name",e.target.value),className:"form-input",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Email *"}),(0,n.jsx)("input",{type:"email",name:"email",value:d.email,onChange:e=>g("email",e.target.value),className:"form-input",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:["Password ",h&&"(leave blank to keep current)"]}),(0,n.jsx)("input",{type:"password",name:"password",value:d.password,onChange:e=>g("password",e.target.value),className:"form-input",required:!h})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Status"}),(0,n.jsx)("select",{name:"status",value:d.status,onChange:e=>g("status",e.target.value),className:"form-input",children:["active","inactive","banned"].map((e=>(0,n.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Roles & Appearance"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"User Roles *"}),(0,n.jsx)("div",{className:"space-y-3",children:[{id:"admin",label:"Administrator",description:"Full access to all features"},{id:"moderator",label:"Moderator",description:"Can moderate content and users"},{id:"user",label:"Regular User",description:"Standard user account"}].map((e=>(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("input",{type:"checkbox",id:"role-".concat(e.id),checked:d.roles.includes(e.id),onChange:()=>(e=>{i((a=>{const s=[...a.roles];return s.includes(e)?(0,t.A)((0,t.A)({},a),{},{roles:s.filter((a=>a!==e))}):(0,t.A)((0,t.A)({},a),{},{roles:[...s,e]})}))})(e.id),className:"mt-1 mr-3"}),(0,n.jsxs)("label",{htmlFor:"role-".concat(e.id),className:"cursor-pointer",children:[(0,n.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,n.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},e.id)))}),0===d.roles.length&&(0,n.jsx)("p",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:"Please select at least one role"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-900 dark:text-gray-100",children:"Avatar"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Users select their hero avatar from their profile settings page. Admin cannot set user avatars."})]})]})]})}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("button",{type:"button",onClick:()=>a("admin-dashboard"),className:"btn btn-secondary",disabled:m,children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m||0===d.roles.length,children:m?"Saving...":h?"Update User":"Create User"})]})]})]})}}}]);