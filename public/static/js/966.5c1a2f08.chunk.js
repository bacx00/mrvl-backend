"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[966],{5966:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var r=a(9950),s=a(5150),n=a(6225);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enableWebSocket:a=!0,enablePolling:n=!0,pollingInterval:d=3e4,reconnectAttempts:l=5,reconnectDelay:c=3e3,onMatchUpdate:i=null,onBracketUpdate:o=null,onTournamentUpdate:m=null,onError:x=null}=t,{api:g}=(0,s.As)(),[h,u]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null),[y,v]=(0,r.useState)([]),[k,j]=(0,r.useState)("disconnected"),f=(0,r.useRef)(null),N=(0,r.useRef)(null),w=(0,r.useRef)(0),_=(0,r.useRef)(null),T=(0,r.useRef)(!0);(0,r.useEffect)((()=>()=>{T.current=!1,C()}),[]),(0,r.useEffect)((()=>{if(e)return console.log("\ud83d\udd0c TournamentUpdates: Initializing for tournament",e),M(),()=>{C()}}),[e]);const C=()=>{console.log("\ud83e\uddf9 TournamentUpdates: Cleaning up connections"),f.current&&(f.current.close(),f.current=null),N.current&&(clearInterval(N.current),N.current=null),_.current&&(clearTimeout(_.current),_.current=null),u(!1),j("disconnected")},M=async()=>{try{a&&await S(),n&&A()}catch(e){console.error("\u274c TournamentUpdates: Failed to initialize connections:",e),R(e)}},S=async()=>{try{console.log("\ud83d\udd0c TournamentUpdates: Attempting WebSocket connection");"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUSHER_KEY:"your_pusher_key_here",REACT_APP_PUSHER_CLUSTER:"us2",REACT_APP_BACKEND_URL:"https://staging.mrvl.net",REACT_APP_ENVIRONMENT:"production"}.REACT_APP_WS_URL||"ws://localhost:8080","/tournaments/").concat(e);console.log("\u26a0\ufe0f TournamentUpdates: WebSocket not implemented, using polling"),j("polling-only")}catch(t){console.error("\u274c TournamentUpdates: WebSocket connection failed:",t),j("polling-fallback")}},A=()=>{console.log("\ud83d\udce1 TournamentUpdates: Starting polling with interval",d),N.current&&clearInterval(N.current),E(),N.current=setInterval((()=>{T.current&&E()}),d),u(!0),j("polling")},E=async()=>{try{var t;console.log("\ud83d\udd04 TournamentUpdates: Fetching latest data");const a=await g.get("/events/".concat(e,"?include=teams,matches,bracket&timestamp=").concat(Date.now())),r=(null===(t=a.data)||void 0===t?void 0:t.data)||a.data;if(!T.current)return;const s=(new Date).toISOString();if(!p||r.updated_at&&new Date(r.updated_at)>new Date(p)){console.log("\u2728 TournamentUpdates: New updates detected"),b(s);const e={type:"tournament-sync",timestamp:s,tournament:r,matches:r.matches||[],bracket:r.bracket,teams:r.teams||[]};if(v((t=>[...t.slice(-9),e])),m&&m(e),r.matches){const e=r.matches.filter((e=>"live"===e.status)),t=r.matches.filter((e=>"completed"===e.status&&e.updated_at&&new Date(e.updated_at)>new Date(Date.now()-3e5)));[...e,...t].forEach((e=>{i&&i({type:"match-update",match:e,timestamp:s})}))}r.bracket&&o&&o({type:"bracket-update",bracket:r.bracket,timestamp:s})}}catch(a){console.error("\u274c TournamentUpdates: Error fetching updates:",a),R(a)}},R=e=>{console.error("\u274c TournamentUpdates: Error occurred:",e),x&&x(e),w.current<l?(w.current++,console.log("\ud83d\udd04 TournamentUpdates: Attempting reconnection ".concat(w.current,"/").concat(l)),_.current=setTimeout((()=>{T.current&&M()}),c),j("reconnecting")):(console.error("\u274c TournamentUpdates: Max reconnection attempts reached"),j("failed"),u(!1))};return{isConnected:h,connectionStatus:k,lastUpdateTime:p,updates:y,refresh:()=>{console.log("\ud83d\udd04 TournamentUpdates: Manual refresh triggered"),E()},reconnect:()=>{console.log("\ud83d\udd04 TournamentUpdates: Manual reconnection triggered"),w.current=0,C(),M()}}}var l=a(9549),c=a(575),i=a(2555),o=a(4414);function m(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=new Date(e),r=new Date,s=r-a,n=Math.floor(s/6e4),d=Math.floor(s/36e5),l=Math.floor(s/864e5);if(t&&s<0){const e=Math.abs(n);return e<60?"in ".concat(e,"m"):e<1440?"in ".concat(Math.floor(e/60),"h"):a.toLocaleDateString()}return n<1?"Just now":n<60?"".concat(n,"m ago"):d<24?"".concat(d,"h ago"):l<7?"".concat(l,"d ago"):a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:a.getFullYear()!==r.getFullYear()?"numeric":void 0})}const x=function(e){let{match:t,onClick:a,onTeamClick:r,isHovered:s=!1,isSelected:d=!1,showConnector:l=!1,compact:c=!1}=e;if(!t)return null;const i="completed"===t.status,x="live"===t.status,g=i&&t.team1_score>t.team2_score,h=i&&t.team2_score>t.team1_score,u=(e,t)=>{t.stopPropagation(),r&&e&&r(e)};return(0,o.jsxs)("div",{className:"\n        bracket-match relative bg-white dark:bg-gray-900 border rounded-md overflow-hidden \n        transition-all duration-150 cursor-pointer select-none\n        ".concat(x?"border-red-400 ring-2 ring-red-200 dark:ring-red-800":"border-gray-300 dark:border-gray-600","\n        ").concat(s?"border-blue-400 shadow-md transform scale-[1.02]":"","\n        ").concat(d?"ring-2 ring-blue-400 dark:ring-blue-500":"","\n        ").concat(c?"min-w-[220px]":"min-w-[280px]","\n        hover:shadow-sm hover:border-gray-400 dark:hover:border-gray-500\n      "),onClick:e=>{e.preventDefault(),a&&a(t)},children:[(x||t.match_number||t.bo)&&(0,o.jsxs)("div",{className:"flex items-center justify-between px-3 py-1.5 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[t.match_number&&(0,o.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:["Match ",t.match_number]}),t.bo&&(0,o.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["BO",t.bo]})]}),x&&(0,o.jsxs)("div",{className:"match-live-indicator",children:[(0,o.jsxs)("div",{className:"match-live-dot",children:[(0,o.jsx)("span",{className:"match-live-dot-ping"}),(0,o.jsx)("span",{className:"match-live-dot-core"})]}),(0,o.jsx)("span",{className:"text-xs font-bold text-red-600 dark:text-red-400",children:"LIVE"})]})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsxs)("div",{className:"\n            flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700 \n            transition-colors duration-150\n            ".concat(g?"team-row-winner":h?"team-row-loser":"","\n            hover:bg-gray-50 dark:hover:bg-gray-800/50\n          "),onClick:e=>u(t.team1,e),children:[(0,o.jsx)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:t.team1?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.LE,{team:t.team1,size:c?"w-6 h-6":"w-8 h-8",className:"flex-shrink-0"}),(0,o.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,o.jsx)("span",{className:"\n                    font-medium truncate block leading-tight\n                    ".concat(g?"text-gray-900 dark:text-white font-semibold":h?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white","\n                  "),children:t.team1.name}),t.team1.region&&!c&&(0,o.jsx)("span",{className:"text-xs text-gray-400 dark:text-gray-500 block",children:t.team1.region})]}),t.team1.seed&&(0,o.jsxs)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 px-1.5 py-0.5 rounded flex-shrink-0",children:["#",t.team1.seed]})]}):(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)("div",{className:"".concat(c?"w-6 h-6":"w-8 h-8"," bg-gray-200 dark:bg-gray-700 rounded flex-shrink-0")}),(0,o.jsx)("span",{className:"text-gray-400 dark:text-gray-600 italic font-medium",children:"TBD"})]})}),(0,o.jsx)("div",{className:"ml-3 flex-shrink-0",children:(0,o.jsx)("span",{className:"\n              team-score text-lg font-bold min-w-[28px]\n              ".concat(g?"team-score-winner text-green-600 dark:text-green-400":"team-score-default","\n            "),children:void 0!==t.team1_score?t.team1_score:"\u2014"})})]}),(0,o.jsxs)("div",{className:"\n            flex items-center justify-between p-3 transition-colors duration-150\n            ".concat(h?"team-row-winner":g?"team-row-loser":"","\n            hover:bg-gray-50 dark:hover:bg-gray-800/50\n          "),onClick:e=>u(t.team2,e),children:[(0,o.jsx)("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:t.team2?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.LE,{team:t.team2,size:c?"w-6 h-6":"w-8 h-8",className:"flex-shrink-0"}),(0,o.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,o.jsx)("span",{className:"\n                    font-medium truncate block leading-tight\n                    ".concat(h?"text-gray-900 dark:text-white font-semibold":g?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white","\n                  "),children:t.team2.name}),t.team2.region&&!c&&(0,o.jsx)("span",{className:"text-xs text-gray-400 dark:text-gray-500 block",children:t.team2.region})]}),t.team2.seed&&(0,o.jsxs)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 px-1.5 py-0.5 rounded flex-shrink-0",children:["#",t.team2.seed]})]}):(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)("div",{className:"".concat(c?"w-6 h-6":"w-8 h-8"," bg-gray-200 dark:bg-gray-700 rounded flex-shrink-0")}),(0,o.jsx)("span",{className:"text-gray-400 dark:text-gray-600 italic font-medium",children:"TBD"})]})}),(0,o.jsx)("div",{className:"ml-3 flex-shrink-0",children:(0,o.jsx)("span",{className:"\n              team-score text-lg font-bold min-w-[28px]\n              ".concat(h?"team-score-winner text-green-600 dark:text-green-400":"team-score-default","\n            "),children:void 0!==t.team2_score?t.team2_score:"\u2014"})})]})]}),(t.scheduled_at||t.completed_at||t.stream_url)&&(0,o.jsx)("div",{className:"px-3 py-1.5 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i&&t.completed_at?m(t.completed_at):t.scheduled_at?m(t.scheduled_at,!0):""}),t.stream_url&&(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),(0,o.jsx)("span",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:"Stream"})]})]})}),l&&(0,o.jsx)("div",{className:"absolute -right-8 top-1/2 transform -translate-y-1/2 w-8 h-0.5 bg-gray-300 dark:bg-gray-600"})]})};function g(e){let{title:t,color:a,isExpanded:r,onToggle:s,collapsible:n,children:d}=e;return(0,o.jsxs)("div",{className:"bracket-section",children:[(0,o.jsx)("div",{className:"flex items-center justify-center mb-8",children:(0,o.jsxs)("div",{className:"flex items-center space-x-3 ".concat(n?"cursor-pointer":""),onClick:n?s:void 0,children:[(0,o.jsx)("h3",{className:"text-lg font-bold tracking-wider uppercase border-b-2 pb-2 ".concat({blue:"border-blue-500 text-blue-700 dark:text-blue-300",red:"border-red-500 text-red-700 dark:text-red-300",yellow:"border-yellow-500 text-yellow-700 dark:text-yellow-300"}[a]),children:t}),n&&(0,o.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,o.jsx)("svg",{className:"w-5 h-5 transform transition-transform ".concat(r?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),r&&(0,o.jsx)("div",{className:"transition-all duration-300",children:d})]})}function h(e){var t;let{round:a,roundIndex:r,totalRounds:s,roundName:n,onMatchClick:d,onTeamClick:l,hoveredMatch:c,selectedMatch:i,compact:m,isLastRound:g}=e;return(0,o.jsxs)("div",{className:"relative flex-shrink-0",style:{minWidth:m?"240px":"300px"},children:[(0,o.jsxs)("div",{className:"text-center mb-8 sticky top-0 z-10 bg-white dark:bg-gray-900 py-2",children:[(0,o.jsx)("h4",{className:"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider border-b-2 border-gray-300 dark:border-gray-600 pb-2 inline-block",children:n}),a.start_date&&(0,o.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(a.start_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,o.jsx)("div",{className:"space-y-8",children:(null===(t=a.matches)||void 0===t?void 0:t.map(((e,t)=>(0,o.jsx)("div",{className:"transition-all duration-300",children:(0,o.jsx)(x,{match:e,onClick:d,onTeamClick:l,isHovered:(null===c||void 0===c?void 0:c.id)===e.id,isSelected:(null===i||void 0===i?void 0:i.id)===e.id,compact:m,showConnector:!g})},e.id||t))))||[]})]})}function u(e){let{rounds:t}=e;return!t||t.length<2?null:(0,o.jsx)("svg",{className:"absolute inset-0 pointer-events-none",style:{zIndex:1},preserveAspectRatio:"none",children:t.map(((e,a)=>{var r;if(a>=t.length-1)return null;const s=t[a+1];return(null===(r=e.matches)||void 0===r?void 0:r.map(((t,r)=>{var n;const d=Math.floor(r/2);if(!(null===(n=s.matches)||void 0===n?void 0:n[d]))return null;const l=316*(a+1)-64,c=120+160*r,i=l+64,m=120+160*d,x=l+32;return(0,o.jsxs)("g",{children:[(0,o.jsx)("line",{x1:l,y1:c,x2:x,y2:c,className:"bracket-connector"}),r%2===0&&r<e.matches.length-1&&(0,o.jsx)("line",{x1:x,y1:c,x2:x,y2:c+160,className:"bracket-connector"}),r%2===0&&(0,o.jsx)("line",{x1:x,y1:c+80,x2:i,y2:m,className:"bracket-connector"})]},"connector-".concat(a,"-").concat(r))})))||[]}))})}function p(e,t){var a,r;if(null===e||void 0===e||!e.length)return{rounds:[],totalHeight:0};return{rounds:e.map(((e,a)=>{var r;const s="lower"===t?120:100*Math.pow(2,a),n=s/2;return(0,i.A)((0,i.A)({},e),{},{roundIndex:a,matchSpacing:s,baseOffset:n,matches:(null===(r=e.matches)||void 0===r?void 0:r.map(((e,t)=>(0,i.A)((0,i.A)({},e),{},{yPosition:n+t*s}))))||[]})})),totalHeight:Math.max(400,160*(null===(a=e[0])||void 0===a||null===(r=a.matches)||void 0===r?void 0:r.length)||400)}}const b=function(e){let{bracket:t,tournament:a,tournamentId:s,navigateTo:n,isAdmin:d=!1,onMatchUpdate:l,onMatchClick:c,onTeamClick:m,hoveredMatch:b,selectedMatch:y,onMatchHover:v,compact:k=!1,collapsible:j=!0}=e;const[f,N]=(0,r.useState)({upperBracket:!0,lowerBracket:!0,grandFinals:!0}),w=(null===t||void 0===t?void 0:t.upper_bracket)||[],_=(null===t||void 0===t?void 0:t.lower_bracket)||[],T=(null===t||void 0===t?void 0:t.grand_final)||(null===t||void 0===t?void 0:t.grand_finals),C=e=>{j&&N((t=>(0,i.A)((0,i.A)({},t),{},{[e]:!t[e]})))},M=(0,r.useMemo)((()=>p(w,"upper")),[w]),S=(0,r.useMemo)((()=>p(_,"lower")),[_]),A=function(e,t,a){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){const a={0:"LB Round 1",1:"LB Round 2",2:"LB Quarterfinals",3:"LB Semifinals",4:"LB Finals"};return e.name||a[t]||"LB Round ".concat(t+1)}{const r={0:a>3?"Round of 16":"Quarterfinals",1:a>3?"Quarterfinals":"Semifinals",2:a>3?"Semifinals":"UB Finals",3:"UB Finals"};return e.name||r[t]||"UB Round ".concat(t+1)}};return(0,o.jsxs)("div",{className:"double-elimination-bracket w-full space-y-12",children:[w.length>0&&(0,o.jsx)(g,{title:"Upper Bracket",color:"blue",isExpanded:f.upperBracket,onToggle:()=>C("upperBracket"),collapsible:j,children:(0,o.jsxs)("div",{className:"relative overflow-x-auto",children:[(0,o.jsx)("div",{className:"flex space-x-16 pb-8",children:M.rounds.map(((e,t)=>(0,o.jsx)(h,{round:e,roundIndex:t,totalRounds:M.rounds.length,roundName:A(e,t,M.rounds.length),onMatchClick:c,onTeamClick:m,hoveredMatch:b,selectedMatch:y,compact:k,isLastRound:t===M.rounds.length-1},"upper-".concat(t))))}),(0,o.jsx)(u,{rounds:M.rounds})]})}),_.length>0&&(0,o.jsx)(g,{title:"Lower Bracket",color:"red",isExpanded:f.lowerBracket,onToggle:()=>C("lowerBracket"),collapsible:j,children:(0,o.jsxs)("div",{className:"relative overflow-x-auto",children:[(0,o.jsx)("div",{className:"flex space-x-16 pb-8",children:S.rounds.map(((e,t)=>(0,o.jsx)(h,{round:e,roundIndex:t,totalRounds:S.rounds.length,roundName:A(e,t,S.rounds.length,!0),onMatchClick:c,onTeamClick:m,hoveredMatch:b,selectedMatch:y,compact:k,isLastRound:t===S.rounds.length-1},"lower-".concat(t))))}),(0,o.jsx)(u,{rounds:S.rounds})]})}),T&&(0,o.jsx)(g,{title:"Grand Finals",color:"yellow",isExpanded:f.grandFinals,onToggle:()=>C("grandFinals"),collapsible:j,children:(0,o.jsx)("div",{className:"flex justify-center py-8",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(x,{match:T,onClick:c,onTeamClick:m,isHovered:(null===b||void 0===b?void 0:b.id)===T.id,isSelected:(null===y||void 0===y?void 0:y.id)===T.id,compact:k}),T.reset_match&&(0,o.jsxs)("div",{className:"mt-6",children:[(0,o.jsx)("div",{className:"text-center mb-4",children:(0,o.jsx)("span",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:"Bracket Reset"})}),(0,o.jsx)(x,{match:T.reset_match,onClick:c,onTeamClick:m,isHovered:(null===b||void 0===b?void 0:b.id)===T.reset_match.id,isSelected:(null===y||void 0===y?void 0:y.id)===T.reset_match.id,compact:k})]})]})})})]})};function y(e){let{standings:t,onTeamClick:a,compact:r=!1}=e;return(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full",children:[(0,o.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Rank"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Team"}),(0,o.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Record"}),(0,o.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pts"}),(0,o.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Diff"}),!r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Buchholz"}),(0,o.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"})]})]})}),(0,o.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(((e,t)=>{const s="qualified"===e.status||e.wins>=3&&e.losses<3,d="eliminated"===e.status||e.losses>=3;return(0,o.jsxs)("tr",{className:"\n                  hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer\n                  ".concat(s?"bg-green-50 dark:bg-green-900/20":"","\n                  ").concat(d?"bg-red-50 dark:bg-red-900/20 opacity-75":"","\n                "),onClick:()=>null===a||void 0===a?void 0:a(e),children:[(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsxs)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:["#",t+1]}),s&&(0,o.jsx)("span",{className:"ml-2 text-green-500",title:"Qualified",children:"\u2713"}),d&&(0,o.jsx)("span",{className:"ml-2 text-red-500",title:"Eliminated",children:"\u2717"})]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)(n.LE,{team:{logo:e.team_logo},size:"w-8 h-8",className:"flex-shrink-0"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.team_name}),e.team_region&&!r&&(0,o.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.team_region})]})]})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:(0,o.jsxs)("span",{className:"text-sm font-bold",children:[(0,o.jsx)("span",{className:"text-green-600 dark:text-green-400",children:e.wins||0}),(0,o.jsx)("span",{className:"mx-1 text-gray-500",children:"-"}),(0,o.jsx)("span",{className:"text-red-600 dark:text-red-400",children:e.losses||0})]})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-center text-sm font-bold text-gray-900 dark:text-white",children:e.points||3*e.wins}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-center text-sm text-gray-700 dark:text-gray-300",children:e.round_differential||e.map_differential||0}),!r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-center text-sm text-gray-700 dark:text-gray-300",children:e.buchholz||"-"}),(0,o.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:[s&&(0,o.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Qualified"}),d&&(0,o.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Eliminated"}),!s&&!d&&(0,o.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Active"})]})]})]},e.team_id||t)}))})]})})}function v(e){let{roundNum:t,matches:a,onMatchClick:r,onTeamClick:s,hoveredMatch:n,selectedMatch:d,compact:l,isCurrentRound:c,hideTitle:i=!1}=e;return null!==a&&void 0!==a&&a.length?(0,o.jsxs)("div",{className:"swiss-round",children:[!i&&(0,o.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsxs)("h4",{className:"\n              text-sm font-bold tracking-wider uppercase border-b-2 pb-2 \n              ".concat(c?"text-blue-700 dark:text-blue-300 border-blue-500":"text-gray-700 dark:text-gray-300 border-gray-400","\n            "),children:["Round ",t]}),c&&(0,o.jsx)("span",{className:"bg-green-500 text-white text-xs px-2 py-1 rounded-full font-medium",children:"Live"})]})}),(0,o.jsx)("div",{className:"\n        grid gap-6\n        ".concat(l?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3","\n      "),children:a.map(((e,t)=>(0,o.jsx)("div",{className:"transition-all duration-300",children:(0,o.jsx)(x,{match:e,onClick:r,onTeamClick:s,isHovered:(null===n||void 0===n?void 0:n.id)===e.id,isSelected:(null===d||void 0===d?void 0:d.id)===e.id,compact:l})},e.id||t)))})]}):null}const k=function(e){let{bracket:t,tournament:a,tournamentId:s,navigateTo:n,isAdmin:d=!1,onMatchUpdate:l,onMatchClick:c,onTeamClick:i,hoveredMatch:m,selectedMatch:x,compact:g=!1,showStandings:h=!0}=e;const[u,p]=(0,r.useState)(null),b=(null===t||void 0===t?void 0:t.rounds)||{},k=(null===t||void 0===t?void 0:t.standings)||[],j=(null===t||void 0===t?void 0:t.current_round)||Math.max(...Object.keys(b).map(Number),0),f=Object.entries(b).sort(((e,t)=>{let[a]=e,[r]=t;return Number(a)-Number(r)})).map((e=>{let[t,a]=e;return{roundNum:Number(t),matches:a}}));return(0,o.jsxs)("div",{className:"swiss-bracket w-full space-y-8",children:[h&&k.length>0&&(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,o.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Swiss System Standings"}),(0,o.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Current Round: ",j]})]})}),(0,o.jsx)(y,{standings:k,onTeamClick:i,compact:g})]}),f.length>0&&(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Swiss Rounds"}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,o.jsx)("button",{onClick:()=>p(null),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(null===u?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),children:"All Rounds"}),f.map((e=>{let{roundNum:t}=e;return(0,o.jsxs)("button",{onClick:()=>p(t),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(u===t?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"," ").concat(t===j?"ring-2 ring-blue-400":""),children:["Round ",t,t===j&&(0,o.jsx)("span",{className:"ml-1 text-xs bg-green-500 text-white px-1 rounded",children:"Live"})]},t)}))]})]}),(0,o.jsx)("div",{className:"space-y-8",children:f.filter((e=>{let{roundNum:t}=e;return null===u||u===t})).map((e=>{let{roundNum:t,matches:a}=e;return(0,o.jsx)(v,{roundNum:t,matches:a,onMatchClick:c,onTeamClick:i,hoveredMatch:m,selectedMatch:x,compact:g,isCurrentRound:t===j,hideTitle:u===t},t)}))})]})]})};function j(e){let{viewMode:t,onViewModeChange:a}=e;return(0,o.jsx)("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-md p-1",children:[{key:"standings",label:"Standings"},{key:"matches",label:"Matches"},{key:"matrix",label:"H2H Matrix"}].map((e=>{let{key:r,label:s}=e;return(0,o.jsx)("button",{onClick:()=>a(r),className:"px-3 py-1 text-sm rounded transition-colors ".concat(t===r?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:s},r)}))})}function f(e){let{groupName:t,standings:a,matches:r,viewMode:s,onMatchClick:n,onTeamClick:d,hoveredMatch:l,selectedMatch:c,compact:i,hideTitle:m=!1}=e;return(0,o.jsxs)("div",{className:"group-section",children:[!m&&(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsxs)("h4",{className:"text-md font-bold text-gray-900 dark:text-white border-b-2 border-blue-500 pb-2 inline-block",children:["Group ",t]})}),"standings"===s&&(0,o.jsx)(N,{standings:a,onTeamClick:d,compact:i,isGroupStage:!0}),"matches"===s&&(0,o.jsx)(w,{matches:r,onMatchClick:n,onTeamClick:d,hoveredMatch:l,selectedMatch:c,compact:i}),"matrix"===s&&(0,o.jsx)(_,{standings:a,matches:r,onMatchClick:n,onTeamClick:d,compact:i})]})}function N(e){let{standings:t,onTeamClick:a,compact:r=!1,isGroupStage:s=!1,showAdvancement:d=!1}=e;return null!==t&&void 0!==t&&t.length?(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full",children:[(0,o.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pos"}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Team"}),(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"P"}),(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"W"}),(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"L"}),(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"+/-"}),(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pts"}),!r&&(0,o.jsx)("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Form"})]})}),(0,o.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(((e,t)=>{const l=s&&t<2,c=d&&"qualified"===e.status;return(0,o.jsxs)("tr",{className:"\n                  hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer\n                  ".concat(l||c?"bg-green-50 dark:bg-green-900/20":"","\n                "),onClick:()=>null===a||void 0===a?void 0:a(e),children:[(0,o.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:t+1}),(l||c)&&(0,o.jsx)("span",{className:"ml-2 text-green-500 text-xs",title:"Advances",children:"\u2713"})]})}),(0,o.jsx)("td",{className:"px-6 py-3 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)(n.LE,{team:{logo:e.team_logo},size:"w-6 h-6",className:"flex-shrink-0"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.team_name}),e.team_region&&!r&&(0,o.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.team_region})]})]})}),(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center text-sm text-gray-700 dark:text-gray-300",children:e.played||e.wins+e.losses}),(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center text-sm font-bold text-green-600 dark:text-green-400",children:e.wins||0}),(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center text-sm font-bold text-red-600 dark:text-red-400",children:e.losses||0}),(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center text-sm text-gray-700 dark:text-gray-300",children:e.round_differential||e.map_differential||0}),(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center text-sm font-bold text-gray-900 dark:text-white",children:e.points||3*e.wins}),!r&&(0,o.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-center",children:(0,o.jsx)("div",{className:"flex items-center justify-center space-x-1",children:(e.recent_form||"WWLWL").split("").slice(-5).map(((e,t)=>(0,o.jsx)("span",{className:"w-4 h-4 text-xs font-bold rounded-full flex items-center justify-center ".concat("W"===e?"bg-green-500 text-white":"bg-red-500 text-white"),children:e},t)))})})]},e.team_id||t)}))})]})}):(0,o.jsx)("div",{className:"p-6 text-gray-500",children:"No standings available"})}function w(e){let{matches:t,onMatchClick:a,onTeamClick:r,hoveredMatch:s,selectedMatch:n,compact:d}=e;return null!==t&&void 0!==t&&t.length?(0,o.jsx)("div",{className:"\n      grid gap-4\n      ".concat(d?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3":"grid-cols-1 md:grid-cols-2","\n    "),children:t.map(((e,t)=>(0,o.jsx)(x,{match:e,onClick:a,onTeamClick:r,isHovered:(null===s||void 0===s?void 0:s.id)===e.id,isSelected:(null===n||void 0===n?void 0:n.id)===e.id,compact:d},e.id||t)))}):(0,o.jsx)("div",{className:"text-gray-500",children:"No matches available"})}function _(e){let{standings:t,matches:a,onMatchClick:r,onTeamClick:s,compact:d}=e;if(null===t||void 0===t||!t.length)return(0,o.jsx)("div",{className:"text-gray-500",children:"No data available"});const l={};return t.forEach((e=>{l[e.team_id]={},t.forEach((t=>{e.team_id!==t.team_id&&(l[e.team_id][t.team_id]={wins:0,losses:0,matches:[]})}))})),null===a||void 0===a||a.forEach((e=>{if(e.team1_id&&e.team2_id&&"completed"===e.status){const t=e.team1_score>e.team2_score?e.team1_id:e.team2_id,a=t===e.team1_id?e.team2_id:e.team1_id;l[t]&&l[t][a]&&(l[t][a].wins++,l[t][a].matches.push(e)),l[a]&&l[a][t]&&(l[a][t].losses++,l[a][t].matches.push(e))}})),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full border-collapse",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"p-2 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800"}),t.map(((e,t)=>(0,o.jsx)("th",{className:"p-2 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 text-center min-w-[60px]",children:(0,o.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,o.jsx)(n.LE,{team:{logo:e.team_logo},size:"w-6 h-6"}),!d&&(0,o.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 truncate max-w-[50px]",children:e.team_name})]})},e.team_id||t)))]})}),(0,o.jsx)("tbody",{children:t.map(((e,a)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"p-2 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 font-medium",children:(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)(n.LE,{team:{logo:e.team_logo},size:"w-6 h-6"}),(0,o.jsx)("span",{className:"text-sm truncate",children:e.team_name})]})}),t.map(((t,s)=>{var n;if(a===s)return(0,o.jsx)("td",{className:"p-2 border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-center",children:(0,o.jsx)("span",{className:"text-gray-400",children:"\u2014"})},t.team_id||s);const d=null===(n=l[e.team_id])||void 0===n?void 0:n[t.team_id],c=d&&(d.wins>0||d.losses>0);return(0,o.jsx)("td",{className:"\n                      p-2 border border-gray-300 dark:border-gray-600 text-center text-sm cursor-pointer\n                      hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\n                      ".concat(c?"":"bg-gray-50 dark:bg-gray-800","\n                    "),onClick:()=>{(null===d||void 0===d?void 0:d.matches.length)>0&&(null===r||void 0===r||r(d.matches[0]))},children:c?(0,o.jsxs)("span",{className:"font-bold ".concat(d.wins>d.losses?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[d.wins,"-",d.losses]}):(0,o.jsx)("span",{className:"text-gray-400",children:"\u2014"})},t.team_id||s)}))]},e.team_id||a)))})]})})}const T=function(e){var t;let{bracket:a,tournament:s,tournamentId:n,navigateTo:d,isAdmin:l=!1,onMatchUpdate:c,onMatchClick:m,onTeamClick:x,hoveredMatch:g,selectedMatch:h,compact:u=!1}=e;const[p,b]=(0,r.useState)(null),[y,v]=(0,r.useState)("standings"),k=(null===a||void 0===a?void 0:a.groups)||{},T=(null===a||void 0===a?void 0:a.standings)||[],C=Object.entries(k).sort(((e,t)=>{let[a]=e,[r]=t;return a.localeCompare(r)})).map((e=>{let[t,a]=e;return(0,i.A)({groupName:t},a)})),M=!Object.keys(k).length&&(T.length||(null===a||void 0===a||null===(t=a.matches)||void 0===t?void 0:t.length));return(0,o.jsxs)("div",{className:"round-robin-bracket w-full space-y-8",children:[T.length>0&&C.length>1&&(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,o.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Overall Standings"})}),(0,o.jsx)(N,{standings:T,onTeamClick:x,compact:u,showAdvancement:!0})]}),M&&(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,o.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Round Robin"}),(0,o.jsx)(j,{viewMode:y,onViewModeChange:v})]})}),"standings"===y&&(0,o.jsx)(N,{standings:T,onTeamClick:x,compact:u}),"matches"===y&&(null===a||void 0===a?void 0:a.matches)&&(0,o.jsx)("div",{className:"p-6",children:(0,o.jsx)(w,{matches:a.matches,onMatchClick:m,onTeamClick:x,hoveredMatch:g,selectedMatch:h,compact:u})}),"matrix"===y&&(0,o.jsx)("div",{className:"p-6",children:(0,o.jsx)(_,{standings:T,matches:(null===a||void 0===a?void 0:a.matches)||[],onMatchClick:m,onTeamClick:x,compact:u})})]}),C.length>0&&(0,o.jsx)("div",{className:"space-y-8",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Group Stage"}),(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsx)(j,{viewMode:y,onViewModeChange:v}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,o.jsx)("button",{onClick:()=>b(null),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(null===p?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),children:"All Groups"}),C.map((e=>{let{groupName:t}=e;return(0,o.jsxs)("button",{onClick:()=>b(t),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat(p===t?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),children:["Group ",t]},t)}))]})]})]}),(0,o.jsx)("div",{className:"".concat(p?"space-y-6":"grid grid-cols-1 lg:grid-cols-2 gap-8"),children:C.filter((e=>{let{groupName:t}=e;return null===p||p===t})).map((e=>{let{groupName:t,standings:a=[],matches:r=[]}=e;return(0,o.jsx)(f,{groupName:t,standings:a,matches:r,viewMode:y,onMatchClick:m,onTeamClick:x,hoveredMatch:g,selectedMatch:h,compact:u,hideTitle:p===t},t)}))})]})})]})};const C=function(e){var t,a,i,m,x,g,h,u,p,y,v,j;let{params:f,navigateTo:N}=e;const[w,_]=(0,r.useState)(null),[C,M]=(0,r.useState)([]),[S,A]=(0,r.useState)([]),[E,R]=(0,r.useState)(null),[U,L]=(0,r.useState)("overview"),[B,D]=(0,r.useState)(!0),[P,F]=(0,r.useState)(!1),[z,I]=(0,r.useState)([]),[O,H]=(0,r.useState)(""),[W,G]=(0,r.useState)(!1),[Q,V]=(0,r.useState)(null),[K,q]=(0,r.useState)(null),{api:Y,isAdmin:J,isModerator:X}=(0,s.As)(),Z=null===f||void 0===f?void 0:f.id,{isConnected:$,connectionStatus:ee,refresh:te}=d(Z,{onTournamentUpdate:e=>{console.log("\ud83d\udd04 Tournament update received:",e),e.tournament&&(_(e.tournament),A(e.teams||[]),M(e.matches||[]),R(e.bracket),V(e.timestamp))},onMatchUpdate:e=>{console.log("\u26a1 Match update received:",e),M((t=>t.map((t=>t.id===e.match.id?e.match:t))))},onBracketUpdate:e=>{console.log("\ud83d\udd04 Bracket update received:",e),R(e.bracket)},onError:e=>{console.error("\u274c Real-time update error:",e),q(e.message)}});console.log("\ud83d\udd0d TournamentDetailPage - Received tournament ID:",Z),(0,r.useEffect)((()=>{Z&&(ae(),re())}),[Z]),(0,r.useEffect)((()=>{G($)}),[$]);const ae=async()=>{try{var e;D(!0),console.log("\ud83d\udd04 TournamentDetailPage: Fetching tournament data for ID:",Z);const t=await Y.get("/events/".concat(Z)),a=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||t;console.log("\u2705 Tournament data received:",a),_(a);let r=[];a.teams&&Array.isArray(a.teams)?r=a.teams:a.participating_teams&&Array.isArray(a.participating_teams)?r=a.participating_teams:a.event_teams&&Array.isArray(a.event_teams)&&(r=a.event_teams),console.log("\u2705 Teams data found:",r.length,"teams"),A(r);let s=[];a.matches&&Array.isArray(a.matches)?s=a.matches:a.event_matches&&Array.isArray(a.event_matches)&&(s=a.event_matches),console.log("\u2705 Matches data found:",s.length,"matches"),M(s),a.bracket?(console.log("\u2705 Bracket found in response:",a.bracket),R(a.bracket)):a.bracket_data?(console.log("\u2705 Bracket found in bracket_data:",a.bracket_data),R(a.bracket_data)):console.log("\u26a0\ufe0f No bracket data found in response"),console.log("\u2705 Tournament data loaded with embedded teams and matches")}catch(K){console.error("\u274c Error fetching tournament data:",K),_(null),M([]),A([])}finally{D(!1)}},re=async()=>{try{var e;const t=await Y.get("/teams"),a=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];I(a)}catch(K){console.error("\u274c Error fetching teams:",K)}},se=async()=>{try{console.log("\ud83c\udfc6 Generating bracket for tournament:",Z);await Y.post("/admin/events/".concat(Z,"/generate-bracket"));console.log("\u2705 Bracket generated successfully"),await ae()}catch(K){var e,t;console.error("\u274c Error generating bracket:",K),alert("Failed to generate bracket: "+((null===(e=K.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||K.message))}},ne=async(e,t)=>{try{await Y.put("/admin/events/".concat(Z,"/matches/").concat(e,"/score"),t),console.log("\u2705 Match updated successfully"),await ae()}catch(K){var a,r;console.error("\u274c Error updating match:",K),alert("Failed to update match: "+((null===(a=K.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||K.message))}},de=e=>{if(!e)return"TBD";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},le=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return e&&0!==e?new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e):"TBD"},ce=e=>({single_elimination:"Single Elimination",double_elimination:"Double Elimination",swiss:"Swiss System",round_robin:"Round Robin",group_stage:"Group Stage",gsl:"GSL Format",battle_royale:"Battle Royale"}[e]||e),ie=[{id:"overview",name:"Overview"},{id:"teams",name:"Teams (".concat(S.length,")")},{id:"matches",name:"Matches (".concat(C.length,")")},{id:"bracket",name:"Bracket"},{id:"stats",name:"Statistics"}];return B?(0,o.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,o.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading tournament details..."})]})}):w?(0,o.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-500",children:[(0,o.jsx)("button",{onClick:()=>N&&N("home"),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Home"}),(0,o.jsx)("span",{children:"\u203a"}),(0,o.jsx)("button",{onClick:()=>N&&N("tournaments"),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"Tournaments"}),(0,o.jsx)("span",{children:"\u203a"}),(0,o.jsx)("span",{className:"text-gray-900 dark:text-white",children:w.name})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsxs)("div",{className:"h-48 bg-gradient-to-r from-red-600 to-red-800 rounded-lg overflow-hidden",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),(0,o.jsxs)("div",{className:"relative z-10 h-full flex items-end p-8",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,o.jsx)("div",{className:"w-24 h-24 rounded-lg bg-white/20 overflow-hidden flex-shrink-0",children:(0,o.jsx)("img",{src:(0,n.NR)(w),alt:w.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.parentNode.innerHTML='<div class="w-full h-full flex items-center justify-center text-3xl font-bold text-white">\ud83c\udfc6</div>'}})}),(0,o.jsxs)("div",{className:"text-white",children:[(0,o.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold",children:w.name}),W&&(0,o.jsxs)("div",{className:"flex items-center gap-2 text-sm bg-green-500 px-2 py-1 rounded",children:[(0,o.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,o.jsx)("span",{children:"Live Updates"})]})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-4 text-red-100",children:[(e=>{const t={upcoming:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-200",ongoing:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-200",live:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200 animate-pulse",completed:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200"};return(0,o.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(t[e]||t.upcoming),children:["live"===e&&(0,o.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-1 animate-pulse inline-block"}),e.charAt(0).toUpperCase()+e.slice(1)]})})(w.status),(0,o.jsx)("span",{children:(null===(t=w.details)||void 0===t?void 0:t.region)||w.region}),(0,o.jsx)("span",{children:"\u2022"}),(0,o.jsx)("span",{children:ce((null===(a=w.details)||void 0===a?void 0:a.format)||w.format)})]})]})]}),(J()||X())&&(0,o.jsx)("div",{className:"absolute top-4 right-4",children:(0,o.jsx)("button",{onClick:()=>N&&N("admin-event-edit",{id:w.id}),className:"px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded hover:bg-white/30 transition-colors",children:"Edit Tournament"})})]})]}),(0,o.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 mt-6",children:(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:le((null===(i=w.details)||void 0===i?void 0:i.prize_pool)||w.prize_pool,null===(m=w.details)||void 0===m?void 0:m.currency)}),(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Prize Pool"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:S.length}),(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Teams"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:C.length}),(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Matches"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:de((null===(x=w.schedule)||void 0===x?void 0:x.start_date)||w.start_date)}),(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Start Date"})]})]})})]}),(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,o.jsx)("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:ie.map((e=>(0,o.jsx)("button",{onClick:()=>L(e.id),className:"flex-1 px-6 py-4 text-sm font-medium transition-colors ".concat(U===e.id?"text-red-600 dark:text-red-400 border-b-2 border-red-600 dark:border-red-400 bg-red-50 dark:bg-red-900/10":"text-gray-700 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400 hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:e.name},e.id)))}),(0,o.jsxs)("div",{className:"p-6",children:["overview"===U&&(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"About the Tournament"}),(0,o.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:w.description||"No description available."})]}),w.rules&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"Rules & Format"}),(0,o.jsx)("div",{className:"prose dark:prose-invert max-w-none",children:w.rules})]}),(null===(g=w.details)||void 0===g?void 0:g.prize_distribution)&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"Prize Distribution"}),(0,o.jsx)("div",{className:"space-y-2",children:Object.entries(w.details.prize_distribution).map((e=>{var t;let[a,r]=e;return(0,o.jsxs)("div",{className:"flex justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,o.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:a}),(0,o.jsx)("span",{className:"text-green-600 dark:text-green-400",children:le(r,null===(t=w.details)||void 0===t?void 0:t.currency)})]},a)}))})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-3",children:"Schedule"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,o.jsx)("div",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Start Date"}),(0,o.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:de((null===(h=w.schedule)||void 0===h?void 0:h.start_date)||w.start_date)})]}),(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,o.jsx)("div",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"End Date"}),(0,o.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:de((null===(u=w.schedule)||void 0===u?void 0:u.end_date)||w.end_date)})]})]})]})]}),"teams"===U&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsxs)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:["Participating Teams (",S.length,"/",(null===(p=w.participation)||void 0===p?void 0:p.max_teams)||w.max_teams||"\u221e",")"]}),(J()||X())&&(0,o.jsx)("button",{onClick:()=>F(!0),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Add Team"})]}),(0,o.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map((e=>(0,o.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer flex-1",onClick:()=>N&&N("team-detail",{id:e.id}),children:[(0,o.jsx)(n.LE,{team:e,size:"w-12 h-12"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),(0,o.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-500",children:[(0,o.jsx)("span",{children:(0,n.xg)(e.country||e.region)}),(0,o.jsx)("span",{children:(0,n.qQ)(e.country||e.region)})]})]})]}),(J()||X())&&(0,o.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this team from the tournament?"))try{await Y.delete("/admin/events/".concat(Z,"/teams/").concat(e)),console.log("\u2705 Team removed successfully"),await ae()}catch(K){var t,a;console.error("\u274c Error removing team:",K);const r=(null===(t=K.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||K.message||"Failed to remove team";alert(r)}})(e.id),className:"text-red-600 hover:text-red-700 transition-colors p-1",title:"Remove team",children:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},e.id)))}),0===S.length&&(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc65"}),(0,o.jsx)("div",{className:"text-gray-500 dark:text-gray-500",children:"No teams registered yet"})]})]}),"matches"===U&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-6",children:"Tournament Matches"}),C.length>0?(0,o.jsx)("div",{className:"space-y-4",children:C.map((e=>(0,o.jsx)(l.A,{match:e,navigateTo:N},e.id)))}):(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\u2694\ufe0f"}),(0,o.jsx)("div",{className:"text-gray-500 dark:text-gray-500",children:"No matches scheduled yet"})]})]}),"bracket"===U&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-2",children:"Tournament Bracket"}),(0,o.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[ce((null===(y=w.details)||void 0===y?void 0:y.format)||w.format)," format"]})]}),(()=>{var e;const t=(null===w||void 0===w||null===(e=w.details)||void 0===e?void 0:e.format)||(null===w||void 0===w?void 0:w.format);if(!E)return(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Bracket not generated yet"}),(0,o.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:S.length<2?"Need at least 2 teams to generate bracket (currently ".concat(S.length,")"):"Click below to generate the tournament bracket"}),(J()||X())&&S.length>=2&&(0,o.jsx)("button",{onClick:se,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Generate Bracket"})]});switch(t){case"double_elimination":return(0,o.jsx)(b,{bracket:E,tournament:w,tournamentId:Z,navigateTo:N,isAdmin:J()||X(),onMatchUpdate:ne});case"swiss":return(0,o.jsx)(k,{bracket:E,tournament:w,tournamentId:Z,navigateTo:N,isAdmin:J()||X(),onMatchUpdate:ne});case"round_robin":return(0,o.jsx)(T,{bracket:E,tournament:w,tournamentId:Z,navigateTo:N,isAdmin:J()||X(),onMatchUpdate:ne});default:return(0,o.jsx)(c.A,{bracket:E,event:w,eventId:Z,navigateTo:N,isAdmin:J()||X(),onMatchUpdate:ne})}})()]}),"stats"===U&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400 mb-6",children:"Tournament Statistics"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,o.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"General"}),(0,o.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Teams:"}),(0,o.jsx)("span",{className:"font-medium",children:S.length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Matches:"}),(0,o.jsx)("span",{className:"font-medium",children:C.length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Completed:"}),(0,o.jsx)("span",{className:"font-medium",children:C.filter((e=>"completed"===e.status)).length})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Ongoing:"}),(0,o.jsx)("span",{className:"font-medium",children:C.filter((e=>"live"===e.status||"ongoing"===e.status)).length})]})]})]}),(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,o.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Prize Pool"}),(0,o.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Prize:"}),(0,o.jsx)("span",{className:"font-medium text-green-600",children:le((null===(v=w.details)||void 0===v?void 0:v.prize_pool)||w.prize_pool)})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Currency:"}),(0,o.jsx)("span",{className:"font-medium",children:(null===(j=w.details)||void 0===j?void 0:j.currency)||"USD"})]})]})]}),(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,o.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Regions"}),(0,o.jsx)("div",{className:"space-y-2 text-sm",children:S.reduce(((e,t)=>{const a=t.country||t.region||"Unknown";return e[a]=(e[a]||0)+1,e}),{})&&Object.entries(S.reduce(((e,t)=>{const a=t.country||t.region||"Unknown";return e[a]=(e[a]||0)+1,e}),{})).map((e=>{let[t,a]=e;return(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("span",{className:"text-gray-600 dark:text-gray-400 flex items-center",children:[(0,n.xg)(t)," ",(0,n.qQ)(t)]}),(0,o.jsx)("span",{className:"font-medium",children:a})]},t)}))})]})]})]})]})]}),P&&(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add Team to Tournament"}),(0,o.jsxs)("select",{value:O,onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-4",children:[(0,o.jsx)("option",{value:"",children:"Select a team"}),z.filter((e=>!S.some((t=>t.id===e.id)))).map((e=>(0,o.jsxs)("option",{value:e.id,children:[e.name," (",e.region,")"]},e.id)))]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,o.jsx)("button",{onClick:()=>{F(!1),H("")},className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:"Cancel"}),(0,o.jsx)("button",{onClick:async()=>{if(O)try{await Y.post("/admin/events/".concat(Z,"/teams"),{team_id:O}),console.log("\u2705 Team added successfully"),await ae(),F(!1),H("")}catch(K){var e,t;console.error("\u274c Error adding team:",K);const r=(null===(e=K.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||K.message||"Failed to add team";alert(r)}},disabled:!O,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Team"})]})]})})]}):(0,o.jsxs)("div",{className:"card p-12 text-center",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udfc6"}),(0,o.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Tournament Not Found"}),(0,o.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The tournament you're looking for doesn't exist or may have been removed."}),(0,o.jsx)("button",{onClick:()=>N&&N("tournaments"),className:"px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"\u2190 Back to Tournaments"})]})}}}]);