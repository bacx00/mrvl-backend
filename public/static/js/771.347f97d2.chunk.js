"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[771],{1368:(e,t,r)=>{r.d(t,{A:()=>n});r(9950);var a=r(4414);const n=e=>{let{mention:t,className:r="",onClick:n,showIcon:s=!0,navigateTo:o}=e;const i=e=>"string"===typeof e?e:"object"===typeof e&&null!==e?e.name&&"string"===typeof e.name?e.name:e.display_name&&"string"===typeof e.display_name?e.display_name:"":e?String(e):"",l=(null===t||void 0===t?void 0:t.type)||"",d=(null===t||void 0===t?void 0:t.id)||"",c=i(null===t||void 0===t?void 0:t.name),m=i(null===t||void 0===t?void 0:t.display_name),u=()=>{switch(l){case"player":return{page:"player-detail",params:{id:d}};case"team":return{page:"team-detail",params:{id:d}};default:return null}},g=()=>{switch(l){case"player":return"bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50 border border-blue-200 dark:border-blue-800";case"team":return"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50 border border-red-200 dark:border-red-800";case"user":return"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:hover:bg-green-900/50 border border-green-200 dark:border-green-800";default:return"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800/30 dark:text-gray-400 dark:hover:bg-gray-800/50 border border-gray-200 dark:border-gray-700"}},x=e=>{e.preventDefault(),e.stopPropagation();const r=u(),a=e.currentTarget;if(a.classList.add("transform","scale-95"),setTimeout((()=>{a.classList.remove("transform","scale-95")}),150),r&&o)o(r.page,r.params);else if(r){const e=p(r);e&&"undefined"!==typeof window&&(window.location.hash=e)}n&&n(t,e)},p=e=>{switch(e.page){case"player-detail":return"player-detail/".concat(e.params.id);case"team-detail":return"team-detail/".concat(e.params.id);case"user-profile":return"user-profile/".concat(e.params.id);default:return""}},h=u(),f=m||c||"Unknown ".concat(l||"mention");return h?(0,a.jsx)("button",{onClick:x,className:"inline-flex items-center font-medium px-2 py-0.5 rounded transition-all duration-200 cursor-pointer transform hover:scale-105 active:scale-95 ".concat(g()," ").concat(r),title:"View ".concat(l,": ").concat(f),children:f}):(0,a.jsx)("span",{className:"inline-flex items-center font-medium px-2 py-0.5 rounded transition-all duration-200 ".concat(g()," ").concat(r),onClick:x,children:f})}},1453:(e,t,r)=>{r.d(t,{A:()=>i,G:()=>o});r(9950);var a=r(9190),n=r(6225),s=r(4414);const o=function(e,t){if(!e)return null;const r={};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((e=>{const t=e.mention_text||"@".concat(e.name);r[t]=e}));const a=[];if([{regex:/@player:([a-zA-Z0-9_]+)/g,type:"player",prefix:"@player:"},{regex:/@team:([a-zA-Z0-9_]+)/g,type:"team",prefix:"@team:"},{regex:/@([a-zA-Z0-9_]+)(?!:)/g,type:"user",prefix:"@"}].forEach((t=>{let n,{regex:s,type:o,prefix:i}=t;for(;null!==(n=s.exec(e));){const e=n[0],t=n[1],s=n.index,i=n.index+e.length,l=r[e];a.push({start:s,end:i,original:e,type:o,identifier:t,data:l})}})),a.sort(((e,t)=>t.start-e.start)),0===a.length)return e;const n=[];let o=e.length;return a.forEach((r=>{o>r.end&&n.unshift(e.slice(r.end,o)),r.data?n.unshift((0,s.jsx)("span",{className:"mention-link font-medium px-1 rounded cursor-pointer transition-colors ".concat("player"===r.type?"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20":"team"===r.type?"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20":"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20"),onClick:e=>{if(e.stopPropagation(),t&&r.data)switch(r.type){case"player":t("player-detail",{id:r.data.id});break;case"team":t("team-detail",{id:r.data.id});break;case"user":t("user-profile",{id:r.data.id});break;default:console.warn("Unknown mention type:",r.type)}},title:"View ".concat(r.type,": ").concat(r.data.display_name||r.data.name),children:r.original},"mention-".concat(r.start))):n.unshift(r.original),r.start>0&&n.unshift(e.slice(0,r.start)),o=r.start})),n.length>0?n:e},i=function(e){let{user:t,showAvatar:r=!0,showTeamFlair:o=!0,showHeroFlair:i=!0,size:l="sm",className:d="",clickable:c=!1,navigateTo:m=null}=e;if(!t)return(0,s.jsx)("span",{className:"text-gray-500",children:"Unknown User"});const u={xs:"w-4 h-4 text-xs",sm:"w-6 h-6 text-sm",md:"w-8 h-8 text-base",lg:"w-10 h-10 text-lg"};return(0,s.jsxs)("div",{className:"flex items-center space-x-2 ".concat(d),children:[r&&(0,s.jsx)(a.A,{user:t,size:l,showFlairs:!1,showName:!1}),(0,s.jsx)("span",{className:"font-medium ".concat(c?"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 cursor-pointer":"text-gray-900 dark:text-white"),onClick:()=>{c&&m&&t.id&&m("user-profile",{id:t.id})},children:t.name||t.username}),o&&t.team_flair&&t.show_team_flair&&(0,s.jsx)("div",{className:"".concat(u[l]," flex-shrink-0"),children:t.team_flair.logo?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:(0,n.VG)(t.team_flair.logo,"team-logo"),alt:t.team_flair.short_name||t.team_flair.name,className:"".concat(u[l]," object-contain rounded"),title:t.team_flair.name,onError:e=>{e.target.src=(0,n.VG)(null,"team-logo")}}),(0,s.jsx)("div",{className:"".concat(u[l]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs hidden"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})]}):(0,s.jsx)("div",{className:"".concat(u[l]," rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs"),title:t.team_flair.name,children:t.team_flair.short_name||t.team_flair.name.substring(0,3).toUpperCase()})}),t.roles&&t.roles.length>0&&(0,s.jsx)("div",{className:"flex space-x-1",children:t.roles.map((e=>(0,s.jsx)("span",{className:"px-1.5 py-0.5 text-xs font-bold rounded ".concat("admin"===e?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"moderator"===e?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"),children:e.toUpperCase()},e)))})]})}},1990:(e,t,r)=>{r.d(t,{Jo:()=>n,Vm:()=>s,nr:()=>a});const a=e=>"string"===typeof e?e:null===e||void 0===e?"":"object"===typeof e?e.message?String(e.message):e.error&&"string"===typeof e.error?e.error:e.content?String(e.content):Array.isArray(e)?e.map((e=>a(e))).join(", "):e.text?String(e.text):e.title?String(e.title):e.name?String(e.name):e.statusText?e.statusText:e.status?"Status: ".concat(e.status):(console.warn("Object could not be safely converted to string:",e),""):String(e),n=e=>{var t,r,n;return e?"string"===typeof e?e:null!==(t=e.response)&&void 0!==t&&null!==(r=t.data)&&void 0!==r&&r.message?a(e.response.data.message):e.message?a(e.message):null!==(n=e.response)&&void 0!==n&&n.statusText?"".concat(e.response.status,": ").concat(e.response.statusText):"NETWORK_ERROR"===e.code?"Network connection failed":a(e)||"An error occurred":"An unknown error occurred"},s=e=>{const t=a(e);return t&&t.trim()?t:""}},4085:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(9950),n=r(5150),s=r(4414);const o=function(e){let{value:t,onChange:r,placeholder:o="Write your message...",className:i="",rows:l=4,maxLength:d=1e4,disabled:c=!1}=e;const{api:m}=(0,n.As)(),[u,g]=(0,a.useState)(!1),[x,p]=(0,a.useState)([]),[h,f]=(0,a.useState)(""),[b,y]=(0,a.useState)("user"),[v,k]=(0,a.useState)(0),[w,j]=(0,a.useState)(0),[_,N]=(0,a.useState)(!1),[S,C]=(0,a.useState)({top:0,left:0}),A=(0,a.useRef)(null),E=(0,a.useRef)(null);(0,a.useEffect)((()=>{const e=setTimeout((()=>{h.length>=1?T(h,b):(p([]),g(!1))}),300);return()=>clearTimeout(e)}),[h,b]);const T=async(e,t)=>{if(!("string"===typeof e?e:"").trim())return;N(!0);const r=new AbortController;try{let a=[];"user"===t?a=[m.get("/public/search/teams?q=".concat(encodeURIComponent(e),"&limit=8"),{signal:r.signal}).catch((()=>({data:[]}))),m.get("/public/search/players?q=".concat(encodeURIComponent(e),"&limit=8"),{signal:r.signal}).catch((()=>({data:[]})))]:"team"===t?a=[m.get("/public/search/teams?q=".concat(encodeURIComponent(e),"&limit=10"),{signal:r.signal})]:"player"===t&&(a=[m.get("/public/search/players?q=".concat(encodeURIComponent(e),"&limit=10"),{signal:r.signal})]);const n=await Promise.all(a);if(!r.signal.aborted){let e=[];n.forEach((t=>{const r=(null===t||void 0===t?void 0:t.data)||t||[];Array.isArray(r)&&(e=e.concat(r))})),e.sort(((e,t)=>{const r={team:0,player:1};return(r[e.type]||2)-(r[t.type]||2)})),e=e.slice(0,15),p(e),g(e.length>0),j(0)}}catch(a){"AbortError"===a.name||r.signal.aborted||(console.error("Error searching mentions:",a),p([]),g(!1))}finally{r.signal.aborted||N(!1)}},R=e=>{if(!e)return;const a=t||"",n=A.current?A.current.selectionStart:v+h.length+1,s=a.substring(0,v),o=a.substring(n);let i="";if("string"===typeof e.mention_text&&e.mention_text)i=e.mention_text;else{const t=U(e);i="@".concat(t)}"function"===typeof r&&r(s+i+" "+o);const l=v+i.length+1;setTimeout((()=>{A.current&&(A.current.focus(),A.current.setSelectionRange(l,l))}),0),g(!1),f("")},U=e=>{const t=e=>"string"===typeof e?e:"object"===typeof e&&null!==e?e.name&&"string"===typeof e.name?e.name:e.username&&"string"===typeof e.username?e.username:e.display_name&&"string"===typeof e.display_name?e.display_name:"":e?String(e):"",r=t(e.display_name);return r||("user"===e.type?t(e.name)||t(e.username)||"":"team"===e.type?t(e.name)||t(e.short_name)||"":"player"===e.type?t(e.real_name)||t(e.username)||t(e.name)||"":t(e.name)||t(e.username)||"Unknown")};(0,a.useEffect)((()=>{u&&C(z())}),[u]),(0,a.useEffect)((()=>{const e=e=>{E.current&&!E.current.contains(e.target)&&A.current&&!A.current.contains(e.target)&&g(!1)},t=()=>{u&&C(z())};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t),window.addEventListener("resize",t),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}}),[u]);const z=()=>{if(!A.current)return{top:0,left:0,minWidth:300,maxWidth:400};try{const e=A.current.getBoundingClientRect(),t=window.innerHeight,r=window.innerWidth,a=r>=768&&r<1024;if(r<768){const e=260,r=t-e,a=Math.min(200,.4*r);return{position:"fixed",bottom:"".concat(e+10,"px"),left:"0.5rem",right:"0.5rem",maxHeight:"".concat(a,"px"),width:"auto",minWidth:"auto",maxWidth:"none",zIndex:9999,borderRadius:"12px",backdropFilter:"blur(10px)",background:"rgba(255, 255, 255, 0.95)",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}}if(a)return{position:"fixed",top:Math.min(e.bottom+8,t-280),left:Math.max(16,Math.min(e.left,r-320)),width:"300px",maxHeight:"240px",zIndex:9999,borderRadius:"8px",background:"white",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"};let n=e.bottom+4,s=e.left;n+240>t&&(n=e.top-244);const o=Math.max(e.width,300);return s+o>r&&(s=r-o-10),{top:Math.max(0,n),left:Math.max(0,s),minWidth:Math.max(e.width,300),maxWidth:400,zIndex:9999}}catch(e){return console.error("Error calculating dropdown position:",e),{top:0,left:0,minWidth:300,maxWidth:400,zIndex:9999}}};return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("textarea",{ref:A,value:t||"",onChange:e=>{let t="",a=0;if("string"===typeof e)t=e,a=e.length;else{if(!e||!e.target)return void console.warn("ForumMentionAutocomplete: Unexpected input type:",typeof e);t=e.target.value,a=e.target.selectionStart}"function"===typeof r&&r(t);const n=t.substring(0,a).match(/@(team:|player:)?(\w*)$/);if(n){const[e,t,r]=n,s="team:"===t?"team":"player:"===t?"player":"user";k(a-e.length),f(r),y(s),r.length>=1&&g(!0)}else g(!1),f("")},onKeyDown:e=>{u&&x.length>0&&("ArrowDown"===e.key?(e.preventDefault(),j((e=>(e+1)%x.length))):"ArrowUp"===e.key?(e.preventDefault(),j((e=>(e-1+x.length)%x.length))):"Enter"===e.key||"Tab"===e.key?(e.preventDefault(),R(x[w])):"Escape"===e.key&&g(!1))},placeholder:o,className:i,rows:l,maxLength:d,disabled:c,autoComplete:"off",spellCheck:"false",style:{fontSize:"16px"}}),u&&(0,s.jsxs)("div",{ref:E,className:"fixed z-[9999] bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-2xl max-h-60 overflow-y-auto backdrop-blur-sm",style:S,children:[_?(0,s.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"Searching..."}):x&&x.length>0?(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsx)("div",{className:"px-3 py-1 text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700",children:"Search Results"}),x.map(((e,t)=>(0,s.jsxs)("button",{onClick:()=>R(e),className:"w-full px-3 py-3 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 active:bg-gray-200 dark:active:bg-gray-600 flex items-center space-x-3 transition-colors duration-150 touch-manipulation ".concat(t===w?"bg-blue-100 dark:bg-blue-900/20":""),style:{minHeight:"56px",WebkitTapHighlightColor:"rgba(59, 130, 246, 0.1)"},children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:e.avatar||e.logo?(0,s.jsx)("img",{src:e.avatar||e.logo,alt:U(e),className:"w-8 h-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center text-xs font-bold",children:U(e).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:U(e)}),e.subtitle&&(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:e.subtitle})]}),(0,s.jsx)("div",{className:"flex-shrink-0 text-xs text-gray-400 dark:text-gray-500",children:U(e)})]},"".concat(e.type,"-").concat(e.id))))]}):(0,s.jsxs)("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:['No results found for "',h,'"']}),(0,s.jsx)("div",{className:"px-3 py-2 text-xs text-gray-400 dark:text-gray-500 border-t border-gray-200 dark:border-gray-600",children:(0,s.jsx)("div",{children:"Type @ to mention teams and players"})})]})]})}}}]);