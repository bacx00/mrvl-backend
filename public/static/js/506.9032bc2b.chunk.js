"use strict";(self.webpackChunkmrvl_frontend=self.webpackChunkmrvl_frontend||[]).push([[506],{3506:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(9950),l=a(5150),r=a(4414);const i=function(e){let{searchParams:t={},navigateTo:a}=e;const{api:i}=(0,l.As)(),[d,n]=(0,s.useState)(t.query||""),[o,c]=(0,s.useState)({}),[u,m]=(0,s.useState)(!1),[v,x]=(0,s.useState)(""),[h,g]=(0,s.useState)("all"),[y,p]=(0,s.useState)([]),[f,j]=(0,s.useState)(!1),[b,w]=(0,s.useState)([]),N=((0,s.useRef)(null),(0,s.useRef)(null),async e=>{if(e.trim()){m(!0),x("");try{var t,a,s,l,r,d,n,o,u,v,h,g,y,p,f,j,b,w;console.log("\ud83d\udd0d SearchPage: Executing REAL BACKEND search for:",e);const m=e.trim().toLowerCase(),[x,N,k,_,C,L]=await Promise.allSettled([i.get("/teams"),i.get("/players"),i.get("/events"),i.get("/matches"),i.get("/forums/threads"),i.get("/news")]),S="fulfilled"===x.status?((null===(t=x.value)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.data)||(null===(s=x.value)||void 0===s?void 0:s.data)||x.value||[]).filter((e=>{var t,a,s;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(m))||(null===(a=e.short_name)||void 0===a?void 0:a.toLowerCase().includes(m))||(null===(s=e.region)||void 0===s?void 0:s.toLowerCase().includes(m))})).map((e=>({id:e.id,name:e.name,shortName:e.short_name,logo:e.logo,region:e.region,rank:e.rank||e.ranking,rating:e.rating||e.elo_rating,country:e.country}))):[],A="fulfilled"===N.status?((null===(l=N.value)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.data)||(null===(d=N.value)||void 0===d?void 0:d.data)||N.value||[]).filter((e=>{var t,a,s,l;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(m))||(null===(a=e.username)||void 0===a?void 0:a.toLowerCase().includes(m))||(null===(s=e.role)||void 0===s?void 0:s.toLowerCase().includes(m))||(null===(l=e.team_name)||void 0===l?void 0:l.toLowerCase().includes(m))})).map((e=>{var t,a;return{id:e.id,name:e.name||e.username,role:e.role,team:e.team_name||(null===(t=e.team)||void 0===t?void 0:t.name),hero:e.main_hero||(null===(a=e.preferred_heroes)||void 0===a?void 0:a[0])||"Iron Man",country:e.country||"US",rating:e.rating}})):[],P="fulfilled"===k.status?((null===(n=k.value)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.data)||(null===(u=k.value)||void 0===u?void 0:u.data)||k.value||[]).filter((e=>{var t,a,s;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(m))||(null===(a=e.location)||void 0===a?void 0:a.toLowerCase().includes(m))||(null===(s=e.type)||void 0===s?void 0:s.toLowerCase().includes(m))})).map((e=>({id:e.id,name:e.name,description:e.description||"Professional Marvel Rivals tournament featuring ".concat(e.teams_count||16," teams"),location:e.location,date:e.start_date||e.date,status:e.status,prizePool:e.prize_pool}))):[],E="fulfilled"===_.status?((null===(v=_.value)||void 0===v||null===(h=v.data)||void 0===h?void 0:h.data)||(null===(g=_.value)||void 0===g?void 0:g.data)||_.value||[]).filter((e=>{var t,a,s,l,r,i;return(null===(t=e.team1)||void 0===t||null===(a=t.name)||void 0===a?void 0:a.toLowerCase().includes(m))||(null===(s=e.team2)||void 0===s||null===(l=s.name)||void 0===l?void 0:l.toLowerCase().includes(m))||(null===(r=e.event_name)||void 0===r?void 0:r.toLowerCase().includes(m))||(null===(i=e.status)||void 0===i?void 0:i.toLowerCase().includes(m))})).map((e=>{var t,a,s,l,r;return{id:e.id,team1:{name:(null===(t=e.team1)||void 0===t?void 0:t.name)||e.team1_name,short_name:(null===(a=e.team1)||void 0===a?void 0:a.short_name)||e.team1_short_name},team2:{name:(null===(s=e.team2)||void 0===s?void 0:s.name)||e.team2_name,short_name:(null===(l=e.team2)||void 0===l?void 0:l.short_name)||e.team2_short_name},status:e.status,tournament:e.event_name||(null===(r=e.event)||void 0===r?void 0:r.name),date:e.scheduled_at||e.match_date,score:"completed"===e.status?"".concat(e.team1_score,"-").concat(e.team2_score):null}})):[],R="fulfilled"===C.status?((null===(y=C.value)||void 0===y||null===(p=y.data)||void 0===p?void 0:p.data)||(null===(f=C.value)||void 0===f?void 0:f.data)||C.value||[]).filter((e=>{var t,a,s,l;const r="string"===typeof e.category?e.category:(null===(t=e.category)||void 0===t?void 0:t.name)||(null===(a=e.category)||void 0===a?void 0:a.title)||"";return(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(m))||(null===(l=e.content)||void 0===l?void 0:l.toLowerCase().includes(m))||r.toLowerCase().includes(m)})).map((e=>{var t,a,s,l;return{id:e.id,title:e.title,content:(null===(t=e.content)||void 0===t?void 0:t.substring(0,100))+"...",user:{name:e.user_name||(null===(a=e.author)||void 0===a?void 0:a.name)||"Anonymous"},posts_count:e.replies||e.replies_count||0,category:"string"===typeof e.category?e.category:(null===(s=e.category)||void 0===s?void 0:s.name)||(null===(l=e.category)||void 0===l?void 0:l.title)||"General"}})):[],D="fulfilled"===L.status?((null===(j=L.value)||void 0===j||null===(b=j.data)||void 0===b?void 0:b.data)||(null===(w=L.value)||void 0===w?void 0:w.data)||L.value||[]).filter((e=>{var t,a,s,l;const r="string"===typeof e.category?e.category:(null===(t=e.category)||void 0===t?void 0:t.name)||(null===(a=e.category)||void 0===a?void 0:a.title)||"";return(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(m))||(null===(l=e.content)||void 0===l?void 0:l.toLowerCase().includes(m))||r.toLowerCase().includes(m)})).slice(0,5).map((e=>{var t,a;return{id:e.id,title:e.title,excerpt:e.excerpt||(null===(t=e.content)||void 0===t?void 0:t.substring(0,100))+"...",author:(null===(a=e.author)||void 0===a?void 0:a.name)||"MRVL Team",date:e.published_at||e.created_at}})):[];c({teams:S,players:A,events:P,matches:E,forums:R,news:D})}catch(N){console.error("\u274c SearchPage: Search error:",N),x("Search temporarily unavailable. Please try again."),c({teams:[],players:[],events:[],matches:[],forums:[],news:[]})}finally{m(!1)}}else c({})});(0,s.useEffect)((()=>{t.query&&(n(t.query),N(t.query))}),[t.query]);const k=()=>o&&"object"===typeof o?Object.values(o).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0):0;return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"card p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,r.jsx)("div",{className:"flex-1 relative",children:(0,r.jsx)("input",{type:"text",placeholder:"Search",value:d,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"===e.key&&N(d)},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded  bg-white dark:bg-gray-800 text-gray-900 dark:text-white  focus:ring-2 focus:ring-red-500 focus:border-transparent"})}),(0,r.jsx)("button",{onClick:()=>N(d),disabled:u,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded transition-colors",children:u?"Searching...":"Search"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:[{id:"all",label:"All"},{id:"teams",label:"Teams"},{id:"players",label:"Players"},{id:"matches",label:"Matches"},{id:"events",label:"Events"},{id:"forums",label:"Forums"},{id:"news",label:"News"}].map((e=>(0,r.jsxs)("button",{onClick:()=>g(e.id),className:"px-3 py-1 rounded text-sm font-medium transition-colors ".concat(h===e.id?"bg-red-600 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[e.label,"all"!==e.id&&o[e.id]&&Array.isArray(o[e.id])&&(0,r.jsx)("span",{className:"ml-1 px-1 py-0.5 bg-white/20 rounded text-xs",children:o[e.id].length})]},e.id)))})]}),d&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:['Search Results for "',d,'"']}),(0,r.jsxs)("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[k()," results"]})]})}),v&&(0,r.jsxs)("div",{className:"card p-6 text-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Search Error"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:v})]}),u&&(0,r.jsx)("div",{className:"card p-6 text-center mb-6",children:(0,r.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Searching..."})}),!u&&!v&&d&&(0,r.jsx)("div",{className:"space-y-6",children:Object.entries(o&&"object"===typeof o?"all"===h?o:{[h]:o[h]||[]}:{}).map((e=>{let[t,s]=e;return s&&Array.isArray(s)&&0!==s.length?(0,r.jsxs)("div",{className:"card p-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold text-red-600 dark:text-red-400 capitalize mb-4",children:[t," (",s.length,")"]}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(((e,s)=>{var l,i,d;return(0,r.jsxs)("div",{onClick:()=>((e,t)=>{if(a)switch(console.log("\ud83d\udd17 SearchPage: Navigating from search result:",e,t.id),e){case"teams":a("team-detail",{id:t.id});break;case"players":a("player-detail",{id:t.id});break;case"matches":a("match-detail",{id:t.id});break;case"events":a("event-detail",{id:t.id});break;case"forums":a("thread-detail",{id:t.id});break;case"news":a("news-detail",{id:t.id})}})(t,e),className:"p-3 bg-gray-50 dark:bg-gray-700 rounded hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:["teams"===t&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.shortName}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.name})]}),(0,r.jsxs)("div",{className:"text-right text-sm text-gray-500",children:[(0,r.jsx)("div",{children:e.region}),(0,r.jsxs)("div",{children:["#",e.rank]})]})]}),"players"===t&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.team})]}),(0,r.jsxs)("div",{className:"text-right text-sm text-gray-500",children:[(0,r.jsx)("div",{children:e.role}),(0,r.jsx)("div",{children:e.hero})]})]}),"matches"===t&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:[null===(l=e.team1)||void 0===l?void 0:l.name," vs ",null===(i=e.team2)||void 0===i?void 0:i.name]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.tournament}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.date).toLocaleDateString()})]}),"events"===t&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{children:e.location}),(0,r.jsx)("span",{children:e.prizePool})]})]}),"forums"===t&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.content}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["By ",null===(d=e.user)||void 0===d?void 0:d.name]}),(0,r.jsxs)("span",{children:[e.posts_count," replies"]})]})]}),"news"===t&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.excerpt}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["By ",e.author]}),(0,r.jsx)("span",{children:new Date(e.date).toLocaleDateString()})]})]})]},e.id||s)}))})]},t):null}))}),!u&&!v&&d&&0===k()&&(0,r.jsxs)("div",{className:"card p-6 text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Results Found"}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["We couldn't find anything matching \"",d,'". Try adjusting your search terms.']})]})]})}}}]);